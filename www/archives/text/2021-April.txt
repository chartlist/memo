From michaelfolkson at gmail.com  Thu Apr  1 14:58:04 2021
From: michaelfolkson at gmail.com (Michael Folkson)
Date: Thu, 1 Apr 2021 15:58:04 +0100
Subject: [bitcoin-dev] Announcing a new standard for soft fork activation
Message-ID: <CAFvNmHSO1qBv2Lm4uHq82oEx5nxayKRsyP3Vx6BNfHJiOaztPQ@mail.gmail.com>

There have been a vast number of proposals for soft fork activation in
recent months and it is important that all these important ideas don?t go
to waste. Hence I propose a new standard for soft fork activation
incorporating all the ideas into one standard. I appreciate this standard
has come too late for Taproot activation but it should be ready for any
future soft forks. It is a multi phase, multi year standard. No soft fork
can activate unless and until it has successfully passed through all of the
different 14 phases. This will demonstrate Bitcoin?s ultimate conservatism.

Phase 1) Let?s See What Happens - BIP 8 (false, 0.25 years). The shortest
phase just to whet appetites.

Phase 2) Start now, improve later - BIP 8(false, 1 year) A confusing name,
it starts but it doesn't improve later

Phase 3) BIP 9 equivalent - BIP 8(false, 1 year)

Phase 4) Gently discourage apathy - BIP 8(true, 1 year) Forced signaling at
the end of this phase but obviously there are still many phases before the
soft fork can actually activate.

Phase 5) BIP 91 (1 year). As a nod to our SegWit history we have a BIP 91
activation phase.

Phase 6) BIP 148 (1 year). Some people disagree that BIP 91 activated
SegWit so we do a BIP 148 activation phase to keep those people happy.
Again forced signaling doesn?t actually mean activation. There are still
many more phases to pass through.

Phase 7) Speedy Trial (using block height, 0.5 years) on mainnet

Phase 8) Speedy Trial (using MTP, 0.5 years) on mainnet

Phase 9) Speedy Trial on the default signet (0.5 years)

Phase 10) Speedy Trial on a combination of three different custom signets
in parallel (0.5 years)

Phase 11) Speedy Trial on testnet and a custom signet in parallel (0.5
years)

Phase 12) Modern Soft Fork Activation (3.5 years) This is the longest phase
of the soft fork activation standard. It is itself multi phase and multi
year so this can be considered a nested activation phase within this
standard.

Phase 13) UASF BIP 8 (LOT=true, 1 year). Forced miner signaling at the end
of this phase but ultimately the soft fork doesn?t yet activate as there is
one final additional phase the activation must pass through. This gives
Samson the opportunity to sell some hats. We are close now. The natives are
getting restless.

Phase 14) Second flag day (1 year) We don?t want those pesky users actually
activating a soft fork on their own so an additional flag day is added just
so we can tell users that we prevented a chain split.

Assuming a soft fork activation has successfully passed through all these
14 phases it should activate. It will take a minimum of 13 years. However,
if it fails during any one of these phases it has to start from Phase 1
again. We should take Bitcoin?s conservatism very seriously. If a soft fork
activation can?t pass successfully through all these phases it shouldn?t
activate. Ultimately we don?t really mind what is in the soft fork (any
idiot can design consensus changes and write secure bug free C++ code) that
is very much secondary in importance to *how* the soft fork is activated.
The activation design absolutely must be conservative.

I expect this rigorous standard for soft fork activation will get a BIP
number. If you are going to propose a future soft fork I recommend you plan
for activation in approximately 13 years from the point the soft fork code
is merged into Core.

I am happy to settle the soft fork activation question once and for all for
the community. I expect in time my contribution will be recognized in the
annals of history with Satoshi Nakamoto and Hal Finney.

Addendum: Although all future soft forks will ultimately use this standard,
this standard is copyrighted. Every time it is used royalties must be paid
into this quantum secure Bitcoin vanity address 1quantumsecureaddress


-- 
Michael Folkson
Email: michaelfolkson at gmail.com
Keybase: michaelfolkson
PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210401/292151d1/attachment.html>

From jlrubin at mit.edu  Sun Apr  4 04:39:11 2021
From: jlrubin at mit.edu (Jeremy)
Date: Sat, 3 Apr 2021 21:39:11 -0700
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th 19:00
	UTC bitcoin/bitcoin-dev
Message-ID: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>

We'll be having another meeting this Tuesday, as per
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-March/018699.html.
If you can't make it feel free to leave a comment on any agenda item below,
or if you think there are other things to be discussed.

Agenda:

1. AJ's update to MTP time.

Please review https://github.com/bitcoin/bitcoin/pull/21377 as AJ updated
it substantially.

The PR is now purely MTP based, and the state machine has been simplified.
This approach is intended to be compatible with a mandatory signaling
period (via a LAST_CHANCE change) and makes it easier to deploy ST on
signets (irrelevant for Taproot, because it is already active on all
signets).

2. Selecting between MTP and Height

In the previous meeting, there was no substantial publicly discussed
benefit to using MTPs over height. Since agenda item 1, there is now a
tangible benefit to using MTP.

The changes AJ promulgated for MTP neutralizes the argument, mostly, that
MTP was easier to review. As such, the main conversation in this agenda
item is around the pros/cons of height or MTP and determining if we can
reach consensus on either approach.

3. Timeline Discussion
In all hope, we will reach consensus around item 2. Should that occur, we
can use this time to discuss a final selection on parameters, mindful of
Core's process.

If the meeting doesn't reach rough consensus around item 2, it seems that
we may fall short on the proposed schedule from last time. In this section,
we can discuss realities around scheduling.


Best,

Jeremy



--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210403/89834233/attachment.html>

From jtimon at jtimon.cc  Sun Apr  4 09:31:45 2021
From: jtimon at jtimon.cc (=?UTF-8?B?Sm9yZ2UgVGltw7Nu?=)
Date: Sun, 4 Apr 2021 11:31:45 +0200
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
Message-ID: <CABm2gDpNh61hJLiv+Fq1xVKcUvJo24D6b4Kdru5_mqiwLyzVdw@mail.gmail.com>

So the only thing that seemed clear, using height as per bip8, it's not
clear anymore.
And, as usual, we're not talking about activation in general but about
taproot activation, segwit activation...

I won't make it to the meeting because I don't think I have much more to
contribute that I haven't said already beyond perhaps: sigh.
My arguments will probably ignored again, so it doesn't matter.


On Sun, Apr 4, 2021, 06:39 Jeremy via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> We'll be having another meeting this Tuesday, as per
> https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-March/018699.html.
> If you can't make it feel free to leave a comment on any agenda item below,
> or if you think there are other things to be discussed.
>
> Agenda:
>
> 1. AJ's update to MTP time.
>
> Please review https://github.com/bitcoin/bitcoin/pull/21377 as AJ updated
> it substantially.
>
> The PR is now purely MTP based, and the state machine has been simplified.
> This approach is intended to be compatible with a mandatory signaling
> period (via a LAST_CHANCE change) and makes it easier to deploy ST on
> signets (irrelevant for Taproot, because it is already active on all
> signets).
>
> 2. Selecting between MTP and Height
>
> In the previous meeting, there was no substantial publicly discussed
> benefit to using MTPs over height. Since agenda item 1, there is now a
> tangible benefit to using MTP.
>
> The changes AJ promulgated for MTP neutralizes the argument, mostly, that
> MTP was easier to review. As such, the main conversation in this agenda
> item is around the pros/cons of height or MTP and determining if we can
> reach consensus on either approach.
>
> 3. Timeline Discussion
> In all hope, we will reach consensus around item 2. Should that occur, we
> can use this time to discuss a final selection on parameters, mindful of
> Core's process.
>
> If the meeting doesn't reach rough consensus around item 2, it seems that
> we may fall short on the proposed schedule from last time. In this section,
> we can discuss realities around scheduling.
>
>
> Best,
>
> Jeremy
>
>
>
> --
> @JeremyRubin <https://twitter.com/JeremyRubin>
> <https://twitter.com/JeremyRubin>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210404/c59b83e4/attachment.html>

From RobertSpigler at protonmail.ch  Sun Apr  4 22:00:02 2021
From: RobertSpigler at protonmail.ch (Robert Spigler)
Date: Sun, 04 Apr 2021 22:00:02 +0000
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
	19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <CABm2gDpNh61hJLiv+Fq1xVKcUvJo24D6b4Kdru5_mqiwLyzVdw@mail.gmail.com>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <CABm2gDpNh61hJLiv+Fq1xVKcUvJo24D6b4Kdru5_mqiwLyzVdw@mail.gmail.com>
Message-ID: <VFw3Y8wuv5UlLHRdk3ecsArjH64o5mRRS2tzKw_PNPZDTGehUhxMubp0l8Tp0OfeUTZwUGMYcj5BryyDGc15W2-lNwE6tpDH9sJbtsUHbuQ=@protonmail.ch>

I'd like to pre-register a comment that I don't think signet should be a consideration for MTP vs height, since taproot is already activated on signet, and there's no indication that ST will be used in the future (we should continue our search for the ideal activation method)

Robert Spigler

Personal Fingerprint: BF0D 3C08 A439 5AC6 11C1 5395 B70B 4A77 F850 548F

??????? Original Message ???????
On Sunday, April 4, 2021 5:31 AM, Jorge Tim?n via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:

> So the only thing that seemed clear, using height as per bip8, it's not clear anymore.
> And, as usual, we're not talking about activation in general but about taproot activation, segwit activation...
>
> I won't make it to the meeting because I don't think I have much more to contribute that I haven't said already beyond perhaps: sigh.
> My arguments will probably ignored again, so it doesn't matter.
>
> On Sun, Apr 4, 2021, 06:39 Jeremy via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> We'll be having another meeting this Tuesday, as per https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-March/018699.html. If you can't make it feel free to leave a comment on any agenda item below, or if you think there are other things to be discussed.
>>
>> Agenda:
>>
>> 1. AJ's update to MTP time.
>>
>> Please review https://github.com/bitcoin/bitcoin/pull/21377 as AJ updated it substantially.
>>
>> The PR is now purely MTP based, and the state machine has been simplified. This approach is intended to be compatible with a mandatory signaling period (via a LAST_CHANCE change) and makes it easier to deploy ST on signets (irrelevant for Taproot, because it is already active on all signets).
>>
>> 2. Selecting between MTP and Height
>>
>> In the previous meeting, there was no substantial publicly discussed benefit to using MTPs over height. Since agenda item 1, there is now a tangible benefit to using MTP.
>>
>> The changes AJ promulgated for MTP neutralizes the argument, mostly, that MTP was easier to review. As such, the main conversation in this agenda item is around the pros/cons of height or MTP and determining if we can reach consensus on either approach.
>>
>> 3. Timeline Discussion
>> In all hope, we will reach consensus around item 2. Should that occur, we can use this time to discuss a final selection on parameters, mindful of Core's process.
>>
>> If the meeting doesn't reach rough consensus around item 2, it seems that we may fall short on the proposed schedule from last time. In this section, we can discuss realities around scheduling.
>>
>> Best,
>>
>> Jeremy
>>
>> --
>> [@JeremyRubin](https://twitter.com/JeremyRubin)https://twitter.com/JeremyRubin
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210404/ae136571/attachment.html>

From aj at erisian.com.au  Mon Apr  5 10:34:52 2021
From: aj at erisian.com.au (Anthony Towns)
Date: Mon, 5 Apr 2021 20:34:52 +1000
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
Message-ID: <20210405103452.GA15866@erisian.com.au>

On Sat, Apr 03, 2021 at 09:39:11PM -0700, Jeremy via bitcoin-dev wrote:
> As such, the main conversation in this agenda item is
> around the pros/cons of height or MTP and determining if we can reach consensus
> on either approach.

Here's some numbers.

Given a desired signalling period of xxx days, where signaling begins
on the first retarget boundary after the starttime and ends on the last
retarget boundary before the endtime, this is how many retarget periods
you get (based on blocks since 2015-01-01):

 90 days: mainnet  5-7 full 2016-block retarget periods
180 days: mainnet 11-14
365 days: mainnet 25-27
730 days: mainnet 51-55

(This applies to non-signalling periods like the activation/lock in delay
too of course. If you change it so that it ends at the first retarget
period after endtime, all the values just get incremented -- ie, 6-8,
12-15 etc)

If I've got the maths right, then requiring 1814 of 2016 blocks to signal,
means that having 7 periods instead of 5 lets you get a 50% chance of
successful activation by maintaining 89.04% of hashpower over the entire
period instead of 89.17%, while 55 periods instead of 51 gives you a 50%
chance of success with 88.38% hashpower instead of 88.40% hashpower.
So the "repeated trials" part doesn't look like it has any significant
effect on mainnet.

If you target yy periods instead of xxx days, starting and ending on a
retarget boundary, you get the following stats from the last few years
of mainnet (again starting at 2015-01-01):

 1 period:  mainnet 11-17 days (range 5.2 days)
 7 periods: mainnet 87-103 days (range 15.4 days)
13 periods: mainnet 166-185 days (range 17.9 days)
27 periods: mainnet 352-377 days (range 24.4 days)
54 periods: mainnet 711-747 days (range 35.0 days)

As far as I can see the questions that matter are:

 * is signalling still possible by the time enough miners have upgraded
   and are ready to start signalling?

 * have nodes upgraded to enforce the new rules by the time activation
   occurs, if it occurs?

But both those benefit from less real time variance, rather than less
variance in the numbers of signalling periods, at least in every way
that I can think of.

Corresponding numbers for testnet:

 90 days: testnet   5-85
180 days: testnet  23-131
365 days: testnet  70-224
730 days: testnet 176-390

(A 50% chance of activating within 5 periods requires sustaining 89.18%
hashpower; within 85 periods, 88.26% hashpower; far smaller differences
with all the other ranges -- of course, presumably the only way the
higher block rates ever actually happen is by someone pointing an ASIC at
testnet, and thus controlling 100% of blocks for multiple periods anyway)

  1 period:  testnet 5.6minutes-26 days (range 26.5 days)
 13 periods: testnet 1-135 days (range 133.5 days)
 27 periods: testnet 13-192 days (range 178.3 days)
 54 periods: testnet 39-283 days (range 243.1 days)
100 periods: testnet 114-476 days (range 360.9 days)
             (this is the value used in [0] in order to ensure 3 months'
              worth of signalling is available)
132 periods: testnet 184-583 days (range 398.1 days)
225 periods: testnet 365-877 days (range 510.7 days)
390 periods: testnet 725-1403 days (range 677.1 days)

[0] https://github.com/bitcoin/bips/pull/1081#pullrequestreview-621934640

Cheers,
aj


From ben.woosley at gmail.com  Thu Apr  1 18:05:28 2021
From: ben.woosley at gmail.com (Ben Woosley)
Date: Thu, 1 Apr 2021 11:05:28 -0700
Subject: [bitcoin-dev] Announcing a new standard for soft fork activation
In-Reply-To: <CAFvNmHSO1qBv2Lm4uHq82oEx5nxayKRsyP3Vx6BNfHJiOaztPQ@mail.gmail.com>
References: <CAFvNmHSO1qBv2Lm4uHq82oEx5nxayKRsyP3Vx6BNfHJiOaztPQ@mail.gmail.com>
Message-ID: <CAC5gnOyeg78ASZmQiDJMf2v8p50OqSBBH_FUSs79qaDVLR5Teg@mail.gmail.com>

Hear hear, a true work of genius. Who's looking for Satoshi? I think we've
found him!

On Thu, Apr 1, 2021 at 8:15 AM Michael Folkson via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> There have been a vast number of proposals for soft fork activation in
> recent months and it is important that all these important ideas don?t go
> to waste. Hence I propose a new standard for soft fork activation
> incorporating all the ideas into one standard. I appreciate this standard
> has come too late for Taproot activation but it should be ready for any
> future soft forks. It is a multi phase, multi year standard. No soft fork
> can activate unless and until it has successfully passed through all of the
> different 14 phases. This will demonstrate Bitcoin?s ultimate conservatism.
>
> Phase 1) Let?s See What Happens - BIP 8 (false, 0.25 years). The shortest
> phase just to whet appetites.
>
> Phase 2) Start now, improve later - BIP 8(false, 1 year) A confusing name,
> it starts but it doesn't improve later
>
> Phase 3) BIP 9 equivalent - BIP 8(false, 1 year)
>
> Phase 4) Gently discourage apathy - BIP 8(true, 1 year) Forced signaling
> at the end of this phase but obviously there are still many phases before
> the soft fork can actually activate.
>
> Phase 5) BIP 91 (1 year). As a nod to our SegWit history we have a BIP 91
> activation phase.
>
> Phase 6) BIP 148 (1 year). Some people disagree that BIP 91 activated
> SegWit so we do a BIP 148 activation phase to keep those people happy.
> Again forced signaling doesn?t actually mean activation. There are still
> many more phases to pass through.
>
> Phase 7) Speedy Trial (using block height, 0.5 years) on mainnet
>
> Phase 8) Speedy Trial (using MTP, 0.5 years) on mainnet
>
> Phase 9) Speedy Trial on the default signet (0.5 years)
>
> Phase 10) Speedy Trial on a combination of three different custom signets
> in parallel (0.5 years)
>
> Phase 11) Speedy Trial on testnet and a custom signet in parallel (0.5
> years)
>
> Phase 12) Modern Soft Fork Activation (3.5 years) This is the longest
> phase of the soft fork activation standard. It is itself multi phase and
> multi year so this can be considered a nested activation phase within this
> standard.
>
> Phase 13) UASF BIP 8 (LOT=true, 1 year). Forced miner signaling at the end
> of this phase but ultimately the soft fork doesn?t yet activate as there is
> one final additional phase the activation must pass through. This gives
> Samson the opportunity to sell some hats. We are close now. The natives are
> getting restless.
>
> Phase 14) Second flag day (1 year) We don?t want those pesky users
> actually activating a soft fork on their own so an additional flag day is
> added just so we can tell users that we prevented a chain split.
>
> Assuming a soft fork activation has successfully passed through all these
> 14 phases it should activate. It will take a minimum of 13 years. However,
> if it fails during any one of these phases it has to start from Phase 1
> again. We should take Bitcoin?s conservatism very seriously. If a soft fork
> activation can?t pass successfully through all these phases it shouldn?t
> activate. Ultimately we don?t really mind what is in the soft fork (any
> idiot can design consensus changes and write secure bug free C++ code) that
> is very much secondary in importance to *how* the soft fork is activated.
> The activation design absolutely must be conservative.
>
> I expect this rigorous standard for soft fork activation will get a BIP
> number. If you are going to propose a future soft fork I recommend you plan
> for activation in approximately 13 years from the point the soft fork code
> is merged into Core.
>
> I am happy to settle the soft fork activation question once and for all
> for the community. I expect in time my contribution will be recognized in
> the annals of history with Satoshi Nakamoto and Hal Finney.
>
> Addendum: Although all future soft forks will ultimately use this
> standard, this standard is copyrighted. Every time it is used royalties
> must be paid into this quantum secure Bitcoin vanity address
> 1quantumsecureaddress
>
>
> --
> Michael Folkson
> Email: michaelfolkson at gmail.com
> Keybase: michaelfolkson
> PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210401/9d4cf5a6/attachment-0001.html>

From lloyd.fourn at gmail.com  Mon Apr  5 00:27:50 2021
From: lloyd.fourn at gmail.com (Lloyd Fournier)
Date: Mon, 5 Apr 2021 10:27:50 +1000
Subject: [bitcoin-dev] PSA: Taproot loss of quantum protections
In-Reply-To: <20210316002401.zlfbc3y2s7vbrh35@ganymede>
References: <202103152148.15477.luke@dashjr.org>
 <20210316002401.zlfbc3y2s7vbrh35@ganymede>
Message-ID: <CAH5Bsr20n2T7KRTYqycSUx0iEuEApC8NGtPCfN8rYhRyHLE4gA@mail.gmail.com>

On Tue, 16 Mar 2021 at 11:25, David A. Harding via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

>
> I curious about whether anyone informed about ECC and QC
> knows how to create output scripts with lower difficulty that could be
> used to measure the progress of QC-based EC key cracking.  E.g.,
> NUMS-based ECDSA- or taproot-compatible scripts with a security strength
> equivalent to 80, 96, and 112 bit security.


Hi Dave,

This is actually relatively easy if you are willing to use a trusted setup.
The trusted party takes a secp256k1 secret key and verifiably encrypt it
under a NUMS public key from the weaker group. Therefore if you can crack
the weaker group's public key you get the secp256k1 secret key.
Camenisch-Damgard[1] cut-and-choose verifiable encryption works here.
People then pay the secp256k1 public key funds to create the bounty. As
long as the trusted party deletes the secret key afterwards the scheme is
secure.

Splitting the trusted setup among several parties where only one of them
needs to be honest looks doable but would take some engineering and
analysis work.

[1] https://link.springer.com/content/pdf/10.1007/3-540-44448-3_25.pdf

Cheers,

LL
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210405/599aee9f/attachment-0001.html>

From lloyd.fourn at gmail.com  Mon Apr  5 00:35:14 2021
From: lloyd.fourn at gmail.com (Lloyd Fournier)
Date: Mon, 5 Apr 2021 10:35:14 +1000
Subject: [bitcoin-dev] New PSBT version proposal
In-Reply-To: <CAH5Bsr22oQ_yOD1eom6gZhUVbr+bMj2W8rfWO=Edujhj9bNsEg@mail.gmail.com>
References: <1dd8c285-e3f4-4f03-d608-103a5026146d@achow101.com>
 <CAH5Bsr22oQ_yOD1eom6gZhUVbr+bMj2W8rfWO=Edujhj9bNsEg@mail.gmail.com>
Message-ID: <CAH5Bsr1P7L0Y1Lqq2jXHOD_hxSfsgZRK9a3_qGS8s7JMixBmxQ@mail.gmail.com>

On Wed, 10 Mar 2021 at 11:20, Lloyd Fournier <lloyd.fourn at gmail.com> wrote:

> Hi Andrew & all,
>
> I've been working with PSBTs for a little while now. FWIW I agree with the
> change of removing the global tx and having the input/output data stored
> together in the new unified structures.
>
> One thing I've been wondering about is how output descriptors could fit
> into PSBTs. They are useful since they allow you to determine the maximum
> satisfaction weight for inputs so you can properly align fees as things get
> added. I haven't seen any discussion about including them in this revision.
> Is it simply a matter of time before they make it into a subsequent PSBT
> spec or is there something I'm missing conceptually?
>


Sipa replied to me off list some time ago and explained what I was missing.
PSBTs have all the information you could want from a descriptor already.
For example the maximum satisfaction weight can be determined from the
witness/redeem script (I had forgot these fields existed). Therefore
descriptors are more useful in higher level applications while PSBTs are
useful for communicating with signing devices. Therefore there is no reason
for PSBTs to support descriptors.

LL
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210405/911a07fe/attachment-0001.html>

From hugo at nunchuk.io  Mon Apr  5 07:02:45 2021
From: hugo at nunchuk.io (Hugo Nguyen)
Date: Mon, 5 Apr 2021 00:02:45 -0700
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
Message-ID: <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>

Hi all,

Please find below the complete draft of the Bitcoin Secure Multisig Setup
(BSMS) BIP. The spec has gone through a number of important updates in the
last month or so. Thanks everyone who has participated in the review
process.

As a PR: https://github.com/bitcoin/bips/pull/1097

A few notes:
* PBKDF2-SHA512 was chosen instead of PBKDF2-SHA256 for the key derivation
function, due to widespread existing hardware support for PBKDF2-SHA512
* Only one descriptor is stored in the multisig configuration - this
simplifies wallet setup and recovery
(For the full review and relevant discussions, please check out
https://github.com/nunchuk-io/bips/pull/1).

Best,
Hugo

<pre>
  BIP: To be determined
  Layer: Applications
  Title: Bitcoin Secure Multisig Setup (BSMS)
  Author: Hugo Nguyen <hugo at nunchuk.io>, Peter Gray <peter at
coinkite.com>, Marko Bencun <marko at shiftcrypto.ch>, Aaron Chen
<aarondongchen at gmail.com>, Rodolfo Novak <rodolfo at coinkite.com>
  Comments-Summary: No comments yet.
  Comments-URI:
  Status: Proposed
  Type: Standards Track
  Created: 2020-11-10
  License: BSD-2-Clause
</pre>

==Introduction==

===Abstract===

This document proposes a mechanism to set up multisig wallets securely.

===Copyright===

This BIP is licensed under the 2-clause BSD license.

===Motivation===

The Bitcoin multisig experience has been greatly streamlined under
[https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki
BIP-0174
(Partially Signed Bitcoin Transaction)]. However, what is still
missing is a standardized process for setting up multisig wallets
securely across different vendors.

There are a number of concerns when it comes to setting up a multisig wallet:

# Whether the multisig configuration, such as Signer membership,
script type, derivation paths and number of signatures required, is
correct and not tampered with.
# Whether the keys or the multisig configuration are leaked during the setup.
# Whether the Signer persists the multisig configuration in their
respective storage, and under what format.
# Whether the Signer's storage is tamper-proof.
# Whether the Signer subsequently uses the multisig configuration to
generate and verify receive and change addresses.

An attacker who can modify the multisig configuration can steal or
hold funds for ransom by duping the user into sending funds to the
wrong address. An attacker who cannot modify the configuration but can
learn about the keys and/or the configuration can monitor transactions
in the wallet, resulting in loss of privacy.

This proposal seeks to address concerns #1, #2 and #3: to mitigate the
risk of tampering during the initial setup phase, and to define an
interoperable multisig configuration format.

Concerns #4 and #5 should be handled by Signers and are out of scope
of this proposal.

==Specification==

===Prerequisites===
This proposal assumes the parties in the multisig support
[https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki
BIP-0032], [https://github.com/bitcoin/bips/blob/master/bip-0322.mediawiki
BIP-0322], [https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md
the descriptor language] and [https://tools.ietf.org/html/rfc3686 AES
encryption].

===File Extension===
All descriptor and key records should have a <tt>.bsms</tt> file
extension. Encrypted data should have a <tt>.dat</tt> extension.

===Roles===
====Coordinator====

The Coordinator initiates the multisig setup. The Coordinator
determines what type of multisig is used and the exact policy script.
If encryption is enabled, the Coordinator also distributes a shared
secret or shared secrets to the parties involved for secure
communication. The Coordinator gathers information from the Signers to
generate a descriptor record. The Coordinator distributes the
descriptor record back to the Signers.

====Signer====

The Signer is a participating member in the multisig. Its
responsibilities include providing its key record -- which contains an
Extended Public Key (XPUB) -- to the Coordinator, verifying that its
XPUB is included in the descriptor record and persisting the
descriptor record in its storage.

===Setup Process===

====Round 1====

=====Coordinator=====

* The Coordinator creates a new multisig wallet creation session. The
Coordinator constructs the multisig script and its policy parameters,
such as the required number of signatures and the total number of
Signers (<tt>M</tt> and <tt>N</tt>).
* The session should expire after some time period determined by the
Coordinator, e.g., 24 hours. The timeout allows the encryption key to
have lower entropy.
* If encryption is enabled, the Coordinator distributes a secret
<tt>TOKEN</tt> to each Signer over a secure channel. The Signer can
use the <tt>TOKEN</tt> to derive an <tt>ENCRYPTION_KEY</tt>. Refer to
the Encryption section below for details on the <tt>TOKEN</tt>, the
key derivation function and the encryption scheme. Depending on the
use case, the Coordinator can decide whether to share one common
<tt>TOKEN</tt> for all Signers, or to have one per Signer.
* If encryption is disabled, the <tt>TOKEN</tt> is set to <tt>0</tt>,
and all the encryption/decryption steps below can be skipped.

=====Signer=====

* The Signer initiates the multisig wallet creation session by setting
the <tt>TOKEN</tt>. The Signer derives an <tt>ENCRYPTION_KEY</tt> from
the <tt>TOKEN</tt>. The Signer can keep the session open until a
different value for the <tt>TOKEN</tt> is set.
* The Signer generates a key record by prompting the user for a
multisig derivation path and retrieves the XPUB at that derivation
path. Alternatively, the Signer can choose a path on behalf of the
user. If the Signer chooses the path, it should try to avoid reusing
XPUBs for different wallets.
* The first line in the record must be the specification version
(<tt>BSMS 1.0</tt> as of this writing). The second line must be the
hex-encoded <tt>TOKEN</tt>. The third line must be the <tt>KEY</tt>.
The <tt>KEY</tt> is an XPUB plus its key origin information, written
in the descriptor-defined format, i.e.: <tt>[{master key
fingerprint}/{derivation path}]{XPUB}</tt>. The fourth line is a text
description of the key, 80 characters maximum. The fifth line must be
a <tt>SIG</tt>, whereas <tt>SIG</tt> is the signature generated by
using the private key associated with the XPUB to sign the first four
lines. The signature should follow
[https://github.com/bitcoin/bips/blob/master/bip-0322.mediawiki
BIP-0322], legacy format accepted.
* The Signer calculates the Message Authentication Code (<tt>MAC</tt>)
for the record. The first 16 bytes of the <tt>MAC</tt> serves as the
Initialization Vector (<tt>IV</tt>) for the encryption.
* The Signer encrypts the key record with the <tt>ENCRYPTION_KEY</tt>
and <tt>IV</tt>.
* The Signer encodes the <tt>MAC</tt> and the ciphertext into
hexadecimal format, then concatenates the results: <tt>(MAC ||
ciphertext)</tt>.

====Round 2====

=====Coordinator=====

* The Coordinator gathers key records from all participating Signers.
The Coordinator verifies that there are exactly <tt>N</tt> unique key
records before the wallet setup session expires.
* For each key record, the Coordinator extracts the <tt>MAC</tt> from
the data, sets <tt>IV</tt> to the first 16 bytes of the <tt>MAC</tt>,
then decrypts the ciphertext using the <tt>ENCRYPTION_KEY</tt> and
<tt>IV</tt>.
* The Coordinator verifies that the included <tt>MAC</tt> is valid
given the plaintext.
* The Coordinator verifies that the key records have compatible
specification versions.
* The Coordinator verifies that the included <tt>SIG</tt> is valid
given the <tt>KEY</tt>.
* If all key records look good, the Coordinator fills in all necessary
information to generate a descriptor record.
* The first line in the descriptor record must be the specification
version (<tt>BSMS 1.0</tt> as of this writing). The second line must
be a comma-separated list of accepted derivation paths that the
Signers can use to generate addresses from the included XPUBs. The
paths must start with <tt>/</tt> and use non-hardened derivation. For
example, <tt>/0/*</tt> and <tt>/1/*</tt> are some common paths. If
there are no restrictions, it must say <tt>No path restrictions</tt>.
The third line must be the descriptor string plus a <tt>CHECKSUM</tt>,
all in one line. The <tt>CHECKSUM</tt> has
[https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md#checksums
BECH32 encoding].
* The Coordinator calculates the <tt>MAC</tt> for the record. The
first 16 bytes of the <tt>MAC</tt> serves as the <tt>IV</tt> for the
encryption..
* The Coordinator encrypts the descriptor record with the
<tt>ENCRYPTION_KEY</tt> and <tt>IV</tt>.
* The Coordinator encodes the <tt>MAC</tt> and the ciphertext into
hexadecimal format, then concatenates the results: <tt>(MAC ||
ciphertext)</tt>.
* The Coordinator sends the encrypted descriptor record to all
participating Signers.

=====Signer=====

* The Signer imports the descriptor record.
* The Signer extracts the <tt>MAC</tt> from the data, sets <tt>IV</tt>
to the first 16 bytes of the <tt>MAC</tt>, then decrypts the
ciphertext using the <tt>ENCRYPTION_KEY</tt> (derived from the open
session) and <tt>IV</tt>.
* The Signer verifies that the included <tt>MAC</tt> is valid given
the plaintext.
* The Signer verifies that it can support the included specification version.
* The Signer verifies that it is compatible with the derivation path
restrictions.
* The Signer verifies the descriptor?s <tt>CHECKSUM</tt>.
* The Signer verifies that it can support the descriptor.
* The Signer checks that its <tt>KEY</tt> is included in the
descriptor, using path and fingerprint information provided. The check
must perform an exact match on the <tt>KEY</tt>s and not using
shortcuts such as matching fingerprints, which is trivial to spoof.
* For confirmation, the Signer must display to the user the
<tt>CHECKSUM</tt>, the derivation path restrictions and the policy
parameters, such as <tt>M</tt>, <tt>N</tt> and the position(s) of its
own XPUB in the policy script. The total number of Signers,
<tt>N</tt>, is important to prevent a <tt>KEY</tt> insertion attack.
The position is important for scripts where key order matters. When
applicable, all positions of the XPUB must be displayed. The full
descriptor must also be available for review upon user request.
* When possible, the Signer should also show a preview of the first
address(es) of the wallet.
* Parties must check with each other that all Signers have verified
the descriptor and has the same confirmation (except for the key
positions).
* If all checks pass, the Signer must persist the descriptor record in
its storage.

This completes the setup.

===Encryption===

====The Token====
We define three modes of encryption.

# <tt>NO_ENCRYPTION</tt> : the <tt>TOKEN</tt> is set to <tt>0</tt>.
Encryption is disabled.
# <tt>STANDARD</tt> : the <tt>TOKEN</tt> is a 64-bit nonce.
# <tt>EXTENDED</tt> : the <tt>TOKEN</tt> is a 96-bit nonce.

The <tt>TOKEN</tt> can be converted to one of these formats:
* A decimal number (recommended). The number must not exceed the
maximum value of the nonce.
* A mnemonic phrase using
[https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki
BIP-0039] word list (6 words in <tt>STANDARD</tt> mode; 9 words in
<tt>EXTENDED</tt> mode).
* A QR code.
* Other formats.

The flexibility in the data format allows each Signer to customize the
User Experience based on its respective capabilities.

====Key Derivation====
The key derivation function is [https://tools.ietf.org/html/rfc2898
PBKDF2], with PRF = SHA512. Specifically:

<tt>DKey = PBKDF2(PRF, Password, Salt, c, dkLen)</tt>

Whereas:

* PRF = SHA512
* Password = "No SPOF"
* Salt = <tt>TOKEN</tt>
* c = 2048
* dkLen = 256
* DKey = Derived <tt>ENCRYPTION_KEY</tt>

====Encryption Scheme====
The encryption scheme is [https://tools.ietf.org/html/rfc3686 AES-256-CTR].

<tt>MAC = HMAC-SHA256(HMAC_Key, hex-encoded TOKEN || Data)</tt>

<tt>IV = First 16 bytes of MAC</tt>

<tt>Ciphertext = AES-256-CTR-Encrypt(Plaintext, DKey, IV)</tt>

<tt>Plaintext = AES-256-CTR-Decrypt(Ciphertext, DKey, IV)</tt>

Whereas:
* DKey = <tt>ENCRYPTION_KEY</tt>
* HMAC_Key = SHA256(<tt>ENCRYPTION_KEY</tt>)
* Data = the plaintext, e.g. the entire key record in round 1 and the
entire descriptor record in round 2

The <tt>MAC</tt> is to be sent along with the key and descriptor
record, as specified above. Because it is a <tt>MAC</tt> over the
entire plaintext, this is essentially an
[https://en.wikipedia.org/wiki/Authenticated_encryption#Encrypt-and-MAC_(E&M)
Encrypt-and-MAC] form of authenticated encryption.

==QR Codes==
For signers that use QR codes to transmit data, key and descriptor
records can be converted to QR codes, following
[https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-005-ur.md
the BCR standard].

Also refer to [https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-015-account.md
UR Type Definition for BIP44 Accounts] and
[https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-010-output-desc.md
UR Type Definition for Bitcoin Output Descriptors] for more details.

==Security==

This proposal introduces two layers of protection. The first one is a
temporary, secret <tt>TOKEN</tt>. The second one is the descriptor
<tt>CHECKSUM</tt>.

The <tt>TOKEN</tt> is used to encrypt the two rounds of communication
between the Signer and the Coordinator. A <tt>MAC</tt> is also
generated from the <tt>TOKEN</tt> and plaintext to authenticate the
data being exchanged. The <tt>TOKEN</tt> is only needed during the
setup phase, and can be safely discarded afterwards.

The descriptor <tt>CHECKSUM</tt>, on the other hand, can be used to
verify the integrity of the multisig configuration. An attacker who
tampers with the multisig configuration must also change the
descriptor <tt>CHECKSUM</tt>. Parties must check with each other that
all Signers have the same <tt>CHECKSUM</tt>, along with the policy
parameters, to reduce the chance of tampering. The <tt>CHECKSUM</tt>
must be persisted along with the descriptor in each Signer?s storage.

The <tt>TOKEN</tt> and the <tt>CHECKSUM</tt> can?t guarantee complete
protection, since that depends on the overall security of all parties
in the setup, but they can make it significantly harder for an
attacker to tamper with the multisig configuration.

==Privacy==
Encryption helps improve the privacy of the wallet by avoiding sharing
XPUBs and descriptors in plaintext.

If the parties wish to have stronger privacy, it is recommended to use
a higher number of bits for the <tt>TOKEN</tt>, and to completely
erase knowledge of the <tt>TOKEN</tt> after the multisig wallet has
been set up.

==Test Vectors==

===Mode: <tt>NO_ENCRYPTION</tt>===
====ROUND 1====
* Coordinator
** M-of-N: 2/2
** ADDRESS_TYPE: NATIVE_SEGWIT
** TOKEN: 0

* Signer 1
** MASTER_KEY_FINGERPRINT: 539f3d89
** PRIVATE_KEY (m/48'/0'/0'/2'):
KyoXqiwiz6qm21BSYebiZFfNF7obkhiJW6TdPMZTQQMF4kZtfD78
** XPUB (m/48'/0'/0'/2'):
xpub6ETerig7tq89mtaD8Gau2xRWxouRMBy6XHqciA8GZzC2dJv3w6FxfgoegH4b2qYF4oG6VBrhpLrauPs5E1q58GLCnhKp6g9QsV9ZA7J5JNa
** Legacy signature
** <tt>signer_1_key.bsms</tt>:
<pre>BSMS 1.0
00
[539f3d89/48'/0'/0'/2']xpub6ETerig7tq89mtaD8Gau2xRWxouRMBy6XHqciA8GZzC2dJv3w6FxfgoegH4b2qYF4oG6VBrhpLrauPs5E1q58GLCnhKp6g9QsV9ZA7J5JNa
Signer 1 key
IPXsnNSZb8M6H4fAWtpjAc75hyHHd89fskpM5o7qFg+mPDzEPc1k2mjuIpVIIzaCe45FwPfAAa91RaStfC5Sak0=</pre>

* Signer 2
** MASTER_KEY_FINGERPRINT: f8b12aa6
** PRIVATE_KEY (m/48'/0'/0'/2'):
L1zht7muKnUYFMdzC3jwXd78u8tGoKr46AXGh4waF9nphUYWq7ow
** XPUB (m/48'/0'/0'/2'):
xpub6EWPNhGSX86SN4J2DrBUaQ826o6V4egHqAJZUDJqnsthv9CcjBZV79u68M3YZkuTJnJBXfCrHuJy97fkVurntwgt3V7Ms5hXpJV2vS8fQZM
** Legacy signature
** <tt>signer_2_key.bsms</tt>:
<pre>BSMS 1.0
00
[f8b12aa6/48'/0'/0'/2']xpub6EWPNhGSX86SN4J2DrBUaQ826o6V4egHqAJZUDJqnsthv9CcjBZV79u68M3YZkuTJnJBXfCrHuJy97fkVurntwgt3V7Ms5hXpJV2vS8fQZM
Signer 2 key
H38+lp9iaesBeCN05BDTH/SnmarlH6+X+Kmw1pgCk+c1Pc1evYIdBag9Nc0nsKhvPtfEbRt9r/qsUVZ5onCtBTc=</pre>

====ROUND 2====
* Coordinator
** <tt>my_multisig_wallet.bsms</tt>:
<pre>BSMS 1.0
/0/*,/1/*
wsh(sortedmulti(2,[539f3d89/48'/0'/0'/2']xpub6ETerig7tq89mtaD8Gau2xRWxouRMBy6XHqciA8GZzC2dJv3w6FxfgoegH4b2qYF4oG6VBrhpLrauPs5E1q58GLCnhKp6g9QsV9ZA7J5JNa/*,[f8b12aa6/48'/0'/0'/2']xpub6EWPNhGSX86SN4J2DrBUaQ826o6V4egHqAJZUDJqnsthv9CcjBZV79u68M3YZkuTJnJBXfCrHuJy97fkVurntwgt3V7Ms5hXpJV2vS8fQZM/*))#fntxdj7p</pre>

===Mode: <tt>STANDARD</tt> Encryption===
====ROUND 1====
* Coordinator
** M-of-N: 2/2
** ADDRESS_TYPE: NATIVE_SEGWIT
** TOKEN (hex): 1ed4ba49e96336b8
*** TOKEN (decimal): 2221605342811469496
*** TOKEN (mnemonic): burst place mystery spot cricket foster
** ENCRYPTION_KEY (hex):
72185a0e25b4efc5d6ac0f8ed32b0165199100e32385040e3a48eb30164bf492

* Signer 1
** MASTER_KEY_FINGERPRINT: 98d79e95
** PRIVATE_KEY (m/48'/0'/0'/2'):
KydC7hZFtWe56oQUAw14HvQ3gKeKVd3m8frFgVMxUqpuhKHvcmm3
** XPUB (m/48'/0'/0'/2'):
xpub6DvvwHS5pd1D36xt4YBGJvtdThWXfn8L9qRj9DbFMExMeP6eBE6Aw9WyBC7XUQwiPPDFurirewsKZpYv68yTV5RBy7SZmw45QEkaLka5BCt
** Legacy signature
** <tt>signer_1_key.bsms</tt>:
<pre>BSMS 1.0
1ed4ba49e96336b8
[98d79e95/48'/0'/0'/2']xpub6DvvwHS5pd1D36xt4YBGJvtdThWXfn8L9qRj9DbFMExMeP6eBE6Aw9WyBC7XUQwiPPDFurirewsKZpYv68yTV5RBy7SZmw45QEkaLka5BCt
Signer 1 key
HxtPoP0DrQSac/7ypcwC07R2s6jjpXR6Li2Q92zXj/FSIMQcV5yOU0/ONsDgHXamq0gD5DfPbvuVCp9ZJubclV4=</pre>

* Signer 1 encryption
** HMAC_KEY (hex):
4dab3988cbc683ad7a8c93d43f9b11a78b63a93d5e33ea19c603f4b7b87ac284
** MAC (hex): afe99e92f0eadc3308eb990045e90a4f54e9f59d22aae5034ac3d866d29c508d
** IV (hex) : afe99e92f0eadc3308eb990045e90a4f
** CIPHERTEXT (hex):
214ec9a861a238ba7f0412305a97a6e0faa332be15af09127e131d669e5d55d73891580a5808cea5d2bf39f43496d3c0f8236eff3854fcc7446daf9d2b58fd40d97ce3b1745de2959e29767039b99969821400eca0c3517fae56d2d24d5235a3430af1ed894b68681d706cce7c75adf35d8580603aa302bc01fef06d0336a37f19dd46100baa9e4eabd8796a810e13941ad0980c126ad55d6a4bbef11a7bf893b7d2ed8fb0d8324c4c9b512d4d1e75096c63511e15018fc832816b5639d58fc28c60c049487d04bd5a6cb32aa1381d0809660d54376b9f63325c18cfd1ac5024088e74cb703fe165972cc4485abb1feefe92a0b4ea297fe2f4f7416eeee1efc9b942540931ef
** <tt>signer_1_key.dat</tt>:
<pre>afe99e92f0eadc3308eb990045e90a4f54e9f59d22aae5034ac3d866d29c508d214ec9a861a238ba7f0412305a97a6e0faa332be15af09127e131d669e5d55d73891580a5808cea5d2bf39f43496d3c0f8236eff3854fcc7446daf9d2b58fd40d97ce3b1745de2959e29767039b99969821400eca0c3517fae56d2d24d5235a3430af1ed894b68681d706cce7c75adf35d8580603aa302bc01fef06d0336a37f19dd46100baa9e4eabd8796a810e13941ad0980c126ad55d6a4bbef11a7bf893b7d2ed8fb0d8324c4c9b512d4d1e75096c63511e15018fc832816b5639d58fc28c60c049487d04bd5a6cb32aa1381d0809660d54376b9f63325c18cfd1ac5024088e74cb703fe165972cc4485abb1feefe92a0b4ea297fe2f4f7416eeee1efc9b942540931ef</pre>

* Signer 2
** MASTER_KEY_FINGERPRINT: 3e94b5a1
** PRIVATE_KEY (m/48'/0'/0'/2'):
KyPh5XYjExjNHPiBjYhp8iAntAehrDziiwRv7y9Ln6eK9QU2xP55
** XPUB (m/48'/0'/0'/2'):
xpub6E1W1DUYY29V2b8czCcpi36GG2uD33B11vwNopgTZwsVyfgAkA4kPCqLP5R4YzaRvzW17CQrDkgmDQbA848AdkR7W18nNvMKXzzCBSnZP9c
** Legacy signature
** <tt>signer_2_key.bsms</tt>:
<pre>BSMS 1.0
1ed4ba49e96336b8
[3e94b5a1/48'/0'/0'/2']xpub6E1W1DUYY29V2b8czCcpi36GG2uD33B11vwNopgTZwsVyfgAkA4kPCqLP5R4YzaRvzW17CQrDkgmDQbA848AdkR7W18nNvMKXzzCBSnZP9c
Signer 2 key
ILR49QLy9+xkMS11TIXJRSMgOQOzGbAaooq4/ZRcd8VgM6j5upJMI0mjJHseQOMYSGk8FqjXZbMvBGyiX9wdutM=</pre>

* Signer 2 encryption
** HMAC_KEY (hex):
4dab3988cbc683ad7a8c93d43f9b11a78b63a93d5e33ea19c603f4b7b87ac284
** MAC (hex): 5c7cb2ac407cd60b1f2b86ef46077d3a312b6ce921df2a141347e8bf1e5c6573
** IV (hex) : 5c7cb2ac407cd60b1f2b86ef46077d3a
** CIPHERTEXT (hex):
f23e6c76ff45d308dea6014030a274127ad437228f1d5ec2431d2ea9e3cedd5b0a207a9efa6f926d5420205003f3cb9c4b82b2d595180e62a173a2e5aa0322de48a70a873f641bdae1764e6b1667c241e0fe03a4ccdc3fe0cfa5f75b239d6497c3b69dca17bb685ba70b307d1243836d8fb198ce727cfae4057ee0b4fdcb09f4ba5ae127f49c5de780edb4e40aec96303c8a7b98b1b8e53dd5e07e01d4f3ffd836763209a1f0cbc61adcfdc2951e77528ee7b6e68114c3a4bec38875d285021e68ae8aa913bb1e2e65dd52c649a0e98bfb4e8bab6dd10295c1167a0854ba44f094feb75d2fb00c944f07d4b47114f483df9838459316f3ddbc4a82e6507881931f8e20f5b805
** <tt>signer_2_key.dat</tt>:
<pre>5c7cb2ac407cd60b1f2b86ef46077d3a312b6ce921df2a141347e8bf1e5c6573f23e6c76ff45d308dea6014030a274127ad437228f1d5ec2431d2ea9e3cedd5b0a207a9efa6f926d5420205003f3cb9c4b82b2d595180e62a173a2e5aa0322de48a70a873f641bdae1764e6b1667c241e0fe03a4ccdc3fe0cfa5f75b239d6497c3b69dca17bb685ba70b307d1243836d8fb198ce727cfae4057ee0b4fdcb09f4ba5ae127f49c5de780edb4e40aec96303c8a7b98b1b8e53dd5e07e01d4f3ffd836763209a1f0cbc61adcfdc2951e77528ee7b6e68114c3a4bec38875d285021e68ae8aa913bb1e2e65dd52c649a0e98bfb4e8bab6dd10295c1167a0854ba44f094feb75d2fb00c944f07d4b47114f483df9838459316f3ddbc4a82e6507881931f8e20f5b805</pre>

====ROUND 2====
*Coordinator
** <tt>my_multisig_wallet.bsms</tt>:
<pre>BSMS 1.0
/0/*,/1/*
wsh(sortedmulti(2,[98d79e95/48'/0'/0'/2']xpub6DvvwHS5pd1D36xt4YBGJvtdThWXfn8L9qRj9DbFMExMeP6eBE6Aw9WyBC7XUQwiPPDFurirewsKZpYv68yTV5RBy7SZmw45QEkaLka5BCt/*,[3e94b5a1/48'/0'/0'/2']xpub6E1W1DUYY29V2b8czCcpi36GG2uD33B11vwNopgTZwsVyfgAkA4kPCqLP5R4YzaRvzW17CQrDkgmDQbA848AdkR7W18nNvMKXzzCBSnZP9c/*))#x0lx92qk</pre>

*Coordinator encryption
** HMAC_KEY (hex):
4dab3988cbc683ad7a8c93d43f9b11a78b63a93d5e33ea19c603f4b7b87ac284
** MAC (hex): df3d06db6c8b8a5f25de202e10ea225df6415d1ed0e36c64cc2be1b7e86c2a38
** IV (hex) : df3d06db6c8b8a5f25de202e10ea225d
** CIPHERTEXT (hex):
2761e6bfe839586b4c90954200bc4ce6d39ef164c5d14997755575d1691ee249ffd20beda526f57a7424907f839c6c2e3ecd46889ede290a2c81de22d3f33a7fa5e55ec95c0e26005c596d0f6346f819823f361f9f9f54d1eae48b325240d66c5888bd5ebab843061dcdd73b675346da982646c83026694d757661d31c2d654fb263c9ab3e874a258bc234c48532f15e9450c982fcf161404746e9f23d25e17b74139cd799983fd0c7a7a0386a823d3789b4578879a764172cc8ef96ab003eee24f6288007d31e2b999aff5a6d30cc524a0111a99730a29cf28ae41dbff6ce21ca6bc1df37074228178048e835584e6e70dba941154d024cd03cb6c56d0bde441ce464aa749de5e814dd30e21b75f62e831ac1f28eda1a7ba7e122076789e284402c8ba85b5a0e864bce220e3c78fa2f465e2bcf6b1d378816319de99f99ce7068
** <tt>my_multisig_wallet.dat</tt>:
<pre>df3d06db6c8b8a5f25de202e10ea225df6415d1ed0e36c64cc2be1b7e86c2a382761e6bfe839586b4c90954200bc4ce6d39ef164c5d14997755575d1691ee249ffd20beda526f57a7424907f839c6c2e3ecd46889ede290a2c81de22d3f33a7fa5e55ec95c0e26005c596d0f6346f819823f361f9f9f54d1eae48b325240d66c5888bd5ebab843061dcdd73b675346da982646c83026694d757661d31c2d654fb263c9ab3e874a258bc234c48532f15e9450c982fcf161404746e9f23d25e17b74139cd799983fd0c7a7a0386a823d3789b4578879a764172cc8ef96ab003eee24f6288007d31e2b999aff5a6d30cc524a0111a99730a29cf28ae41dbff6ce21ca6bc1df37074228178048e835584e6e70dba941154d024cd03cb6c56d0bde441ce464aa749de5e814dd30e21b75f62e831ac1f28eda1a7ba7e122076789e284402c8ba85b5a0e864bce220e3c78fa2f465e2bcf6b1d378816319de99f99ce7068</pre>

===Mode: <tt>EXTENDED</tt> Encryption===
====ROUND 1====
*Coordinator
** M-of-N: 2/3
** ADDRESS_TYPE: NESTED_SEGWIT
** TOKEN for Signer 1 (hex): 654d63309464afcda558c6aa
*** TOKEN (decimal): 31351541690484562733651510954
*** TOKEN (mnemonic): grab help slow churn enough traffic nice boat price
*** ENCRYPTION_KEY (hex):
4073adac2351e164b8d68039abd9d4b8e4d07adccfdf73ece6e236d60b107802
** TOKEN for Signer 2 (hex): b0344f51d5cb04083d598fa3
*** TOKEN (decimal): 54532600447720520868878192547
*** TOKEN (mnemonic): rabbit pen stamp process raccoon advice voice
cradle person
*** ENCRYPTION_KEY (hex):
6bae6b670e257d7468c3e90194029dd468a2f39d8b9a3ff187b08209b1d409b6
** TOKEN for Signer 3 (hex): 163fd307195982c4c39d50bb
*** TOKEN (decimal): 6885829092987042066541138107
*** TOKEN (mnemonic): bike write scrub crawl oblige give attack present rookie
*** ENCRYPTION_KEY (hex):
c78b94589214b6dc98b337ba4ce54380553ed00a1e5b1955fc540ce3b30d6566

* Signer 1
** MASTER_KEY_FINGERPRINT: 110dc257
** PRIVATE_KEY (m/48'/0'/0'/1'):
KzshDDEBhzyiwXHoyE7ZiLegzztEy54AG6Wq8N844LqHSQMHt4Ji
** XPUB (m/48'/0'/0'/1'):
xpub6EPQbDFezXYvVFHqnc8R7QUSE8hTepbyCXU7jJBT4dVm2rQHe1i6isqoj59qhyBiCdKquo6QsgMZNHvEz3BM4cNSszF25siTqLUCznBm8vk
** Legacy signature
** <tt>signer_1_key.bsms</tt>:
<pre>BSMS 1.0
654d63309464afcda558c6aa
[110dc257/48'/0'/0'/1']xpub6EPQbDFezXYvVFHqnc8R7QUSE8hTepbyCXU7jJBT4dVm2rQHe1i6isqoj59qhyBiCdKquo6QsgMZNHvEz3BM4cNSszF25siTqLUCznBm8vk
Signer 1 key
IDX6xLdM4XjetYPvVfpVBXAfT7oE3tHAOB4blZpbIst8bjJ+LbDeP4tZl4O8utAuys9igXE0G3kaHz1mg/+OU8w=</pre>

* Signer 1 encryption
** HMAC_KEY (hex):
f43c359a4b3d7b2e01be73c54519b12545ca9a23a86f824aadf577b314a7caa7
** MAC (hex): 40b6b43e2f1bc01b748eb242235d7e09fa8a2fd6cebe35784cf3adf81910ec98
** IV (hex) : 40b6b43e2f1bc01b748eb242235d7e09
** CIPHERTEXT (hex):
0877987764401c27e6c60ed2f1bb89dff1dbc5e8204149f682d53049bffe39553f24af3928aa2f78ac2d04ac5baa0c3ec39aaccf0d258e7bb6659a7b92e92f2c2784a94f4df8e8af2270d9d411bfff2cfb9f71b4e1ac87561c7d2ac57ca86a1f9716d5da7571719d24830fc8d015a0daf04b3742439484488798335357f2eeaa8e2db2ba630f9dffd88236e327ab5bfcfb6e29ee3ef6cc18e0b71c1731465c2351e76b92f7b1bd28ef6eff5414c22aa6c80090fa59b973c22e3044e92dbf3688990a49a42828e52c1e686f1193dcdf7b7118930e01419fe938c6811c58c84c36d692fd52846f998bc328471f1e73c22261791a08cda096ee3ac8b37f31afd0b1d9c335ff9ac67ff230eb0d69f2d7
** <tt>signer_1_key.dat</tt>:
<pre>40b6b43e2f1bc01b748eb242235d7e09fa8a2fd6cebe35784cf3adf81910ec980877987764401c27e6c60ed2f1bb89dff1dbc5e8204149f682d53049bffe39553f24af3928aa2f78ac2d04ac5baa0c3ec39aaccf0d258e7bb6659a7b92e92f2c2784a94f4df8e8af2270d9d411bfff2cfb9f71b4e1ac87561c7d2ac57ca86a1f9716d5da7571719d24830fc8d015a0daf04b3742439484488798335357f2eeaa8e2db2ba630f9dffd88236e327ab5bfcfb6e29ee3ef6cc18e0b71c1731465c2351e76b92f7b1bd28ef6eff5414c22aa6c80090fa59b973c22e3044e92dbf3688990a49a42828e52c1e686f1193dcdf7b7118930e01419fe938c6811c58c84c36d692fd52846f998bc328471f1e73c22261791a08cda096ee3ac8b37f31afd0b1d9c335ff9ac67ff230eb0d69f2d7</pre>

* Signer 2
** MASTER_KEY_FINGERPRINT: 5c890401
** PRIVATE_KEY (m/48'/0'/0'/1'):
L41Jnc9CdBtBJd18429MDGcTgP2DNoXaKyyGr271ndTprvrHXDQf
** XPUB (m/48'/0'/0'/1'):
xpub6EW1SmjSXq9YwVwcan5qWEncgx89SozMvGNpYF6hfZHYNTikNZ4gsXuVhHTi6xYJCkmY4X4wpPPS5Gr7aY39dVJMS2TGfihr25oaspKtU8q
** Legacy signature
** <tt>signer_2_key.bsms</tt>:
<pre>BSMS 1.0
b0344f51d5cb04083d598fa3
[5c890401/48'/0'/0'/1']xpub6EW1SmjSXq9YwVwcan5qWEncgx89SozMvGNpYF6hfZHYNTikNZ4gsXuVhHTi6xYJCkmY4X4wpPPS5Gr7aY39dVJMS2TGfihr25oaspKtU8q
Signer 2 key
H5kN6UHaK2xACB6iYdTxxQPD8qyFEYv9iMsQs5B0MRfCM7NA5GB+7EFgmBpSctwt6B122zWBr6mRjpYjKmj+7hs=</pre>

* Signer 2 encryption
** HMAC_KEY (hex):
e0a20b5f5285fbaa35aad08fb70f5626c9abbe1b384a4950735b28aca6325ff2
** MAC (hex): 3a6deec8dbdbd6606a52c7d7e64eca4f972a293cbabac6f62736629fbe77928a
** IV (hex) : 3a6deec8dbdbd6606a52c7d7e64eca4f
** CIPHERTEXT (hex):
bb0fb72f61b0c4858bd9c65235390b67651b94c4b0329238b0116dd6d3365ade33cb1c1b1619638968791a5d2d1d263d90280bdad8d9ca24c34a78e320076e0dccf59e7f729b541b44bbe40ba803dedd3b17c49765377cb2d913a856b86c3dd383dab475790e89226ed8ef2301574212d2809ed9c099aa67be434024ee2a4e82a146300acf755863da64807cb7bb2636f6616489636d254a870778d3540832aea44abac4328b5d90f3e6045ef36a526ce5d575f2305e3e4699dccbc713e9e68f50364036c1054c2a506aab77ea7c43a89536947c24330b09a62a90c3b4ae2d452f96ef34ec871af2c52d68ddede2503c87e2ba68d5cf9be589457879e06021ea6a6176f7dded820ba4c0e709e2a2
** <tt>signer_2_key.dat</tt>:
<pre>3a6deec8dbdbd6606a52c7d7e64eca4f972a293cbabac6f62736629fbe77928abb0fb72f61b0c4858bd9c65235390b67651b94c4b0329238b0116dd6d3365ade33cb1c1b1619638968791a5d2d1d263d90280bdad8d9ca24c34a78e320076e0dccf59e7f729b541b44bbe40ba803dedd3b17c49765377cb2d913a856b86c3dd383dab475790e89226ed8ef2301574212d2809ed9c099aa67be434024ee2a4e82a146300acf755863da64807cb7bb2636f6616489636d254a870778d3540832aea44abac4328b5d90f3e6045ef36a526ce5d575f2305e3e4699dccbc713e9e68f50364036c1054c2a506aab77ea7c43a89536947c24330b09a62a90c3b4ae2d452f96ef34ec871af2c52d68ddede2503c87e2ba68d5cf9be589457879e06021ea6a6176f7dded820ba4c0e709e2a2</pre>

* Signer 3
** MASTER_KEY_FINGERPRINT: 614cbf5f
** PRIVATE_KEY (m/48'/0'/0'/1'):
L2ccRLzH7GfVxWpU8YSY9y5UGyRoqW3UdeNT1vGfVbxAGhwU5qhD
** XPUB (m/48'/0'/0'/1'):
xpub6F9TfWTFcMYy5Ycd2ka2az1brJj78J2isLAWptZnCpFsesss5sZv5B8xsgt71ZXfhDWhUtf4vng4zY6HUVrQbDMPDYRLYvFFoLnAYfzgYPH
** Legacy signature
** <tt>signer_3_key.bsms</tt>:
<pre>BSMS 1.0
163fd307195982c4c39d50bb
[614cbf5f/48'/0'/0'/1']xpub6F9TfWTFcMYy5Ycd2ka2az1brJj78J2isLAWptZnCpFsesss5sZv5B8xsgt71ZXfhDWhUtf4vng4zY6HUVrQbDMPDYRLYvFFoLnAYfzgYPH
Signer 3 key
H0jf2JMtke5zDDIWys6fihOCA6QBmC5+hbgVB/c2mMPNPLB6tDXt0TFZU1f9wvaCR9762anKSc8CCqXLogw8V00=</pre>

* Signer 3 encryption
** HMAC_KEY (hex):
1f51ea067c121e2f86af5e1d484905046bc63e861573157d8b1ae9e7e47e224b
** MAC (hex): 1a5624fcb39cebabb6174456173eec19b756bc916cf2c9d815e9bcce070898c4
** IV (hex) : 1a5624fcb39cebabb6174456173eec19
** CIPHERTEXT (hex):
48d6e139bdc8c19e93cbbf5b4478340c8cf08aa91c28803084d5f58618773f7e615e0134492b496c4e7c130351c0350701f686918033f621378552d7040efedd5539d38c258bf936475de775f23da3953fe3ba5bbbd24816b8902b87a9a09700c446b085119dedee2395dd69665e742f72f2fb6da4ebe3f4704eaf45486fbfb84d764b718cc0b756e72f72ab6069d47765bdd3ebd4074af4fa99a95691a659675ce5f72235c28ddf3c3d53179e598cddc967fc896adc6e97edeeffc85b9e44611df748d923ff3dd921ad4d6e98e0de12359a37558e326faf585ba57e73ab45bc4a49f6e8a756f365f5d204e70f7c7bed269e81e9524a41e5d4cbaad0b6b442d6eea1e5da1ca345cc665a0cffe2c3
** <tt>signer_3_key.dat</tt>:
<pre>1a5624fcb39cebabb6174456173eec19b756bc916cf2c9d815e9bcce070898c448d6e139bdc8c19e93cbbf5b4478340c8cf08aa91c28803084d5f58618773f7e615e0134492b496c4e7c130351c0350701f686918033f621378552d7040efedd5539d38c258bf936475de775f23da3953fe3ba5bbbd24816b8902b87a9a09700c446b085119dedee2395dd69665e742f72f2fb6da4ebe3f4704eaf45486fbfb84d764b718cc0b756e72f72ab6069d47765bdd3ebd4074af4fa99a95691a659675ce5f72235c28ddf3c3d53179e598cddc967fc896adc6e97edeeffc85b9e44611df748d923ff3dd921ad4d6e98e0de12359a37558e326faf585ba57e73ab45bc4a49f6e8a756f365f5d204e70f7c7bed269e81e9524a41e5d4cbaad0b6b442d6eea1e5da1ca345cc665a0cffe2c3</pre>

====ROUND 2====
* Coordinator
** <tt>my_multisig_wallet.bsms</tt>:
<pre>BSMS 1.0
/0/*,/1/*
sh(wsh(multi(2,[110dc257/48'/0'/0'/1']xpub6EPQbDFezXYvVFHqnc8R7QUSE8hTepbyCXU7jJBT4dVm2rQHe1i6isqoj59qhyBiCdKquo6QsgMZNHvEz3BM4cNSszF25siTqLUCznBm8vk/*,[5c890401/48'/0'/0'/1']xpub6EW1SmjSXq9YwVwcan5qWEncgx89SozMvGNpYF6hfZHYNTikNZ4gsXuVhHTi6xYJCkmY4X4wpPPS5Gr7aY39dVJMS2TGfihr25oaspKtU8q/*,[614cbf5f/48'/0'/0'/1']xpub6F9TfWTFcMYy5Ycd2ka2az1brJj78J2isLAWptZnCpFsesss5sZv5B8xsgt71ZXfhDWhUtf4vng4zY6HUVrQbDMPDYRLYvFFoLnAYfzgYPH/*)))#j3ykhz7f</pre>

* Send to Signer 1:
** HMAC_KEY (hex):
f43c359a4b3d7b2e01be73c54519b12545ca9a23a86f824aadf577b314a7caa7
** MAC (hex): ee74a0f50943d7d1b65270028bb05133e87c832cdc1ef0a07c79db2093ca3432
** IV (hex) : ee74a0f50943d7d1b65270028bb05133
** CIPHERTEXT (hex):
8e3ba3dac0f979fad0d160bd00c8294ff1726d51b95ff3e1534e5a1900f3d7cd4f6d929985a94b9da2c11e4e0f7770cc53c6739fd099477323bd26a3eca9c8016e79848d15e274463424b8355cd73cced61f1816ac8bac87f8c650ee9052f50e347c52ad24b00794a9d5523714be2fdcf731f14b7a8d7c93eab44c258e1c417d2837b9676832e8ce7239dc28b4e1166803209947b8a875a99b9478ee94f7bc17399e886179ab2a0285dc11a3883f6fa439d0f2277dadbec8c355c379fc50e945897e1a738f6a55b09f6b8b6bdf6d4bc248219cbad3662a78a2f539c989e055e00b8efd42fbff978e1a5cc10f83df56117ece4d17f94a0a6d3803778ed53531419250c5a0fff6cad4ab401468dd054915b068cc8826ae1308a71b38060d68c9248d59eea11c2c52a66d5f6bc0d7ae6cb44305c36e56068456d293b70037902e7b05a3ee0af710201128dffc0c16c3306b66bd19b9ae5b91aded35ef33f07743e5b185a9f88a5c67d40270e3bbcf592167ceaf82ead693728d5129b50075edd5ce24863f3484b4b063599ed1327e1c87d0a2051fed3b1234a702722b686e4c9392a403b79726800dd6b691e516e44d9e836c190b10cf2bb262bba98293c97f2c323e59acd0a1f988c5
** <tt>my_multisig_wallet_for_signer_1.dat</tt>:
<pre>ee74a0f50943d7d1b65270028bb05133e87c832cdc1ef0a07c79db2093ca34328e3ba3dac0f979fad0d160bd00c8294ff1726d51b95ff3e1534e5a1900f3d7cd4f6d929985a94b9da2c11e4e0f7770cc53c6739fd099477323bd26a3eca9c8016e79848d15e274463424b8355cd73cced61f1816ac8bac87f8c650ee9052f50e347c52ad24b00794a9d5523714be2fdcf731f14b7a8d7c93eab44c258e1c417d2837b9676832e8ce7239dc28b4e1166803209947b8a875a99b9478ee94f7bc17399e886179ab2a0285dc11a3883f6fa439d0f2277dadbec8c355c379fc50e945897e1a738f6a55b09f6b8b6bdf6d4bc248219cbad3662a78a2f539c989e055e00b8efd42fbff978e1a5cc10f83df56117ece4d17f94a0a6d3803778ed53531419250c5a0fff6cad4ab401468dd054915b068cc8826ae1308a71b38060d68c9248d59eea11c2c52a66d5f6bc0d7ae6cb44305c36e56068456d293b70037902e7b05a3ee0af710201128dffc0c16c3306b66bd19b9ae5b91aded35ef33f07743e5b185a9f88a5c67d40270e3bbcf592167ceaf82ead693728d5129b50075edd5ce24863f3484b4b063599ed1327e1c87d0a2051fed3b1234a702722b686e4c9392a403b79726800dd6b691e516e44d9e836c190b10cf2bb262bba98293c97f2c323e59acd0a1f988c5</pre>

* Send to Signer 2:
** HMAC_KEY (hex):
e0a20b5f5285fbaa35aad08fb70f5626c9abbe1b384a4950735b28aca6325ff2
** MAC (hex): 81df9e064f1de1d5f754c4e20f9286f9d81b856d3965677a9f2430cb9297ad1f
** IV (hex) : 81df9e064f1de1d5f754c4e20f9286f9
** CIPHERTEXT (hex):
dcd82038ef627d6cb2deb62d04c4ccbaa3a354633d960e46312c22791f039f23fd9782a1e3a63504c1e5b3a0770bb8d32fdf168738b6c03278f1391dd5d01e9aafee7be2c8136ee018feff6fc8cdb926df13a36e115ddca8254934f56b7f700768c94cb8388a8297834de9affcd959417ae3d6ec3251387904f50f51f06306cc4d36eefc51418dd3b2c5454910a23ec67a40a3b918d2a740e812929aae949d8dde2c41cbbb3a2b7c2103788421c147f4794d6a26947c15ef4a99ceb825d0c5aaa78b8737d0ef712ba8e269a9941b1af5d217dcdd9cd06727fbdc70fabe3f5a8c09acff4e76992be7f27c6b12ca84739f62a6da86e5b79103d632c0dc8ab3f91fddb3cfbe67084dc4b861c4ac7c86fb171a058c98c67cffdc40ff17ae1533361cc6fb7b63657af0408cf30bf9d6d97aaacf9d3ff443eee61f207228cd91769ce83a0709c1be1847884c6a8fdc86ede66aef8e34fc509c49edf30f743bdc8f9052961ee340924ec2d1caadc6fd286bb3e233c153cd08c1934127752dc28e0d12efa92a050c4061653edb1cbf2fd4b2ba4e038f0b44f5735f198e92571c029156f65f534bfc149f38d611829901372cfc0176b9d2f9ac6512b7f37941a02dff701df0bceadaacfc6935
** <tt>my_multisig_wallet_for_signer_2.dat</tt>:
<pre>81df9e064f1de1d5f754c4e20f9286f9d81b856d3965677a9f2430cb9297ad1fdcd82038ef627d6cb2deb62d04c4ccbaa3a354633d960e46312c22791f039f23fd9782a1e3a63504c1e5b3a0770bb8d32fdf168738b6c03278f1391dd5d01e9aafee7be2c8136ee018feff6fc8cdb926df13a36e115ddca8254934f56b7f700768c94cb8388a8297834de9affcd959417ae3d6ec3251387904f50f51f06306cc4d36eefc51418dd3b2c5454910a23ec67a40a3b918d2a740e812929aae949d8dde2c41cbbb3a2b7c2103788421c147f4794d6a26947c15ef4a99ceb825d0c5aaa78b8737d0ef712ba8e269a9941b1af5d217dcdd9cd06727fbdc70fabe3f5a8c09acff4e76992be7f27c6b12ca84739f62a6da86e5b79103d632c0dc8ab3f91fddb3cfbe67084dc4b861c4ac7c86fb171a058c98c67cffdc40ff17ae1533361cc6fb7b63657af0408cf30bf9d6d97aaacf9d3ff443eee61f207228cd91769ce83a0709c1be1847884c6a8fdc86ede66aef8e34fc509c49edf30f743bdc8f9052961ee340924ec2d1caadc6fd286bb3e233c153cd08c1934127752dc28e0d12efa92a050c4061653edb1cbf2fd4b2ba4e038f0b44f5735f198e92571c029156f65f534bfc149f38d611829901372cfc0176b9d2f9ac6512b7f37941a02dff701df0bceadaacfc6935</pre>

* Send to Signer 3:
** HMAC_KEY (hex):
1f51ea067c121e2f86af5e1d484905046bc63e861573157d8b1ae9e7e47e224b
** MAC (hex): 159a91100cacd123480b7d085c8bb32ec8eb06f0391b6dc8fac07ae67eb37b81
** IV (hex) : 159a91100cacd123480b7d085c8bb32e
** CIPHERTEXT (hex):
c7269d8be21d1cfe172e35aa106760f1fdc929fce19da8fb7f74f759efec1ee02796fb1e8b008cf177f60a2021570f17aeeb41f8636858654082734b90959b98fd08419f901683c4ca3e76b3e482fea4c67162775e0d80bcb45df729f646c1364a3d8a7d1ff961717b00897e877c1c0554d3502942149726806269c546ad2dd34ba286ddf5cd336b83aabf7091fa25e607faf7e54017d84113e1e3ec440b3704addea188b89293469306fc0a98570afdcf269026b2d2e760f466c1f75bcf75fdf030c0a692e5681fd4487e59d6e96451ff5b6b9f2521b8e95e796ef4ab0a917794d91a30fdac7ee9ddbd89d174831bd133ab12a74f52f6283ee2c5fe3d5a957a7c1a15530b2c5224f76d90057dc94f2ee34e28b037ae7f518cc6dfe725cd3e657648de82b200ea77830eb93219f883998d3207a4ef5902d1119b0cde6b364bc1effb86109d9c2babc8ab26dce90329779d8cd0d737e9825a25586aa3c8fa5317e3e433ff235b82f629de0504e3c992f8e8de299f62751bc1fcb2e75e0262c7a27be7068cea69b14f303e97c24b99ed29cae142564e285657704b4c411d0d4f8c58819e2c0e0ffc3667eb5a408aad8a3023a5f00875e7deab95dc365d8757f7b79815a4fd9e6de2b3
** <tt>my_multisig_wallet_for_signer_3.dat</tt>:
<pre>159a91100cacd123480b7d085c8bb32ec8eb06f0391b6dc8fac07ae67eb37b81c7269d8be21d1cfe172e35aa106760f1fdc929fce19da8fb7f74f759efec1ee02796fb1e8b008cf177f60a2021570f17aeeb41f8636858654082734b90959b98fd08419f901683c4ca3e76b3e482fea4c67162775e0d80bcb45df729f646c1364a3d8a7d1ff961717b00897e877c1c0554d3502942149726806269c546ad2dd34ba286ddf5cd336b83aabf7091fa25e607faf7e54017d84113e1e3ec440b3704addea188b89293469306fc0a98570afdcf269026b2d2e760f466c1f75bcf75fdf030c0a692e5681fd4487e59d6e96451ff5b6b9f2521b8e95e796ef4ab0a917794d91a30fdac7ee9ddbd89d174831bd133ab12a74f52f6283ee2c5fe3d5a957a7c1a15530b2c5224f76d90057dc94f2ee34e28b037ae7f518cc6dfe725cd3e657648de82b200ea77830eb93219f883998d3207a4ef5902d1119b0cde6b364bc1effb86109d9c2babc8ab26dce90329779d8cd0d737e9825a25586aa3c8fa5317e3e433ff235b82f629de0504e3c992f8e8de299f62751bc1fcb2e75e0262c7a27be7068cea69b14f303e97c24b99ed29cae142564e285657704b4c411d0d4f8c58819e2c0e0ffc3667eb5a408aad8a3023a5f00875e7deab95dc365d8757f7b79815a4fd9e6de2b3</pre>

==Acknowledgement==

Special thanks to Pavol Rusnak, Dmitry Petukhov, Christopher Allen,
Craig Raw, Robert Spigler, Gregory Sanders, Ta Tat Tai, Michael
Flaxman, Pieter Wuille and others for their feedback on the
specification.

==References==

Original mailing list thread:
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-February/018385.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210405/4f9dbebb/attachment-0001.html>

From erik at q32.com  Mon Apr  5 22:36:48 2021
From: erik at q32.com (Erik Aronesty)
Date: Mon, 5 Apr 2021 18:36:48 -0400
Subject: [bitcoin-dev] Announcing a new standard for soft fork activation
In-Reply-To: <CAFvNmHSO1qBv2Lm4uHq82oEx5nxayKRsyP3Vx6BNfHJiOaztPQ@mail.gmail.com>
References: <CAFvNmHSO1qBv2Lm4uHq82oEx5nxayKRsyP3Vx6BNfHJiOaztPQ@mail.gmail.com>
Message-ID: <CAJowKgJS4UY_FVf7i18WFRYVHR0+EhJ066UwHFngvz8dxuoYaQ@mail.gmail.com>

this satire points out the "bikeshedding" problem, or the "law of triviality".
a problem is discussed in proportion to the number of people who feel
qualified to talk about them.
few users are experts at the cryptography, and even fewer are experts
at c++, cryptography and possibly game theory
therefore the number of people who feel qualified to analyze or
discuss the proposed changes are few  (schorr sigs are hopefully the
least controversial)
whereas the mechanism for activation is relatively easy to understand

schnorr:  improved signature scheme, can reduce tx size (ACK)
mast: reduces tx size and improve privacy of of complex contracts (ACK)
taproot: mast... but it looks like p2pkh (ACK)
activation:   bikeshedding not necessary now.

On Thu, Apr 1, 2021 at 11:15 AM Michael Folkson via bitcoin-dev
<bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> There have been a vast number of proposals for soft fork activation in recent months and it is important that all these important ideas don?t go to waste. Hence I propose a new standard for soft fork activation incorporating all the ideas into one standard. I appreciate this standard has come too late for Taproot activation but it should be ready for any future soft forks. It is a multi phase, multi year standard. No soft fork can activate unless and until it has successfully passed through all of the different 14 phases. This will demonstrate Bitcoin?s ultimate conservatism.
>
> Phase 1) Let?s See What Happens - BIP 8 (false, 0.25 years). The shortest phase just to whet appetites.
>
> Phase 2) Start now, improve later - BIP 8(false, 1 year) A confusing name, it starts but it doesn't improve later
>
> Phase 3) BIP 9 equivalent - BIP 8(false, 1 year)
>
> Phase 4) Gently discourage apathy - BIP 8(true, 1 year) Forced signaling at the end of this phase but obviously there are still many phases before the soft fork can actually activate.
>
> Phase 5) BIP 91 (1 year). As a nod to our SegWit history we have a BIP 91 activation phase.
>
> Phase 6) BIP 148 (1 year). Some people disagree that BIP 91 activated SegWit so we do a BIP 148 activation phase to keep those people happy. Again forced signaling doesn?t actually mean activation. There are still many more phases to pass through.
>
> Phase 7) Speedy Trial (using block height, 0.5 years) on mainnet
>
> Phase 8) Speedy Trial (using MTP, 0.5 years) on mainnet
>
> Phase 9) Speedy Trial on the default signet (0.5 years)
>
> Phase 10) Speedy Trial on a combination of three different custom signets in parallel (0.5 years)
>
> Phase 11) Speedy Trial on testnet and a custom signet in parallel (0.5 years)
>
> Phase 12) Modern Soft Fork Activation (3.5 years) This is the longest phase of the soft fork activation standard. It is itself multi phase and multi year so this can be considered a nested activation phase within this standard.
>
> Phase 13) UASF BIP 8 (LOT=true, 1 year). Forced miner signaling at the end of this phase but ultimately the soft fork doesn?t yet activate as there is one final additional phase the activation must pass through. This gives Samson the opportunity to sell some hats. We are close now. The natives are getting restless.
>
> Phase 14) Second flag day (1 year) We don?t want those pesky users actually activating a soft fork on their own so an additional flag day is added just so we can tell users that we prevented a chain split.
>
> Assuming a soft fork activation has successfully passed through all these 14 phases it should activate. It will take a minimum of 13 years. However, if it fails during any one of these phases it has to start from Phase 1 again. We should take Bitcoin?s conservatism very seriously. If a soft fork activation can?t pass successfully through all these phases it shouldn?t activate. Ultimately we don?t really mind what is in the soft fork (any idiot can design consensus changes and write secure bug free C++ code) that is very much secondary in importance to *how* the soft fork is activated. The activation design absolutely must be conservative.
>
> I expect this rigorous standard for soft fork activation will get a BIP number. If you are going to propose a future soft fork I recommend you plan for activation in approximately 13 years from the point the soft fork code is merged into Core.
>
> I am happy to settle the soft fork activation question once and for all for the community. I expect in time my contribution will be recognized in the annals of history with Satoshi Nakamoto and Hal Finney.
>
> Addendum: Although all future soft forks will ultimately use this standard, this standard is copyrighted. Every time it is used royalties must be paid into this quantum secure Bitcoin vanity address 1quantumsecureaddress
>
>
> --
> Michael Folkson
> Email: michaelfolkson at gmail.com
> Keybase: michaelfolkson
> PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

From jlrubin at mit.edu  Tue Apr  6 04:18:52 2021
From: jlrubin at mit.edu (Jeremy)
Date: Mon, 5 Apr 2021 21:18:52 -0700
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <20210405103452.GA15866@erisian.com.au>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <20210405103452.GA15866@erisian.com.au>
Message-ID: <CAD5xwhgjMPy=5oQ3G-wL08V_N4Z_igNy9GFa4B2mzJtMZNxgxg@mail.gmail.com>

I found the "50% chance of activating" a bit confusing of a watermark, so I
asked AJ if he didn't mind producing and tabulating the 10% chance, 50%
chance, and 90% chance to show the sharpness of the bounds better. Each
category below shows the single-shot and repeated trial odds for the range
of trials (5 to 7). Additionally, I ran the 99% & 1% band to show that
we're likely to not have a false positive if < 87% is signalling nor a
false negative if > 90% is signalling

1%:
    87.61% hashpower gives 0.20188% chance of success for 0.01005% chance
over 5 trials
    87.47% hashpower gives 0.14044% chance of success for 0.00979% chance
over 7 trials
    86.74% hashpower gives 0.01929% chance of success for 0.00979% chance
over 51 trials
    86.74% hashpower gives 0.02080% chance of success for 0.01138% chance
over 55 trials


99%:
    89.34% hashpower gives 60.19226% chance of success for 0.99000% chance
over 5 trials
    89.08% hashpower gives 48.20380% chance of success for 0.99000% chance
over 7 trials

    87.94% hashpower gives 8.63591% chance of success for 0.99001% chance
over 51 trials
    87.90% hashpower gives 8.03152% chance of success for 0.99000% chance
over 55 trials


I was also curious to see what hashrate we'd need to have the classic 5 9's
of reliability if we were to only have *two* periods to signal. This serves
a decent check for the situation where the earlier periods in a ST should
be discounted (i.e., P(signals> 90% | first 3 periods) = 0) because miners
still need time to upgrade.

91.03% hashpower gives 99.68578% chance of success for 0.99999% chance over
2 trials

I believe this demonstrates more strongly that MTP can be used to ensure a
smooth upgrade.

------------------------


Should've been 1815, and seems like I had some older code that deals
with precision better, so:

10%:
   88.15% gives 2.08538% chance of success for 0.10001% chance over 5 trials
   87.98% gives 1.49100% chance of success for 0.09982% chance over 7 trials

   87.16% gives 0.20610% chance of success for 0.09987% chance over 51
trials
   87.13% gives 0.18834% chance of success for 0.09849% chance over 55
trials

50%:
   88.67% gives 12.94200% chance of success for 0.49992% chance over 5
trials
   88.47% gives 9.42506% chance of success for 0.49990% chance over 7 trials

   87.53% gives 1.35127% chance of success for 0.50035% chance over 51
trials
   87.50% gives 1.25229% chance of success for 0.49998% chance over 55
trials

90%:
   89.07% gives 36.90722% chance of success for 0.90002% chance over 5
trials
   88.83% gives 28.02839% chance of success for 0.89997% chance over 7
trials

   87.78% gives 4.41568% chance of success for 0.90006% chance over 51
trials
   87.75% gives 4.09983% chance of success for 0.89999% chance over 55
trials

So 0.24% is the biggest difference for 5-7 trials at 90%, but the entire
range is under 2% anyway (87.13% for 55 trials to get 10% vs 89.07%
for 5 trials to get 90%).

Note, each "trial" is a retarget period here...

Code:
https://gist.github.com/ajtowns/fbcf30ed9d0e1708fdc98a876a04ff69#file-repeated_trials-py

--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>


On Mon, Apr 5, 2021 at 3:35 AM Anthony Towns <aj at erisian.com.au> wrote:

> On Sat, Apr 03, 2021 at 09:39:11PM -0700, Jeremy via bitcoin-dev wrote:
> > As such, the main conversation in this agenda item is
> > around the pros/cons of height or MTP and determining if we can reach
> consensus
> > on either approach.
>
> Here's some numbers.
>
> Given a desired signalling period of xxx days, where signaling begins
> on the first retarget boundary after the starttime and ends on the last
> retarget boundary before the endtime, this is how many retarget periods
> you get (based on blocks since 2015-01-01):
>
>  90 days: mainnet  5-7 full 2016-block retarget periods
> 180 days: mainnet 11-14
> 365 days: mainnet 25-27
> 730 days: mainnet 51-55
>
> (This applies to non-signalling periods like the activation/lock in delay
> too of course. If you change it so that it ends at the first retarget
> period after endtime, all the values just get incremented -- ie, 6-8,
> 12-15 etc)
>
> If I've got the maths right, then requiring 1814 of 2016 blocks to signal,
> means that having 7 periods instead of 5 lets you get a 50% chance of
> successful activation by maintaining 89.04% of hashpower over the entire
> period instead of 89.17%, while 55 periods instead of 51 gives you a 50%
> chance of success with 88.38% hashpower instead of 88.40% hashpower.
> So the "repeated trials" part doesn't look like it has any significant
> effect on mainnet.
>
> If you target yy periods instead of xxx days, starting and ending on a
> retarget boundary, you get the following stats from the last few years
> of mainnet (again starting at 2015-01-01):
>
>  1 period:  mainnet 11-17 days (range 5.2 days)
>  7 periods: mainnet 87-103 days (range 15.4 days)
> 13 periods: mainnet 166-185 days (range 17.9 days)
> 27 periods: mainnet 352-377 days (range 24.4 days)
> 54 periods: mainnet 711-747 days (range 35.0 days)
>
> As far as I can see the questions that matter are:
>
>  * is signalling still possible by the time enough miners have upgraded
>    and are ready to start signalling?
>
>  * have nodes upgraded to enforce the new rules by the time activation
>    occurs, if it occurs?
>
> But both those benefit from less real time variance, rather than less
> variance in the numbers of signalling periods, at least in every way
> that I can think of.
>
> Corresponding numbers for testnet:
>
>  90 days: testnet   5-85
> 180 days: testnet  23-131
> 365 days: testnet  70-224
> 730 days: testnet 176-390
>
> (A 50% chance of activating within 5 periods requires sustaining 89.18%
> hashpower; within 85 periods, 88.26% hashpower; far smaller differences
> with all the other ranges -- of course, presumably the only way the
> higher block rates ever actually happen is by someone pointing an ASIC at
> testnet, and thus controlling 100% of blocks for multiple periods anyway)
>
>   1 period:  testnet 5.6minutes-26 days (range 26.5 days)
>  13 periods: testnet 1-135 days (range 133.5 days)
>  27 periods: testnet 13-192 days (range 178.3 days)
>  54 periods: testnet 39-283 days (range 243.1 days)
> 100 periods: testnet 114-476 days (range 360.9 days)
>              (this is the value used in [0] in order to ensure 3 months'
>               worth of signalling is available)
> 132 periods: testnet 184-583 days (range 398.1 days)
> 225 periods: testnet 365-877 days (range 510.7 days)
> 390 periods: testnet 725-1403 days (range 677.1 days)
>
> [0] https://github.com/bitcoin/bips/pull/1081#pullrequestreview-621934640
>
> Cheers,
> aj
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210405/6228cbf2/attachment-0001.html>

From michaelfolkson at gmail.com  Tue Apr  6 13:36:05 2021
From: michaelfolkson at gmail.com (Michael Folkson)
Date: Tue, 6 Apr 2021 14:36:05 +0100
Subject: [bitcoin-dev] Update on "Speedy" Trial
Message-ID: <CAFvNmHQX8g=yRuvb+NGNT1A5L0+omKb9AjvD0B-1wqo0DiC6Wg@mail.gmail.com>

(The email last week was an April Fools. I did my best to make light of the
situation...)
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-April/018724.html

I'd like to give the list an update on where we are with Speedy Trial
because it is just as absurd as it looks to an outside observer. As a
reminder of the timeline:

February 2nd: Community meeting (100+ attendees including Core
contributors) where there was broad consensus that BIP 9 was "dead" in
favor of BIP 8. BIP 8 (which uses block heights) was revised to be a BIP 9
replacement.
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-February/018379.html

March 6th: With no clear community consensus on whether the LOT parameter
should be set to true or false in BIP 8, Russell O'Connor proposed "Speedy
Trial". Taking an excerpt from David Harding's mailing list post "Speedy
Trial is a way to generate fast progress" and can "fail fast".
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-March/018583.html

April 6th: There are two open PRs in Bitcoin Core. PR #21377 from AJ Towns
which attempts to bring BIP 9 back to life and use MTP over block height
because MTP is better for test networks. (Apparently mainnet is a test
network for testnet and signet these days) And PR #21392 from Andrew Chow
which uses BIP 8 and block height as discussed in those first community
meetings. BIP 8 has been revised to incorporate Speedy Trial while BIP 9
hasn't.

I think we are fast approaching a time where we are in exactly the same
situation as we were with the LOT parameter. Bitcoin Core is unable to
merge anything because of limited opposition to using block height of all
things.

I do encourage everyone to look at this and understand which individuals
are making this situation absurd. They will most likely be the same
individuals that decry the dangers of a future UASF having made "Speedy"
Trial a total oxymoron.

I won't be attending the meeting later, I'd rather pull teeth. If people
are in agreement with me on no further progress being possible in Core I
think we will need to restart the UASF discussions. Luke warned that these
kinds of shenanigans could happen but I really lacked imagination on the
tricks some people could pull.

-- 
Michael Folkson
Email: michaelfolkson at gmail.com
Keybase: michaelfolkson
PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210406/6352f8e2/attachment.html>

From roconnor at blockstream.com  Tue Apr  6 14:34:57 2021
From: roconnor at blockstream.com (Russell O'Connor)
Date: Tue, 6 Apr 2021 10:34:57 -0400
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <20210405103452.GA15866@erisian.com.au>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <20210405103452.GA15866@erisian.com.au>
Message-ID: <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>

I'm pretty sure that the question of "is signalling still possible by the
time enough miners have upgraded and are ready to start signalling?"
Strongly benefits from a guaranteed number of signaling periods that height
based activation offers.  Especially for the short activation period of
Speedy Trial.

The other relevant value of giving enough time for users to upgrade is not
very sensitive.  It's not like 180 days is magic number that going over is
safe and going below is unsafe.

That said, as Jeremy has pointed out before (maybe it was on IRC), we can
almost ensure a minimum of 7 retargeting periods by carefully selecting
signaling start and end dates to line up in the middle of expected
retargeting periods that we would otherwise chose with height based
activation. Why we would rather use MTP to fake a height based activation,
I will never understand. But if this is what it takes to activate taproot,
that is fine by me.

The differences between height and MTP activation are too small to matter
that much for what is ultimately transient code.  As long as MTP activation
can pass code review it is okay with me.


On Mon., Apr. 5, 2021, 06:35 Anthony Towns via bitcoin-dev, <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> On Sat, Apr 03, 2021 at 09:39:11PM -0700, Jeremy via bitcoin-dev wrote:
> > As such, the main conversation in this agenda item is
> > around the pros/cons of height or MTP and determining if we can reach
> consensus
> > on either approach.
>
> Here's some numbers.
>
> Given a desired signalling period of xxx days, where signaling begins
> on the first retarget boundary after the starttime and ends on the last
> retarget boundary before the endtime, this is how many retarget periods
> you get (based on blocks since 2015-01-01):
>
>  90 days: mainnet  5-7 full 2016-block retarget periods
> 180 days: mainnet 11-14
> 365 days: mainnet 25-27
> 730 days: mainnet 51-55
>
> (This applies to non-signalling periods like the activation/lock in delay
> too of course. If you change it so that it ends at the first retarget
> period after endtime, all the values just get incremented -- ie, 6-8,
> 12-15 etc)
>
> If I've got the maths right, then requiring 1814 of 2016 blocks to signal,
> means that having 7 periods instead of 5 lets you get a 50% chance of
> successful activation by maintaining 89.04% of hashpower over the entire
> period instead of 89.17%, while 55 periods instead of 51 gives you a 50%
> chance of success with 88.38% hashpower instead of 88.40% hashpower.
> So the "repeated trials" part doesn't look like it has any significant
> effect on mainnet.
>
> If you target yy periods instead of xxx days, starting and ending on a
> retarget boundary, you get the following stats from the last few years
> of mainnet (again starting at 2015-01-01):
>
>  1 period:  mainnet 11-17 days (range 5.2 days)
>  7 periods: mainnet 87-103 days (range 15.4 days)
> 13 periods: mainnet 166-185 days (range 17.9 days)
> 27 periods: mainnet 352-377 days (range 24.4 days)
> 54 periods: mainnet 711-747 days (range 35.0 days)
>
> As far as I can see the questions that matter are:
>
>  * is signalling still possible by the time enough miners have upgraded
>    and are ready to start signalling?
>
>  * have nodes upgraded to enforce the new rules by the time activation
>    occurs, if it occurs?
>
> But both those benefit from less real time variance, rather than less
> variance in the numbers of signalling periods, at least in every way
> that I can think of.
>
> Corresponding numbers for testnet:
>
>  90 days: testnet   5-85
> 180 days: testnet  23-131
> 365 days: testnet  70-224
> 730 days: testnet 176-390
>
> (A 50% chance of activating within 5 periods requires sustaining 89.18%
> hashpower; within 85 periods, 88.26% hashpower; far smaller differences
> with all the other ranges -- of course, presumably the only way the
> higher block rates ever actually happen is by someone pointing an ASIC at
> testnet, and thus controlling 100% of blocks for multiple periods anyway)
>
>   1 period:  testnet 5.6minutes-26 days (range 26.5 days)
>  13 periods: testnet 1-135 days (range 133.5 days)
>  27 periods: testnet 13-192 days (range 178.3 days)
>  54 periods: testnet 39-283 days (range 243.1 days)
> 100 periods: testnet 114-476 days (range 360.9 days)
>              (this is the value used in [0] in order to ensure 3 months'
>               worth of signalling is available)
> 132 periods: testnet 184-583 days (range 398.1 days)
> 225 periods: testnet 365-877 days (range 510.7 days)
> 390 periods: testnet 725-1403 days (range 677.1 days)
>
> [0] https://github.com/bitcoin/bips/pull/1081#pullrequestreview-621934640
>
> Cheers,
> aj
>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210406/1049635d/attachment.html>

From adam at cypherspace.org  Tue Apr  6 14:51:21 2021
From: adam at cypherspace.org (Adam Back)
Date: Tue, 6 Apr 2021 14:51:21 +0000
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <20210405103452.GA15866@erisian.com.au>
 <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>
Message-ID: <CALqxMTE5ovk8dCQAGqqdGL3dnW2kWwQ+2hjAExe5SqVc7BtTHA@mail.gmail.com>

As I understand Andrew Chow has a patchset for height based activation
of Speedy Trial, so that it would be great if people could review that
to help increase the review-cycles.

Personally I also somewhat prefer block-height based activation, and
for myself it seems like a mild step backwards to go back to MTP, when
as far as I understand most consider height-based to be a better
defined and cleaner, more predictable solution.

Adam

On Tue, 6 Apr 2021 at 15:35, Russell O'Connor via bitcoin-dev
<bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> I'm pretty sure that the question of "is signalling still possible by the time enough miners have upgraded and are ready to start signalling?" Strongly benefits from a guaranteed number of signaling periods that height based activation offers.  Especially for the short activation period of Speedy Trial.
>
> The other relevant value of giving enough time for users to upgrade is not very sensitive.  It's not like 180 days is magic number that going over is safe and going below is unsafe.
>
> That said, as Jeremy has pointed out before (maybe it was on IRC), we can almost ensure a minimum of 7 retargeting periods by carefully selecting signaling start and end dates to line up in the middle of expected retargeting periods that we would otherwise chose with height based activation. Why we would rather use MTP to fake a height based activation, I will never understand. But if this is what it takes to activate taproot, that is fine by me.
>
> The differences between height and MTP activation are too small to matter that much for what is ultimately transient code.  As long as MTP activation can pass code review it is okay with me.
>
>
> On Mon., Apr. 5, 2021, 06:35 Anthony Towns via bitcoin-dev, <bitcoin-dev at lists.linuxfoundation.org> wrote:
>>
>> On Sat, Apr 03, 2021 at 09:39:11PM -0700, Jeremy via bitcoin-dev wrote:
>> > As such, the main conversation in this agenda item is
>> > around the pros/cons of height or MTP and determining if we can reach consensus
>> > on either approach.
>>
>> Here's some numbers.
>>
>> Given a desired signalling period of xxx days, where signaling begins
>> on the first retarget boundary after the starttime and ends on the last
>> retarget boundary before the endtime, this is how many retarget periods
>> you get (based on blocks since 2015-01-01):
>>
>>  90 days: mainnet  5-7 full 2016-block retarget periods
>> 180 days: mainnet 11-14
>> 365 days: mainnet 25-27
>> 730 days: mainnet 51-55
>>
>> (This applies to non-signalling periods like the activation/lock in delay
>> too of course. If you change it so that it ends at the first retarget
>> period after endtime, all the values just get incremented -- ie, 6-8,
>> 12-15 etc)
>>
>> If I've got the maths right, then requiring 1814 of 2016 blocks to signal,
>> means that having 7 periods instead of 5 lets you get a 50% chance of
>> successful activation by maintaining 89.04% of hashpower over the entire
>> period instead of 89.17%, while 55 periods instead of 51 gives you a 50%
>> chance of success with 88.38% hashpower instead of 88.40% hashpower.
>> So the "repeated trials" part doesn't look like it has any significant
>> effect on mainnet.
>>
>> If you target yy periods instead of xxx days, starting and ending on a
>> retarget boundary, you get the following stats from the last few years
>> of mainnet (again starting at 2015-01-01):
>>
>>  1 period:  mainnet 11-17 days (range 5.2 days)
>>  7 periods: mainnet 87-103 days (range 15.4 days)
>> 13 periods: mainnet 166-185 days (range 17.9 days)
>> 27 periods: mainnet 352-377 days (range 24.4 days)
>> 54 periods: mainnet 711-747 days (range 35.0 days)
>>
>> As far as I can see the questions that matter are:
>>
>>  * is signalling still possible by the time enough miners have upgraded
>>    and are ready to start signalling?
>>
>>  * have nodes upgraded to enforce the new rules by the time activation
>>    occurs, if it occurs?
>>
>> But both those benefit from less real time variance, rather than less
>> variance in the numbers of signalling periods, at least in every way
>> that I can think of.
>>
>> Corresponding numbers for testnet:
>>
>>  90 days: testnet   5-85
>> 180 days: testnet  23-131
>> 365 days: testnet  70-224
>> 730 days: testnet 176-390
>>
>> (A 50% chance of activating within 5 periods requires sustaining 89.18%
>> hashpower; within 85 periods, 88.26% hashpower; far smaller differences
>> with all the other ranges -- of course, presumably the only way the
>> higher block rates ever actually happen is by someone pointing an ASIC at
>> testnet, and thus controlling 100% of blocks for multiple periods anyway)
>>
>>   1 period:  testnet 5.6minutes-26 days (range 26.5 days)
>>  13 periods: testnet 1-135 days (range 133.5 days)
>>  27 periods: testnet 13-192 days (range 178.3 days)
>>  54 periods: testnet 39-283 days (range 243.1 days)
>> 100 periods: testnet 114-476 days (range 360.9 days)
>>              (this is the value used in [0] in order to ensure 3 months'
>>               worth of signalling is available)
>> 132 periods: testnet 184-583 days (range 398.1 days)
>> 225 periods: testnet 365-877 days (range 510.7 days)
>> 390 periods: testnet 725-1403 days (range 677.1 days)
>>
>> [0] https://github.com/bitcoin/bips/pull/1081#pullrequestreview-621934640
>>
>> Cheers,
>> aj
>>
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

From dave at dtrt.org  Tue Apr  6 16:22:16 2021
From: dave at dtrt.org (David A. Harding)
Date: Tue, 6 Apr 2021 06:22:16 -1000
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <20210405103452.GA15866@erisian.com.au>
 <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>
Message-ID: <20210406162216.k34aplxwznh5z25v@ganymede>

On Tue, Apr 06, 2021 at 10:34:57AM -0400, Russell O'Connor via bitcoin-dev wrote:
> The other relevant value of giving enough time for users to upgrade is not
> very sensitive.  It's not like 180 days is magic number that going over is
> safe and going below is unsafe.

I don't think it's the 180 days value that's important but the deadline
to upgrade before taproot activates.  With heights, some people will be
conservative and say:

  You need to upgrade by $( date -d "66 days" )

Some people will just assume 10 minutes and say:

  You need to upgrade by $( date -d "$((10 * 2016 * 13)) minutes" )

Some people might assume 9 minutes, which I think is roughly our
historic average:

  You need to upgrade by $( date -d "$((9 * 2016 * 13)) minutes" )

As a few weeks pass and the number of blocks left until activation
decreases, it's likely everyone will be saying slightly different dates.
Basically, it'll be like a few months before the recent halving where
you could go to different sites that would give you wildly different
estimates---several of them claiming to be better than the others
because they factored in ____.

We're stuck with that for halvings, but I think coordinating human
actions around heights creates unnecessary confusion.

Using Towns's updated MTP doesn't eliminate this problem, but it reduces
it significantly, especially early in the process.  Now conservative
estimators can say:

  You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + 11 days" )

Ten minute estimators can say:

  You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + $((10 * 2016)) minutes" )

And nine minute estimators can say:

  You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + $((9 * 2016)) minutes" )

Those predictions are unlikely to change until shortly before the
lockin period.

I think those dates being much closer together (within 3 days) and
static for several months makes it much easier to communicate to users
(including organizations) the date by which they should upgrade if they
want to help enforce the soft fork's new rules.

As a side advantage, it also makes it easier to plan activation parties,
which is something I think we'll especially want after we finally start
doing something useful with the bikeshed we repainted so many times.  :-)

-Dave
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210406/e48fbe57/attachment.sig>

From roconnor at blockstream.com  Tue Apr  6 16:27:34 2021
From: roconnor at blockstream.com (Russell O'Connor)
Date: Tue, 6 Apr 2021 12:27:34 -0400
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <20210406162216.k34aplxwznh5z25v@ganymede>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <20210405103452.GA15866@erisian.com.au>
 <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>
 <20210406162216.k34aplxwznh5z25v@ganymede>
Message-ID: <CAMZUoKkxMudxUsOqA3varpjiqeVv+e-QD6RB8JzEfhjSMLJqeg@mail.gmail.com>

On Tue, Apr 6, 2021 at 12:23 PM David A. Harding <dave at dtrt.org> wrote:

>
>   You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + 11 days" )
>
> Ten minute estimators can say:
>
>   You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + $((10 * 2016))
> minutes" )
>
> And nine minute estimators can say:
>
>   You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + $((9 * 2016))
> minutes" )
>

It isn't  "$MIN_LOCKIN_TIME + $((10 * 2016)) minutes". It's
"$MIN_LOCKIN_TIME + time until next retargeting period + $((10 * 2016))
minutes".
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210406/bdadc623/attachment.html>

From roconnor at blockstream.com  Tue Apr  6 17:17:58 2021
From: roconnor at blockstream.com (Russell O'Connor)
Date: Tue, 6 Apr 2021 13:17:58 -0400
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <CAMZUoKkxMudxUsOqA3varpjiqeVv+e-QD6RB8JzEfhjSMLJqeg@mail.gmail.com>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <20210405103452.GA15866@erisian.com.au>
 <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>
 <20210406162216.k34aplxwznh5z25v@ganymede>
 <CAMZUoKkxMudxUsOqA3varpjiqeVv+e-QD6RB8JzEfhjSMLJqeg@mail.gmail.com>
Message-ID: <CAMZUoKnjjhYbYABL+iw5VivQfKTn64vV0ereOtz5VFEb6g0xvw@mail.gmail.com>

On Tue, Apr 6, 2021 at 12:27 PM Russell O'Connor <roconnor at blockstream.com>
wrote:

> On Tue, Apr 6, 2021 at 12:23 PM David A. Harding <dave at dtrt.org> wrote:
>
>>
>>   You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + 11 days" )
>>
>> Ten minute estimators can say:
>>
>>   You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + $((10 * 2016))
>> minutes" )
>>
>> And nine minute estimators can say:
>>
>>   You need to upgrade by $( date -d "$MIN_LOCKIN_TIME + $((9 * 2016))
>> minutes" )
>>
>
> It isn't  "$MIN_LOCKIN_TIME + $((10 * 2016)) minutes". It's
> "$MIN_LOCKIN_TIME + time until next retargeting period + $((10 * 2016))
> minutes".
>

Not only that, but the "time_until_next_retargeting_period" is a variable
whose distribution could straddle between 0 days and 14 days should the
MIN_LOCKIN_TIME end up close to a retargeting boundary.  MTP risks having a
persistent two week error in estimating the activation time (which is the
time that nodes need to strive to be upgraded) which may not be resolved
until only two weeks prior to activation!  If MIN_LOCKIN_TIME ends up close
to a retargeting boundary, then the MTP estimate becomes bimodal and
provides much worse estimates than provided by height based activation,
just as we are approaching the important 4 weeks (or is it 2 weeks?) prior
to activation!

Compare this with height based activation which simply becomes more and
more accurate in its estimation consistently (until, at less than two weeks
prior to activation, the height based estimate and the corresponding MTP
estimate have identical distributions because they both become height based
at that point in time.) This works out nicely because of the overall
simpler and easier to reason about design of height based activation.

The short of it is that MTP LOCKIN only really guarantees a minimum 2 week
notice prior to activation, which is largely the purpose of that LOCKIN
period.  Whereas height based activation gives an estimate whose
distribution smoothly and continuously becomes more and more accurate as
activation approaches, with no abrupt changes in estimates.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210406/f713f795/attachment.html>

From aj at erisian.com.au  Tue Apr  6 19:48:19 2021
From: aj at erisian.com.au (Anthony Towns)
Date: Wed, 7 Apr 2021 05:48:19 +1000
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <CAMZUoKnjjhYbYABL+iw5VivQfKTn64vV0ereOtz5VFEb6g0xvw@mail.gmail.com>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <20210405103452.GA15866@erisian.com.au>
 <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>
 <20210406162216.k34aplxwznh5z25v@ganymede>
 <CAMZUoKkxMudxUsOqA3varpjiqeVv+e-QD6RB8JzEfhjSMLJqeg@mail.gmail.com>
 <CAMZUoKnjjhYbYABL+iw5VivQfKTn64vV0ereOtz5VFEb6g0xvw@mail.gmail.com>
Message-ID: <20210406194819.GA29761@erisian.com.au>

On Tue, Apr 06, 2021 at 01:17:58PM -0400, Russell O'Connor via bitcoin-dev wrote:
> Not only that, but the "time_until_next_retargeting_period" is a variable whose
> distribution could straddle between 0 days and 14 days should the
> MIN_LOCKIN_TIME end up close to a retargeting boundary.

As noted in [0] the observed time frame of a single retarget period
over the last few years on mainnet is 11-17 days, so if LOCKED_IN is
determined by a min lock in time, then activation should be expected to
occur between 11 days (if the min lock in time is reached just prior to
a retarget boundary and the next period is short) and 34 days (if the
min lock in the is reached just after the retarget boundary and both
that period and the following one are long).

[0] https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-April/018728.html 

> MTP risks having a
> persistent two week error in estimating the activation time (which is the time
> that nodes need to strive to be upgraded)

That's a range of 16 days, consistenly after the time that's specified
and which cannot be brought forward even if miners were to attempt to
a timewarp attack. 

That compares to the height based approach, which gives a similar error
for the 7 period / 3 month target, and larger errors for anything longer,
and which can be both earlier or later in attack scenarios. The errors
are worse if you consider times prior to the 2015 cut-off I used, but
hopefully that's because of the switch to ASICs and won't be repeated?

> which may not be resolved until only
> two weeks prior to activation!? If MIN_LOCKIN_TIME ends up close to a
> retargeting boundary, then the MTP estimate becomes bimodal and provides much
> worse estimates than provided by height based activation, just as we are
> approaching the important 4 weeks (or is it 2 weeks?) prior to activation!

That doesn't seem like a particularly important design goal to me? Having
a last minute two week delay seems easy to deal with, while having to
make estimates of how many blocks we might have in an X month period
X+K months in advance is not. If it were important, I expect we could
change the state machine to reflect that goal and make the limit tighter
(in non-attack scenarios).

> The short of it is that MTP LOCKIN only really guarantees a minimum 2 week
> notice prior to activation,

If the timeout is at X and MTP min lockin is at X+Y then you guarantee
a notice period of at least Y + (1 retarget period).

Cheers,
aj


From jlrubin at mit.edu  Tue Apr  6 21:31:31 2021
From: jlrubin at mit.edu (Jeremy)
Date: Tue, 6 Apr 2021 14:31:31 -0700
Subject: [bitcoin-dev] Taproot Activation Meeting Notes,
	April 6th: The CoinFlip
Message-ID: <CAD5xwhiofHqRkzgDKAW5yqecju0PLj9AUUn1FngwFVmLM5Jzfg@mail.gmail.com>

Bitcoin Developers,

The second fortnightly taproot activation meeting has just concluded. Below
are my notes:

1) On AJ's mods to MTP
   - luke-jr is still NACK any MTP related thing
   - It is generally uncontested that the Mods are fine; that it should be
LOT (via LAST_CHANCE) compatible
   - it does make MTP a bit harder to review, but not unacceptably so
2) On selecting between MTP and Height
   - There are some benefits to MTPs
   - There are some benefits to Heights
   - Both are technically probably OK to use for Taproot
   - Both about as hard/easy to review (some think height has fewer edge
conditions)
   - AJ and Andrew Chow are going to see if they can unify approaches
3) Timeline + CoinFlip
   - Many present at the meeting preferred to work together to compromise
and reach consensus to stick to the timeline from the last meeting over
either height or MTP.
   - as such a coinflip is being run via `bitcoin-cli getblockhash
$((678059+20)) | cut -b64 | grep -q '[02468ace]' && echo MTP || echo
height` (that's about 13 blocks from writing).
   - If it comes up MTP, contributors mentioned below will work towards
moving MTP forwards.
   - If it comes up height, contributors mentioned below will work towards
moving height forwards.
   - You can pre-commit to following this path by responding in the next
hour or so, or also choose to abide by it async
   - If in the next day or so, AJ and Andrew Chow reach a compromise
between approaches that is compatible with the timeline of getting to a RC1
with deployment, then that can be considered on its merits in preference of
either of the existing approaches.
    - If this approach fails at helping move towards consensus on an
approach, then we will have to push back the timeline most likely for a
core release (or an emergent group will have to offer a community release)

The following folks in the meeting agreed to abide by the flip:

- roasbeef
- benthecarman
- harding
- jonatack
- rgrant
- copumpkin (in DM)
- Emcy
- jeremyrubin

There were also several folks, anonymously, who said essentially that they
don't want to commit to a flip but if it works it works and they'd roll
with it.

As noted, if you want to +1 on to coinflip before it settles, feel free to
do in response here or IRC. It's also fine to just abide by it after the
fact as well.

------------------

Personal comment on coin flip: A coinflip seems like an odd choice for a
technical decision. But let me excerpt some quotes from the meeting.

[4/6/21 12:26] <jeremyrubin> We are super lucky that both achow101 and aj
are such competent developers that we have not one but two fantastic PRs to
look at
[4/6/21 12:26] <jeremyrubin> At the same time, we have two PRs to look at
[4/6/21 12:28] <jeremyrubin> In this section I'd like to remind people to
check dug-in opinions at the door, what matters here is if we can agree on
a plan of action and get the bulk of everyone on the same page. That said,
there are nuanced technical points to examine that favour either approach
[4/6/21 12:28] <jeremyrubin> I think the differences between MTP and height
are less important than working towards a single PR to review

[4/6/21 13:09] <harding> I think both MTP and heights are fine for mainnet,
so one of them having an advantage for test networks seems worth
considering.

[4/6/21 13:09] <rgrant> This topic seems to be winding down.  I'm hearing:
that signet configuration isn't a dealbreaker but there is technical debt
incurred if we ignore it; MTP-based activation (read: celebration parties)
can be known weeks in advance if parameters are chosen well; and that code
reviews matter.  Coinflip seems to be winning.

[4/6/21 13:45] <jeremyrubin> people selecting coinflip because they think
the interest in timeline outweighs any individual perceived technical
benefit
[4/6/21 13:45] <jeremyrubin> it's not a don't care, it's a recognition
there are two decent proposals with different tradeoffs
[4/6/21 13:45] <jeremyrubin> and a desire to break stalemate on it mutually
and voluntarily

[4/6/21 13:49] <copumpkin> IMO coinflip is more of an acknowledgment that
the two CRs differ largely in shed color and that we all want the shed, and
don't care as much about its color
[4/6/21 13:49] <BlueMatt> what copumpkin said
[4/6/21 13:50] <copumpkin> (not to minimize the differences between them,
but gotta keep the big picture in mind and not die on hills that don't need
dead people on them)

We have two good options, and coinflip is people agreeing to put aside
minute preferences on two acceptable options for the big picture. As such,
I think that a coinflip is appropriately used in this circumstance,
although I recognize the sentiment that some may feel it's treating
development a little too *flippantly*.

Rough consensus and running code.

Best,

Jeremy

--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210406/2fc04b53/attachment-0001.html>

From dave at dtrt.org  Tue Apr  6 21:31:23 2021
From: dave at dtrt.org (David A. Harding)
Date: Tue, 6 Apr 2021 11:31:23 -1000
Subject: [bitcoin-dev] Taproot Activation Meeting Reminder: April 6th
 19:00 UTC bitcoin/bitcoin-dev
In-Reply-To: <20210406194819.GA29761@erisian.com.au>
References: <CAD5xwhgTKLhA82=PsF9EXrhvmx6zcA=ffOvHD4qt4q1sAqzhng@mail.gmail.com>
 <20210405103452.GA15866@erisian.com.au>
 <CAMZUoKk39YNFVgGQ2krFSx4GNHN0rO_M2j91ETMGSO01SHYEcw@mail.gmail.com>
 <20210406162216.k34aplxwznh5z25v@ganymede>
 <CAMZUoKkxMudxUsOqA3varpjiqeVv+e-QD6RB8JzEfhjSMLJqeg@mail.gmail.com>
 <CAMZUoKnjjhYbYABL+iw5VivQfKTn64vV0ereOtz5VFEb6g0xvw@mail.gmail.com>
 <20210406194819.GA29761@erisian.com.au>
Message-ID: <20210406213123.l3b2zqecxxc4h2ls@ganymede>

(Replies to multiple emails)

On Tue, Apr 06, 2021 at 12:27:34PM -0400, Russell O'Connor wrote:
> It isn't  "$MIN_LOCKIN_TIME + $((10 * 2016)) minutes". It's
> "$MIN_LOCKIN_TIME + time until next retargeting period + $((10 * 2016))
> minutes".

Ah, drat, I forgot about that.  Thank you for correcting my oversight!

> That doesn't seem like a particularly important design goal to me? Having
> a last minute two week delay seems easy to deal with

From my perspective, that of a person focused on communicating
information that affects Bitcoin users and recommending infrastructure
adjustments that should be made to accomodate those changes, I'd find
having a predictable activation date to be of significant benefit.
Given that, an activation scheme that could provide a tight timeline
(only delayable, not accellerable, by miner shenanegeans) would be
something I'd consider an advantage of that method.

That said, it's probably not worth making the activation state machine
more complicated for when the simplicity of the machine for height-based
activations is it's chief touted benefit.

Thanks,

-Dave
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210406/6f9d5311/attachment.sig>

From rusty at rustcorp.com.au  Tue Apr  6 04:40:55 2021
From: rusty at rustcorp.com.au (Rusty Russell)
Date: Tue, 06 Apr 2021 14:10:55 +0930
Subject: [bitcoin-dev] Response to Rusty Russell from Github
In-Reply-To: <CAD5xwhh=E00DVxqhZc7gDTBXtA-_HgybEaP_ysnA4n6AAVbWsA@mail.gmail.com>
References: <CAD5xwhh=E00DVxqhZc7gDTBXtA-_HgybEaP_ysnA4n6AAVbWsA@mail.gmail.com>
Message-ID: <87o8esja94.fsf@rustcorp.com.au>

Jeremy via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> writes:
> Where I disagree is that I do not believe that BIP8 with LOT configuration
> is the improved long term option we should ossify around either. I
> understand the triumvirate model you desire to achieve, but BIP8 with an
> individually set LOT configuration does not formalize how economic nodes
> send a network legible signal ahead of a chain split. A regular flag day,
> with no signalling, but communally released and communicated openly most
> likely better achieves the goal of providing users choice.

You're ignoring the role of infrastructure.  It's similar to saying that
there is no need for elections: if things are bad enough, citizens can
rise up and overthrow their government.

> 1. Developers release, but do not activate
> 2. Miners signal
> 3. Users may override by compiling and releasing a patched Bitcoin with
> moderate changes that activates Taproot at a later date. While this might
> *seem* more complicated a procedure than configurable LOT, here are four
> reasons why it may be simpler (and safer) to just do a fresh release:

Users may indeed, fire the devs and replace them, as this implies.  This
is not empowering users, but in effect risks reducing their role to "beg
the devs or beg the miners".

> A. No time-based consensus sensitivity on when LOT must be set (e.g., what
> happens if mid final signal period users decide to set LOT? Do all users
> set it at the same time? Or different times and end up causing nodes to ban
> each other for various reasons?)

Yes, this Schelling point is important.  If you read BIP-8, you will see
that LOT=true activates at the last moment for this very reason.

> B. No "missed window" if users don't coordinate on setting LOT before the
> final period -- release whenever ready.

Of course there is: they need to upgrade in time.

> C. ST fails fast, permitting users ample time to prepare an alternative
> release

You'd think so, but given the confusion surrounding Segwit, it seems a
year was barely time to debate, decide and coordinate.  You want this
ready to go at the *beginning* of the 1 year process, not being decided,
debated, build and deployed once the crisis is upon us.  That existing
deployment is a vital stake in the calculus of those who might try to
disrupt the process for any reason.

> D. If miners continue to mine without signalling, and users abandon a
> LOT=true setting, their node will have already marked those blocks invalid
> and they will need to figure out how to re-validate the block.

This is true, in fact, of any soft fork: a Luke points out, our lack of
revalidation of blocks after upgrade is a bug.  Which should be fixed:
IMHO a decent PR to make LOT runtime configurable would reevaluate any
blocks >= timeoutheight-2016 when it is altered.

> RE: point 3, is it as easy as it *could* be? No, but I don't have any
> genius ideas on how to make it easier either. (Note that I've previously
> argued for adding configurable LOT=true on the basis that a user-run script
> could emulate LOT without any software change as a harm reduction, but I
> did not advocate that particular technique be formalized as a part of the
> activation process)

BIP-8 (with the recent modifications to allow maximal number of
non-signalling blocks) is technically as fork-preventative as we can
seek to make it.

I am hopeful that our ecosystem will remain harmonious and we won't have
to use it.  But I am significantly more hopeful that we won't have to
use it if we have it deployed and ready.

Cheers,
Rusty.

From rusty at rustcorp.com.au  Tue Apr  6 04:25:21 2021
From: rusty at rustcorp.com.au (Rusty Russell)
Date: Tue, 06 Apr 2021 13:55:21 +0930
Subject: [bitcoin-dev] March 23rd 2021 Taproot Activation Meeting Notes
In-Reply-To: <CAD5xwhiXE=yJFi+9aZQqMOCaiUrJ_UEvcESR3E0j2SA1RnbqmA@mail.gmail.com>
References: <CAD5xwhiXE=yJFi+9aZQqMOCaiUrJ_UEvcESR3E0j2SA1RnbqmA@mail.gmail.com>
Message-ID: <874kgkkpji.fsf@rustcorp.com.au>

Jeremy via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> writes:
> We had a very productive meeting today. Here is a summary of the meeting --
> I've done my best to
> summarize in an unbiased way. Thank you to everyone who attended.
>
> 1. On the use of a speedy trial variant:
>
> - There are no new objections to speedy trial generally.
> - There is desire to know if Rusty retracts or reaffirms his NACK in light
> of the responses.

I do not withdraw my NACK (and kudos: there have been few attempts to
pressure me to do so!).

The core question always was: what do we do if miners fail to activate?

Luke-Jr takes the approach that "we (i.e developers) ensure it activates
anyway".  I take the approach that "the users must make a direct
intervention".  Speedy Trial takes the approach that "let's pretend we
didn't *actually* ask them".

It's totally a political approach, to avoid facing the awkward question.
Since I believe that such prevaricating makes a future crisis less
predictable, I am forced to conclude that it makes bitcoin less robust.

Personally, I think the compromise position is using LOT=false and
having those such as Luke and myself continue working on a LOT=true
branch for future consideration.  It's less than optimal, but I
appreciate that people want Taproot activated more than they want
the groundwork future upgrades.

I hope that helps,
Rusty.

From jlrubin at mit.edu  Wed Apr  7 00:02:35 2021
From: jlrubin at mit.edu (Jeremy)
Date: Tue, 6 Apr 2021 17:02:35 -0700
Subject: [bitcoin-dev] Taproot Activation Meeting Notes,
	April 6th: The CoinFlip
In-Reply-To: <CAD5xwhiofHqRkzgDKAW5yqecju0PLj9AUUn1FngwFVmLM5Jzfg@mail.gmail.com>
References: <CAD5xwhiofHqRkzgDKAW5yqecju0PLj9AUUn1FngwFVmLM5Jzfg@mail.gmail.com>
Message-ID: <CAD5xwhidWVKBDFAwiJfFh+vQj6maG6Rq3_oaSTJ9JW=OXvodzA@mail.gmail.com>

Update: the coin has flipped in favor of MTP

https://blockstream.info/block/00000000000000000000a6bcbf09849fe895b5d18ed884e8d558a57fc4f5e95c


Further, there seems to be some agreement between Andrew and AJ w.r.t.
reverting one of the changes AJ made recently (
https://github.com/bitcoin/bitcoin/pull/21377#issuecomment-814494847),
resolving some of the contention between them for a MTP-based ST.

As such, I'm personally confident that if you want to spend your time
reviewing #21377, it has a very decent chance of accumulating sufficient
review and support from the community to be considered for a release in
accordance to the schedule from the last meeting. The changes in line with
Andrew and AJ's compromise are yet to be implemented, but they do not seem
to be complicated so you can probably expect AJ will implement and offer
them for review shortly (AJ if you're going on spring break let us know and
we can pick it up...).

Thanks to everyone and especially thanks to AJ and Andrew for all the hard
work they have put in preparing and evaluating these ideas. To outside
looking in, it might seem like there is contention between the two, but
they've been working together closely the whole time reviewing each other's
PRs and making tools and tests that make the whole thing safer anyways.
Let's all take a note from their book!

Best,

Jeremy

--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>


On Tue, Apr 6, 2021 at 2:31 PM Jeremy <jlrubin at mit.edu> wrote:

> Bitcoin Developers,
>
> The second fortnightly taproot activation meeting has just concluded.
> Below are my notes:
>
> 1) On AJ's mods to MTP
>    - luke-jr is still NACK any MTP related thing
>    - It is generally uncontested that the Mods are fine; that it should be
> LOT (via LAST_CHANCE) compatible
>    - it does make MTP a bit harder to review, but not unacceptably so
> 2) On selecting between MTP and Height
>    - There are some benefits to MTPs
>    - There are some benefits to Heights
>    - Both are technically probably OK to use for Taproot
>    - Both about as hard/easy to review (some think height has fewer edge
> conditions)
>    - AJ and Andrew Chow are going to see if they can unify approaches
> 3) Timeline + CoinFlip
>    - Many present at the meeting preferred to work together to compromise
> and reach consensus to stick to the timeline from the last meeting over
> either height or MTP.
>    - as such a coinflip is being run via `bitcoin-cli getblockhash
> $((678059+20)) | cut -b64 | grep -q '[02468ace]' && echo MTP || echo
> height` (that's about 13 blocks from writing).
>    - If it comes up MTP, contributors mentioned below will work towards
> moving MTP forwards.
>    - If it comes up height, contributors mentioned below will work towards
> moving height forwards.
>    - You can pre-commit to following this path by responding in the next
> hour or so, or also choose to abide by it async
>    - If in the next day or so, AJ and Andrew Chow reach a compromise
> between approaches that is compatible with the timeline of getting to a RC1
> with deployment, then that can be considered on its merits in preference of
> either of the existing approaches.
>     - If this approach fails at helping move towards consensus on an
> approach, then we will have to push back the timeline most likely for a
> core release (or an emergent group will have to offer a community release)
>
> The following folks in the meeting agreed to abide by the flip:
>
> - roasbeef
> - benthecarman
> - harding
> - jonatack
> - rgrant
> - copumpkin (in DM)
> - Emcy
> - jeremyrubin
>
> There were also several folks, anonymously, who said essentially that they
> don't want to commit to a flip but if it works it works and they'd roll
> with it.
>
> As noted, if you want to +1 on to coinflip before it settles, feel free to
> do in response here or IRC. It's also fine to just abide by it after the
> fact as well.
>
> ------------------
>
> Personal comment on coin flip: A coinflip seems like an odd choice for a
> technical decision. But let me excerpt some quotes from the meeting.
>
> [4/6/21 12:26] <jeremyrubin> We are super lucky that both achow101 and aj
> are such competent developers that we have not one but two fantastic PRs to
> look at
> [4/6/21 12:26] <jeremyrubin> At the same time, we have two PRs to look at
> [4/6/21 12:28] <jeremyrubin> In this section I'd like to remind people to
> check dug-in opinions at the door, what matters here is if we can agree on
> a plan of action and get the bulk of everyone on the same page. That said,
> there are nuanced technical points to examine that favour either approach
> [4/6/21 12:28] <jeremyrubin> I think the differences between MTP and
> height are less important than working towards a single PR to review
>
> [4/6/21 13:09] <harding> I think both MTP and heights are fine for
> mainnet, so one of them having an advantage for test networks seems worth
> considering.
>
> [4/6/21 13:09] <rgrant> This topic seems to be winding down.  I'm hearing:
> that signet configuration isn't a dealbreaker but there is technical debt
> incurred if we ignore it; MTP-based activation (read: celebration parties)
> can be known weeks in advance if parameters are chosen well; and that code
> reviews matter.  Coinflip seems to be winning.
>
> [4/6/21 13:45] <jeremyrubin> people selecting coinflip because they think
> the interest in timeline outweighs any individual perceived technical
> benefit
> [4/6/21 13:45] <jeremyrubin> it's not a don't care, it's a recognition
> there are two decent proposals with different tradeoffs
> [4/6/21 13:45] <jeremyrubin> and a desire to break stalemate on it
> mutually and voluntarily
>
> [4/6/21 13:49] <copumpkin> IMO coinflip is more of an acknowledgment that
> the two CRs differ largely in shed color and that we all want the shed, and
> don't care as much about its color
> [4/6/21 13:49] <BlueMatt> what copumpkin said
> [4/6/21 13:50] <copumpkin> (not to minimize the differences between them,
> but gotta keep the big picture in mind and not die on hills that don't need
> dead people on them)
>
> We have two good options, and coinflip is people agreeing to put aside
> minute preferences on two acceptable options for the big picture. As such,
> I think that a coinflip is appropriately used in this circumstance,
> although I recognize the sentiment that some may feel it's treating
> development a little too *flippantly*.
>
> Rough consensus and running code.
>
> Best,
>
> Jeremy
>
> --
> @JeremyRubin <https://twitter.com/JeremyRubin>
> <https://twitter.com/JeremyRubin>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210406/b0126d20/attachment-0001.html>

From lf-lists at mattcorallo.com  Wed Apr  7 00:46:16 2021
From: lf-lists at mattcorallo.com (Matt Corallo)
Date: Tue, 6 Apr 2021 20:46:16 -0400
Subject: [bitcoin-dev] Response to Rusty Russell from Github
In-Reply-To: <87o8esja94.fsf@rustcorp.com.au>
References: <CAD5xwhh=E00DVxqhZc7gDTBXtA-_HgybEaP_ysnA4n6AAVbWsA@mail.gmail.com>
 <87o8esja94.fsf@rustcorp.com.au>
Message-ID: <a496407f-f58c-8099-355b-e32e4e97c6cb@mattcorallo.com>

I'm somewhat gobsmacked that this entire conversation hasn't included the word "market" in it at all. If there's one 
thing we can all agree we learned from Segwit2x, BCH, BSV, BU, etc, its that, ultimately, the market decides. Not only 
does the market decide, but there's lots of money to be made by being the market maker or operator letting the market 
make its voice heard. There is nothing we can, or should, do to ensure the market can make its voice heard - it always will.

We don't need to bend over backwards to make sure individual users are forced to try to form consensus among themselves 
via options or chain splits, we can just let the market decide. Within reason, the market will probably decide "yep, 
what the brains are doing looks good, Bitcoin needs to stay in consensus, no point in trying to nitpick something or 
we'll never come to consensus about anything". If what's being proposed is ever disagreed with by some small-ish but 
nontrivial group, futures markets are going to decide the fate of the system no matter what the consensus rules or 
activation method is, why do we need to do very much else?

Matt

On 4/6/21 00:40, Rusty Russell via bitcoin-dev wrote:
> Jeremy via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> writes:
>> Where I disagree is that I do not believe that BIP8 with LOT configuration
>> is the improved long term option we should ossify around either. I
>> understand the triumvirate model you desire to achieve, but BIP8 with an
>> individually set LOT configuration does not formalize how economic nodes
>> send a network legible signal ahead of a chain split. A regular flag day,
>> with no signalling, but communally released and communicated openly most
>> likely better achieves the goal of providing users choice.
> 
> You're ignoring the role of infrastructure.  It's similar to saying that
> there is no need for elections: if things are bad enough, citizens can
> rise up and overthrow their government.
> 
>> 1. Developers release, but do not activate
>> 2. Miners signal
>> 3. Users may override by compiling and releasing a patched Bitcoin with
>> moderate changes that activates Taproot at a later date. While this might
>> *seem* more complicated a procedure than configurable LOT, here are four
>> reasons why it may be simpler (and safer) to just do a fresh release:
> 
> Users may indeed, fire the devs and replace them, as this implies.  This
> is not empowering users, but in effect risks reducing their role to "beg
> the devs or beg the miners".
> 
>> A. No time-based consensus sensitivity on when LOT must be set (e.g., what
>> happens if mid final signal period users decide to set LOT? Do all users
>> set it at the same time? Or different times and end up causing nodes to ban
>> each other for various reasons?)
> 
> Yes, this Schelling point is important.  If you read BIP-8, you will see
> that LOT=true activates at the last moment for this very reason.
> 
>> B. No "missed window" if users don't coordinate on setting LOT before the
>> final period -- release whenever ready.
> 
> Of course there is: they need to upgrade in time.
> 
>> C. ST fails fast, permitting users ample time to prepare an alternative
>> release
> 
> You'd think so, but given the confusion surrounding Segwit, it seems a
> year was barely time to debate, decide and coordinate.  You want this
> ready to go at the *beginning* of the 1 year process, not being decided,
> debated, build and deployed once the crisis is upon us.  That existing
> deployment is a vital stake in the calculus of those who might try to
> disrupt the process for any reason.
> 
>> D. If miners continue to mine without signalling, and users abandon a
>> LOT=true setting, their node will have already marked those blocks invalid
>> and they will need to figure out how to re-validate the block.
> 
> This is true, in fact, of any soft fork: a Luke points out, our lack of
> revalidation of blocks after upgrade is a bug.  Which should be fixed:
> IMHO a decent PR to make LOT runtime configurable would reevaluate any
> blocks >= timeoutheight-2016 when it is altered.
> 
>> RE: point 3, is it as easy as it *could* be? No, but I don't have any
>> genius ideas on how to make it easier either. (Note that I've previously
>> argued for adding configurable LOT=true on the basis that a user-run script
>> could emulate LOT without any software change as a harm reduction, but I
>> did not advocate that particular technique be formalized as a part of the
>> activation process)
> 
> BIP-8 (with the recent modifications to allow maximal number of
> non-signalling blocks) is technically as fork-preventative as we can
> seek to make it.
> 
> I am hopeful that our ecosystem will remain harmonious and we won't have
> to use it.  But I am significantly more hopeful that we won't have to
> use it if we have it deployed and ready.
> 
> Cheers,
> Rusty.
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> 

From bitcoin-dev at rgrant.org  Wed Apr  7 01:20:15 2021
From: bitcoin-dev at rgrant.org (Ryan Grant)
Date: Wed, 7 Apr 2021 01:20:15 +0000
Subject: [bitcoin-dev] March 23rd 2021 Taproot Activation Meeting Notes
In-Reply-To: <874kgkkpji.fsf@rustcorp.com.au>
References: <CAD5xwhiXE=yJFi+9aZQqMOCaiUrJ_UEvcESR3E0j2SA1RnbqmA@mail.gmail.com>
 <874kgkkpji.fsf@rustcorp.com.au>
Message-ID: <CAMnpzfopMNO=73wqvXpOn9u8X4MwJArqGxODJAS4-9iFiZOd6A@mail.gmail.com>

On Tue, Apr 6, 2021 at 11:58 PM Rusty Russell via bitcoin-dev
<bitcoin-dev at lists.linuxfoundation.org> wrote:
> The core question always was: what do we do if miners fail to activate?
>
> [...]  Speedy Trial takes the approach that "let's pretend we didn't
> *actually* ask [miners]".

What ST is saying is that a strategy of avoiding unnecessary risk is
stronger than a strategy of brinkmanship when brinkmanship wasn't
our only option.  Having deescalation in the strategy toolkit makes
Bitcoin stronger.

> It's totally a political approach, to avoid facing the awkward question.
> Since I believe that such prevaricating makes a future crisis less
> predictable, I am forced to conclude that it makes bitcoin less robust.

LOT=true does face the awkward question, but there are downsides:

  - in the requirement to drop blocks from apathetic miners (although
    as Luke-Jr pointed out in a previous reply on this list they have
    no contract under which to raise a complaint); and

  - in the risk of a chain split, should gauging economic majority
    support - which there is zero intrinsic tooling for - go poorly.

> Personally, I think the compromise position is using LOT=false and
> having those such as Luke and myself continue working on a LOT=true
> branch for future consideration.  It's less than optimal, but I
> appreciate that people want Taproot activated more than they want
> the groundwork future upgrades.

Another way of viewing the current situation is that should
brinkmanship be necessary, then better tooling to resolve a situation
that requires brinkmanship will be invaluable.  But:

  - we do not need to normalize brinkmanship;

  - designing brinkmanship tooling well before the next crisis does
    not require selecting conveniently completed host features to
    strap the tooling onto for testing; and

  - it's already the case that a UASF branch can be prepared along
    with ST (ie. without requiring LOT=false), although the code is a
    bit more complex and the appropriate stopheight a few blocks later.

Although your NACK is well explained, for the reasons above I am
prepared to run code that overrides it.

From rusty at rustcorp.com.au  Wed Apr  7 05:01:13 2021
From: rusty at rustcorp.com.au (Rusty Russell)
Date: Wed, 07 Apr 2021 14:31:13 +0930
Subject: [bitcoin-dev] March 23rd 2021 Taproot Activation Meeting Notes
In-Reply-To: <CAMnpzfopMNO=73wqvXpOn9u8X4MwJArqGxODJAS4-9iFiZOd6A@mail.gmail.com>
References: <CAD5xwhiXE=yJFi+9aZQqMOCaiUrJ_UEvcESR3E0j2SA1RnbqmA@mail.gmail.com>
 <874kgkkpji.fsf@rustcorp.com.au>
 <CAMnpzfopMNO=73wqvXpOn9u8X4MwJArqGxODJAS4-9iFiZOd6A@mail.gmail.com>
Message-ID: <87pmz6it7q.fsf@rustcorp.com.au>

Ryan Grant <bitcoin-dev at rgrant.org> writes:
> On Tue, Apr 6, 2021 at 11:58 PM Rusty Russell via bitcoin-dev
> <bitcoin-dev at lists.linuxfoundation.org> wrote:
>> The core question always was: what do we do if miners fail to activate?
>>
>> [...]  Speedy Trial takes the approach that "let's pretend we didn't
>> *actually* ask [miners]".
>
> What ST is saying is that a strategy of avoiding unnecessary risk is
> stronger than a strategy of brinkmanship when brinkmanship wasn't
> our only option.  Having deescalation in the strategy toolkit makes
> Bitcoin stronger.

I don't believe that having a plan is brinkmanship or an escalation.

During the segwit debate, Pieter Wuille said that users should decide.
I've been thinking about that a lot, especially about what that means in
a practical sense where the normal developer / miner dynamic has failed.

>> It's totally a political approach, to avoid facing the awkward question.
>> Since I believe that such prevaricating makes a future crisis less
>> predictable, I am forced to conclude that it makes bitcoin less robust.
>
> LOT=true does face the awkward question, but there are downsides:
>
>   - in the requirement to drop blocks from apathetic miners (although
>     as Luke-Jr pointed out in a previous reply on this list they have
>     no contract under which to raise a complaint); and

Surely, yes.  If the users of bitcoin decide blocks are invalid, they're
invalid.  With a year's warning, and developer and user consensus
against them, I think we've reached the limits of acceptable miner
apathy.

>   - in the risk of a chain split, should gauging economic majority
>     support - which there is zero intrinsic tooling for - go poorly.

Agreed that we should definitely do better here: in practice people
would rely on third party explorers for information on the other side of
the split.  Tracking the cumulative work on invalid chains would be a
good idea for bitcoind in general (AJ suggested this, IIRC).

>> Personally, I think the compromise position is using LOT=false and
>> having those such as Luke and myself continue working on a LOT=true
>> branch for future consideration.  It's less than optimal, but I
>> appreciate that people want Taproot activated more than they want
>> the groundwork future upgrades.
>
> Another way of viewing the current situation is that should
> brinkmanship be necessary, then better tooling to resolve a situation
> that requires brinkmanship will be invaluable.  But:
>
>   - we do not need to normalize brinkmanship;
>
>   - designing brinkmanship tooling well before the next crisis does
>     not require selecting conveniently completed host features to
>     strap the tooling onto for testing; and

Again, openly creating a contingency plan is not brinkmanship, it's
normal.  I know that considering these scenarios is uncomfortable; I
avoid conflict myself!  But I feel obliged to face this as a real
possibility.

I think we should be normalizing the understanding that bitcoin users
are the ultimate decider.  By offering *all* of them the tools to do so
we show this isn't lip-service, but something that businesses and
everyone else in the ecosystem should consider.

>   - it's already the case that a UASF branch can be prepared along
>     with ST (ie. without requiring LOT=false), although the code is a
>     bit more complex and the appropriate stopheight a few blocks later.

I don't believe this is true, unless you UASF before ST expires?  ST is
explicitly designed *not* to give time to conclude that miners are
stalling (unless something has changed from the initial 3 month
proposal?).

> Although your NACK is well explained, for the reasons above I am
> prepared to run code that overrides it.

Good.  In the end, we're all at the whim of the economic majority.

Cheers!
Rusty.

From aubergemediale at gmail.com  Wed Apr  7 13:42:01 2021
From: aubergemediale at gmail.com (Claus Ehrenberg)
Date: Wed, 7 Apr 2021 15:42:01 +0200
Subject: [bitcoin-dev] March 23rd 2021 Taproot Activation Meeting Notes
In-Reply-To: <87pmz6it7q.fsf@rustcorp.com.au>
References: <CAD5xwhiXE=yJFi+9aZQqMOCaiUrJ_UEvcESR3E0j2SA1RnbqmA@mail.gmail.com>
 <874kgkkpji.fsf@rustcorp.com.au>
 <CAMnpzfopMNO=73wqvXpOn9u8X4MwJArqGxODJAS4-9iFiZOd6A@mail.gmail.com>
 <87pmz6it7q.fsf@rustcorp.com.au>
Message-ID: <CANPykMr_pyz7XxrXo2FfkNPmBwzMkmnL2SPw8-TmVhOtxkz=-A@mail.gmail.com>

As a user, I think it's very important for me to know if Taproot is
eventually coming or not. So why not make it so that if _either_ miners
_or_ users decide for Taproot, it will activate no matter what. Accepting a
chain split is imo the fairest way to 'resolve the conflict' (it can't be
resolved anyway).

That would probably mean running ST and and UASF concurrently.

The upside would be that we've got a safe date for Taproot, except neither
users nor miners want it.

Cheers,
Claus

On Wed, Apr 7, 2021 at 7:02 AM Rusty Russell via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Ryan Grant <bitcoin-dev at rgrant.org> writes:
> > On Tue, Apr 6, 2021 at 11:58 PM Rusty Russell via bitcoin-dev
> > <bitcoin-dev at lists.linuxfoundation.org> wrote:
> >> The core question always was: what do we do if miners fail to activate?
> >>
> >> [...]  Speedy Trial takes the approach that "let's pretend we didn't
> >> *actually* ask [miners]".
> >
> > What ST is saying is that a strategy of avoiding unnecessary risk is
> > stronger than a strategy of brinkmanship when brinkmanship wasn't
> > our only option.  Having deescalation in the strategy toolkit makes
> > Bitcoin stronger.
>
> I don't believe that having a plan is brinkmanship or an escalation.
>
> During the segwit debate, Pieter Wuille said that users should decide.
> I've been thinking about that a lot, especially about what that means in
> a practical sense where the normal developer / miner dynamic has failed.
>
> >> It's totally a political approach, to avoid facing the awkward question.
> >> Since I believe that such prevaricating makes a future crisis less
> >> predictable, I am forced to conclude that it makes bitcoin less robust.
> >
> > LOT=true does face the awkward question, but there are downsides:
> >
> >   - in the requirement to drop blocks from apathetic miners (although
> >     as Luke-Jr pointed out in a previous reply on this list they have
> >     no contract under which to raise a complaint); and
>
> Surely, yes.  If the users of bitcoin decide blocks are invalid, they're
> invalid.  With a year's warning, and developer and user consensus
> against them, I think we've reached the limits of acceptable miner
> apathy.
>
> >   - in the risk of a chain split, should gauging economic majority
> >     support - which there is zero intrinsic tooling for - go poorly.
>
> Agreed that we should definitely do better here: in practice people
> would rely on third party explorers for information on the other side of
> the split.  Tracking the cumulative work on invalid chains would be a
> good idea for bitcoind in general (AJ suggested this, IIRC).
>
> >> Personally, I think the compromise position is using LOT=false and
> >> having those such as Luke and myself continue working on a LOT=true
> >> branch for future consideration.  It's less than optimal, but I
> >> appreciate that people want Taproot activated more than they want
> >> the groundwork future upgrades.
> >
> > Another way of viewing the current situation is that should
> > brinkmanship be necessary, then better tooling to resolve a situation
> > that requires brinkmanship will be invaluable.  But:
> >
> >   - we do not need to normalize brinkmanship;
> >
> >   - designing brinkmanship tooling well before the next crisis does
> >     not require selecting conveniently completed host features to
> >     strap the tooling onto for testing; and
>
> Again, openly creating a contingency plan is not brinkmanship, it's
> normal.  I know that considering these scenarios is uncomfortable; I
> avoid conflict myself!  But I feel obliged to face this as a real
> possibility.
>
> I think we should be normalizing the understanding that bitcoin users
> are the ultimate decider.  By offering *all* of them the tools to do so
> we show this isn't lip-service, but something that businesses and
> everyone else in the ecosystem should consider.
>
> >   - it's already the case that a UASF branch can be prepared along
> >     with ST (ie. without requiring LOT=false), although the code is a
> >     bit more complex and the appropriate stopheight a few blocks later.
>
> I don't believe this is true, unless you UASF before ST expires?  ST is
> explicitly designed *not* to give time to conclude that miners are
> stalling (unless something has changed from the initial 3 month
> proposal?).
>
> > Although your NACK is well explained, for the reasons above I am
> > prepared to run code that overrides it.
>
> Good.  In the end, we're all at the whim of the economic majority.
>
> Cheers!
> Rusty.
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210407/e1e7b86a/attachment.html>

From eric at voskuil.org  Wed Apr  7 15:25:22 2021
From: eric at voskuil.org (eric at voskuil.org)
Date: Wed, 7 Apr 2021 08:25:22 -0700
Subject: [bitcoin-dev] March 23rd 2021 Taproot Activation Meeting Notes
In-Reply-To: <CANPykMr_pyz7XxrXo2FfkNPmBwzMkmnL2SPw8-TmVhOtxkz=-A@mail.gmail.com>
References: <CAD5xwhiXE=yJFi+9aZQqMOCaiUrJ_UEvcESR3E0j2SA1RnbqmA@mail.gmail.com>
 <874kgkkpji.fsf@rustcorp.com.au>
 <CAMnpzfopMNO=73wqvXpOn9u8X4MwJArqGxODJAS4-9iFiZOd6A@mail.gmail.com>
 <87pmz6it7q.fsf@rustcorp.com.au>
 <CANPykMr_pyz7XxrXo2FfkNPmBwzMkmnL2SPw8-TmVhOtxkz=-A@mail.gmail.com>
Message-ID: <0a4c01d72bc2$39ff9560$adfec020$@voskuil.org>

You may activate any time you want.

 

e

 

From: bitcoin-dev <bitcoin-dev-bounces at lists.linuxfoundation.org> On Behalf Of Claus Ehrenberg via bitcoin-dev
Sent: Wednesday, April 7, 2021 6:42 AM
To: Rusty Russell <rusty at rustcorp.com.au>; Bitcoin Protocol Discussion <bitcoin-dev at lists.linuxfoundation.org>
Subject: Re: [bitcoin-dev] March 23rd 2021 Taproot Activation Meeting Notes

 

As a user, I think it's very important for me to know if Taproot is eventually coming or not. So why not make it so that if _either_ miners _or_ users decide for Taproot, it will activate no matter what. Accepting a chain split is imo the fairest way to 'resolve the conflict' (it can't be resolved anyway).

 

That would probably mean running ST and and UASF concurrently.

 

The upside would be that we've got a safe date for Taproot, except neither users nor miners want it.

 

Cheers,

Claus

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210407/dafd545f/attachment.html>

From lf-lists at mattcorallo.com  Wed Apr  7 17:13:11 2021
From: lf-lists at mattcorallo.com (Matt Corallo)
Date: Wed, 7 Apr 2021 13:13:11 -0400
Subject: [bitcoin-dev] March 23rd 2021 Taproot Activation Meeting Notes
In-Reply-To: <87pmz6it7q.fsf@rustcorp.com.au>
References: <CAD5xwhiXE=yJFi+9aZQqMOCaiUrJ_UEvcESR3E0j2SA1RnbqmA@mail.gmail.com>
 <874kgkkpji.fsf@rustcorp.com.au>
 <CAMnpzfopMNO=73wqvXpOn9u8X4MwJArqGxODJAS4-9iFiZOd6A@mail.gmail.com>
 <87pmz6it7q.fsf@rustcorp.com.au>
Message-ID: <21f49308-c624-8d55-a40d-6634b3cf4cb8@mattcorallo.com>



On 4/7/21 01:01, Rusty Russell via bitcoin-dev wrote:
> Ryan Grant <bitcoin-dev at rgrant.org> writes:
>> On Tue, Apr 6, 2021 at 11:58 PM Rusty Russell via bitcoin-dev
>> What ST is saying is that a strategy of avoiding unnecessary risk is
>> stronger than a strategy of brinkmanship when brinkmanship wasn't
>> our only option.  Having deescalation in the strategy toolkit makes
>> Bitcoin stronger.
> 
> I don't believe that having a plan is brinkmanship or an escalation.

I strongly disagree with this characterization of ST, primarily because there just isn't the kind of agreement you seem 
to be assuming. ST isn't a "lets not decide because we don't want to formulate a specific grand plan" its more of a 
"lets not decide, because there are very strong, and very divergent viewpoints on what a specific grand plan can or 
should look like, and something most people are ok with is better than nothing at all". Ultimately, there are a number 
of possible directions a grand plan could go, and there appear to be at least several prominent (and likely many 
non-prominent) individuals who would strongly disagree with any such plan, you and I likely among them :).
>>
>> LOT=true does face the awkward question, but there are downsides:
>>
>>    - in the requirement to drop blocks from apathetic miners (although
>>      as Luke-Jr pointed out in a previous reply on this list they have
>>      no contract under which to raise a complaint); and
> 
> Surely, yes.  If the users of bitcoin decide blocks are invalid, they're
> invalid.  With a year's warning, and developer and user consensus
> against them, I think we've reached the limits of acceptable miner
> apathy.

You say "developer and user consensus against them" here, but then go on to argue that its perfectly acceptable for only 
a small subset of users to be required to do something below.

>>    - in the risk of a chain split, should gauging economic majority
>>      support - which there is zero intrinsic tooling for - go poorly.
> 
> Agreed that we should definitely do better here: in practice people
> would rely on third party explorers for information on the other side of
> the split.  Tracking the cumulative work on invalid chains would be a
> good idea for bitcoind in general (AJ suggested this, IIRC).

We already have a really, really great precedent for tracking economic majority, I'd argue we have great tooling here! 
During Segwit2x, we had multiple futures and chain-split-tokens available, including the BitMex futures with billions of 
dollars in daily volume! For the BCH split, ViaBTC issued similar chain split tokens.

At the end of the day, economic value is going to determine the amount of hashrate on any chain, and there is a very, 
very strong incentive (trading fees!) for an exchange to list...more stuff, chainsplit tokens included.

Why do we need to build in really janky ways to measure economic majority when there's already a great one that 
experience has shown us will prop up and provide reasonable signal, given any material demand.

>>> Personally, I think the compromise position is using LOT=false and
>>> having those such as Luke and myself continue working on a LOT=true
>>> branch for future consideration.  It's less than optimal, but I
>>> appreciate that people want Taproot activated more than they want
>>> the groundwork future upgrades.
>>
>> Another way of viewing the current situation is that should
>> brinkmanship be necessary, then better tooling to resolve a situation
>> that requires brinkmanship will be invaluable.  But:
>>
>>    - we do not need to normalize brinkmanship;
>>
>>    - designing brinkmanship tooling well before the next crisis does
>>      not require selecting conveniently completed host features to
>>      strap the tooling onto for testing; and
> 
> Again, openly creating a contingency plan is not brinkmanship, it's
> normal.  I know that considering these scenarios is uncomfortable; I
> avoid conflict myself!  But I feel obliged to face this as a real
> possibility.
> 
> I think we should be normalizing the understanding that bitcoin users
> are the ultimate decider.  By offering *all* of them the tools to do so
> we show this isn't lip-service, but something that businesses and
> everyone else in the ecosystem should consider.

While I strongly agree with your principle, I strongly disagree with the practice of how you propose going about it. 
Ultimately, no matter what we decide here, elsewhere, or what the process for consensus changes is, the decider will be 
economic activity and users voting with their Bitcoin. We should start by acknowledging that, and acknowledging that the 
markets will (and have!) let us know what they think when there is any kind of material disagreement.

Then, we should optimize for ensuring that the market never needs to "correct the situation", because if we end up there 
(or in any of these kinds of scenarios), we've basically screwed the pooch. Sure, some 10% minority group (and usually 
less as time goes on) forking themselves off has turned out to basically be irrelevant, but if we end up with multiple 
active chains as a normal course of business (which I'd strongly argue we'd be optimizing for with some kind of UASF/LOT 
option design out the gate), all we do is encourage strife, at the cost of users who just want to use a robust and 
reliable Bitcoin.

>>    - it's already the case that a UASF branch can be prepared along
>>      with ST (ie. without requiring LOT=false), although the code is a
>>      bit more complex and the appropriate stopheight a few blocks later.
> 
> I don't believe this is true, unless you UASF before ST expires?  ST is
> explicitly designed *not* to give time to conclude that miners are
> stalling (unless something has changed from the initial 3 month
> proposal?).

ST is not intended to be an end-all, be-all of the taproot activation story. I don't think anyone who is pushing for it 
thinks that ST is the only option if miners are not able to upgrade before its signaling window expires. Just because it 
isn't designed to ensure we can play brinksman ship fork games with a UASF doesn't mean there isn't a followup that 
could include such a thing.

Matt

From prayank at tutanota.de  Wed Apr  7 19:07:45 2021
From: prayank at tutanota.de (Prayank)
Date: Wed, 7 Apr 2021 21:07:45 +0200 (CEST)
Subject: [bitcoin-dev] Prediction Markets and Bitcoin
Message-ID: <MXhivQp----2@tutanota.de>

Positives:

You need money to participate even though your position size may not matter if really small based on liquidity and volume.
Useful information if looking at overall sentiments especially traders
Noise filter because its not same as trolling on social media
Opportunity for some people to make money
Entertainment and something new to discuss or confirm bias

Negatives:

You need money to participate. "Full nodes enforce consensus rules" becomes a meme. Full nodes will still enforce consensus rules but some full nodes are being influenced by people with money which can be anything not necessarily bitcoin.
Information that may not be useful for everyone.
The exchanges who have created such markets in past and the traders involved know how to manipulate illiquid markets at least for a short time period. And sometimes "markets can remain irrational longer than you can remain solvent".?
If such markets affect Bitcoin development in any way, it will be great opportunity for governments to attack Bitcoin. Example: Consider we have a soft fork or hard fork for confidential transaction on-chain in future, if someone is able to find a secure way to implement it. All the governments that love to spy will have some issues with it and won't be the first time if they participate in such markets indirectly to manipulate or start some investigation against exchanges involved or something else.
Focus which should have been on improving Bitcoin will now shift to futures markets and their involvement in Bitcoin.

I think prediction markets or such tokens might help in adding to the information we already have however they don't decide or replace anything. Bitcoin development should impact such markets and not the other way around.? Nobody can stop markets from betting on something related to Bitcoin and it can even be done using P2P exchanges like HodlHodl: https://predictions.hodlhodl.com?or create something new with oracles which can be implemented using DLC:?https://github.com/discreetlogcontracts/dlcspecs?

Not everyone is a trader or interested to take risk in such markets even if a Bitcoin user from years, lot of transactions, contributions and some opinion on Taproot based on things that are publicly available to everyone but scattered. In past we had things that made some sense for prediction markets like 2x and Bcash but right now nobody has issues with Taproot and even the best traders won't be aware of all the technical details about Bitcoin development to predict something related to activation mechanism.?

If the point of using prediction markets is to filter noise or spam then maybe we can have one chatroom that requires some sats to enter and pay some sats for each post. We will have better information here and sats can be used to donate to devs who review PRs related to Taproot.?
-- 
 Prayank
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210407/92259e3c/attachment.html>

From aj at erisian.com.au  Thu Apr  8 11:11:06 2021
From: aj at erisian.com.au (Anthony Towns)
Date: Thu, 8 Apr 2021 21:11:06 +1000
Subject: [bitcoin-dev] March 23rd 2021 Taproot Activation Meeting Notes
In-Reply-To: <87pmz6it7q.fsf@rustcorp.com.au>
References: <CAD5xwhiXE=yJFi+9aZQqMOCaiUrJ_UEvcESR3E0j2SA1RnbqmA@mail.gmail.com>
 <874kgkkpji.fsf@rustcorp.com.au>
 <CAMnpzfopMNO=73wqvXpOn9u8X4MwJArqGxODJAS4-9iFiZOd6A@mail.gmail.com>
 <87pmz6it7q.fsf@rustcorp.com.au>
Message-ID: <20210408111106.GA31864@erisian.com.au>

On Wed, Apr 07, 2021 at 02:31:13PM +0930, Rusty Russell via bitcoin-dev wrote:
> >> It's totally a political approach, to avoid facing the awkward question.
> >> Since I believe that such prevaricating makes a future crisis less
> >> predictable, I am forced to conclude that it makes bitcoin less robust.
> > LOT=true does face the awkward question, but there are downsides:
> >   - in the requirement to drop blocks from apathetic miners (although
> >     as Luke-Jr pointed out in a previous reply on this list they have
> >     no contract under which to raise a complaint); and
> Surely, yes.  If the users of bitcoin decide blocks are invalid, they're
> invalid.

That's begging the question though -- yes, if _everyone_ decides bitcoin
works such-n-such a way, then there's no debate. But that's trivial:
who's left to debate, when everyone agrees?

On the otherhand, if people disagree with you, who's to say they're in
the minority and "the users" are on your side?

> With a year's warning, and developer and user consensus
> against them, I think we've reached the limits of acceptable miner
> apathy.

The question is "how do you establish developer and user consensus?"

In particular, if you're running a business accepting payments via
"bitcoin", how do you know what software to run to stay in consensus
with everyone else running bitcoin, so you know the payments you receive
are good?

Ideally, we try to make the answer to that trivial: just download any
version of bitcoind and run it with the default configuration. More
recent (supported) versions are better due to potential security fixes
and performance improvements, of course.

> >   - in the risk of a chain split, should gauging economic majority
> >     support - which there is zero intrinsic tooling for - go poorly.
> Agreed that we should definitely do better here: in practice people
> would rely on third party explorers for information on the other side of
> the split.  Tracking the cumulative work on invalid chains would be a
> good idea for bitcoind in general (AJ suggested this, IIRC).

Those measures are only useful *after* there's been a chain split. I'm
certainly in favour of better protections like that -- adversarial
thinking, prepper-ism, whatever -- but we should be trying really hard to
avoid ending up in that situation; and even better to avoid even ending
up *risking* that situation.

> Again, openly creating a contingency plan is not brinkmanship,

I think the word "brinkmanship" is being a bit overused in this thread...

lockinontimeout is designed for a chain split -- its only action is
to ignore one side of a split should it occur. That's not useless --
splitting the chain is a plausible scenario in the event of someone
dedicating something like $200M+ per week to attacking bitcoin, and we
should have contingencies in place for that sort of thing.

But it's like carrying a gun around -- yeah, there are times when that
might be helpful for self-protection or to put a tyrant into the ground;
but putting it down on the table everytime you sit down for a coffee*
and tapping it and saying "look, I'm sure you'll do the right thing and
serve me properly and I'll leave happy and give you a big tip; this is
just a contingency plan" isn't super great.

And even then, lockinontimeout isn't really a very *good* contingency
plan in the event of a chain split: if your side of the split isn't
in the majority, you're relying on the other side -- the one with all
the money -- being stupid and not having a dontlockinever=yes option to
protect them from wipeout, and without a hardfork to change proof-of-work
or the difficulty adjustment, you'll have enormous difficulties getting
blocks at all.

* The only thing worth spending bitcoin on.

> I think we should be normalizing the understanding that bitcoin users
> are the ultimate decider.

Yes. 

What we shouldn't be normalising is that the way users decide is by
risking their business by having their node reject blocks and hoping
that everyone else will also reject the same set of blocks.

(After all, businesses handling lots of bitcoin being willing to force
the issue via running node software that rejects "invalid" blocks,
was the whole plan for making s2x a fait accompli...)

I've written up what I believe is a better approach to dealing with
the possibility of miners not upgrading to enforce a soft-fork quickly
here:

https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-March/018723.html

I belive it would be straightforward to implement that after a failed
speedy trial; technically anyway.

Cheers,
aj


From michaelfolkson at gmail.com  Thu Apr  8 11:40:42 2021
From: michaelfolkson at gmail.com (Michael Folkson)
Date: Thu, 8 Apr 2021 12:40:42 +0100
Subject: [bitcoin-dev] Update on "Speedy" Trial: The circus rolls on
Message-ID: <CAFvNmHR54FCakJtaNvnwc3r6p8qhr+-e1MC2MennWm=tNZ2Unw@mail.gmail.com>

I will continue to update the list on the latest developments as I see
them. That's all I can do.

So the latest circus act is apparently a technical decision made by a
coin toss. The rationale being that this discussion on using block
height vs a mix of block height and MTP was bikeshedding all along.

Here's a short abridged timeline on the views on block height vs MTP
of the organizer (Jeremy Rubin) of that coin toss:

March 8th: "I have a preference for fully height based design,
correct." https://github.com/bitcoin/bitcoin/pull/21377#issuecomment-802396191

March 24th: "There are two NACKs, one (luke-jr) against MTP, one
(jeremyrubin) against height.?
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-March/018715.html

April 6th: "The following folks in the meeting agreed to abide by the
flip.... jeremyrubin"
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-April/018742.html

April 7th: "So @achow101 is correct that it is not the coin flip which
made the decision."
https://github.com/bitcoin/bitcoin/pull/21393#issuecomment-815388126

Please note on March 24th the only person NACKing block height in that
meeting was Jeremy Rubin. He has gone from preferring block height, to
NACKing block height, to thinking this discussion all along was
bikeshedding and worthy of a coin flip to admitting the coin flip was
theater.

All of this makes me extremely uncomfortable and I dread to think what
individuals and businesses all over the world who have plans to
utilize and build on Taproot are making of all of this. As an
individual I would like to distance myself from this circus. I will
try to keep the mailing list informed though of further developments
re Speedy Trial in Core or progress on an alternative client.

There are two StackExchange answers here on block height vs MTP, one
by David Harding and one by myself for those that are interested in
the technical considerations.
https://bitcoin.stackexchange.com/questions/103854/should-block-height-or-mtp-or-a-mixture-of-both-be-used-in-a-soft-fork-activatio

-- 
Michael Folkson
Email: michaelfolkson at gmail.com
Keybase: michaelfolkson
PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3

From apoelstra at wpsoftware.net  Thu Apr  8 14:30:05 2021
From: apoelstra at wpsoftware.net (Andrew Poelstra)
Date: Thu, 8 Apr 2021 14:30:05 +0000
Subject: [bitcoin-dev] Update on "Speedy" Trial: The circus rolls on
In-Reply-To: <CAFvNmHR54FCakJtaNvnwc3r6p8qhr+-e1MC2MennWm=tNZ2Unw@mail.gmail.com>
References: <CAFvNmHR54FCakJtaNvnwc3r6p8qhr+-e1MC2MennWm=tNZ2Unw@mail.gmail.com>
Message-ID: <YG8TbUFieg1yb/Ax@camus>

On Thu, Apr 08, 2021 at 12:40:42PM +0100, Michael Folkson via bitcoin-dev wrote:
> 
> All of this makes me extremely uncomfortable and I dread to think what
> individuals and businesses all over the world who have plans to
> utilize and build on Taproot are making of all of this. As an
> individual I would like to distance myself from this circus. I will
> try to keep the mailing list informed though of further developments
> re Speedy Trial in Core or progress on an alternative client.
>

Thank you for your updates.


For what it's worth, as somebody who wants to use Taproot I don't care *at
all* about activation parameters, and I especially don't care about block
height vs MTP.

If a coin toss is what it takes for people to move past this that's fine
by me.


 
-- 
Andrew Poelstra
Director of Research, Blockstream
Email: apoelstra at wpsoftware.net
Web:   https://www.wpsoftware.net/andrew

The sun is always shining in space
    -Justin Lewis-Webster


From lf-lists at mattcorallo.com  Thu Apr  8 15:18:33 2021
From: lf-lists at mattcorallo.com (Matt Corallo)
Date: Thu, 8 Apr 2021 11:18:33 -0400
Subject: [bitcoin-dev] Update on "Speedy" Trial: The circus rolls on
In-Reply-To: <YG8TbUFieg1yb/Ax@camus>
References: <CAFvNmHR54FCakJtaNvnwc3r6p8qhr+-e1MC2MennWm=tNZ2Unw@mail.gmail.com>
 <YG8TbUFieg1yb/Ax@camus>
Message-ID: <125be010-93b9-f7dd-70d4-81a63a603621@mattcorallo.com>

Probably worth noting, but while the coin toss was acceptable to many people as "who cares, just move on", the two 
authors of actual code for the two proposals here also came to an agreement on a way forward, so its not like it was a 
"coin toss to overrule everyone on 'the other side'".

On 4/8/21 10:30, Andrew Poelstra via bitcoin-dev wrote:
> On Thu, Apr 08, 2021 at 12:40:42PM +0100, Michael Folkson via bitcoin-dev wrote:
>>
>> All of this makes me extremely uncomfortable and I dread to think what
>> individuals and businesses all over the world who have plans to
>> utilize and build on Taproot are making of all of this. As an
>> individual I would like to distance myself from this circus. I will
>> try to keep the mailing list informed though of further developments
>> re Speedy Trial in Core or progress on an alternative client.
>>
> 
> Thank you for your updates.
> 
> 
> For what it's worth, as somebody who wants to use Taproot I don't care *at
> all* about activation parameters, and I especially don't care about block
> height vs MTP.
> 
> If a coin toss is what it takes for people to move past this that's fine
> by me.
> 
> 
>   
> 

From dave at dtrt.org  Thu Apr  8 21:56:05 2021
From: dave at dtrt.org (David A. Harding)
Date: Thu, 8 Apr 2021 11:56:05 -1000
Subject: [bitcoin-dev] Update on "Speedy" Trial: The circus rolls on
In-Reply-To: <CAFvNmHR54FCakJtaNvnwc3r6p8qhr+-e1MC2MennWm=tNZ2Unw@mail.gmail.com>
References: <CAFvNmHR54FCakJtaNvnwc3r6p8qhr+-e1MC2MennWm=tNZ2Unw@mail.gmail.com>
Message-ID: <20210408215605.5qdcpwkay6cxyyvr@ganymede>

On Thu, Apr 08, 2021 at 12:40:42PM +0100, Michael Folkson via bitcoin-dev wrote:
> So the latest circus act is apparently a technical decision made by a
> coin toss [organized by] Jeremy Rubin

Actually, the coin toss was my idea[1], used a bash oneliner I wrote[2],
and is the same method I've been using in Bitcoin-related discussions
for over seven years[3] to help people transition from ancillary arguments
back to working on the things they really think are important.

I proposed the coin toss because I understood that both the MTP and the
height approaches required tradeoffs that were, to a certain degree,
unresolvable to the best of our current knowledge.  MTP is harder to
analyze for unexpected edge cases; heights would create extra work for
seasoned developers working on post-taproot soft forks.  MTP would
require developers of currently-planned UASF software either do extra
work or wait to release their software; heights don't guarantee a
minimum amount of time for a large number of economic full nodes to
upgrade.

Different people gave different weights to the different tradeoffs.  In
cases like this where there's no known way to eliminate the tradeoffs
and no way to objectively rank them, I think it's better to begin
working on something concrete than it is to try to persuade everyone to
adopt the same subjective ranking of the tradeoffs---or, as the IETF
published in RFC7282:

    "There are times where the result of [an informal open-ended
    conversation] is a pretty even split.  In practical terms, that
    means it doesn't matter where the chair starts the discussion.  And
    in fact, we've had working groups where a coin flip decided which
    proposal to start with.  That doesn't mean that the coin flip
    determined the outcome; if a fatal technical flaw was found in the
    solution that won the coin flip, it is still incumbent upon the
    group to address the issue raised or abandon that solution and find
    another.  Rough consensus on the technical points, in the end, is
    always required.  Any way to find a place to start, be it the hum or
    the coin flip, is only getting to the beginning of the discussion,
    not the end."

As Jeremy wrote, in this occassion, we didn't actually need the coin
toss.  The authors of the two PRs we were considering found a compromise
solution that seems to be good enough for both of them and which so far
seems to be good enough for the handful of people who agreed to the coin
toss (plus, it seems, several others who didn't agree to the toss).

In short, I think the coin toss was a good attempt.  Although we didn't
use its results this time, I think it's something we should keep in our
toolkit for the future when a group of people want to coordinate their
work on getting *a* solution released, even in cases where they don't
necessarily start out in agreement about which solution is best.

> I dread to think what individuals and businesses all over the world
> who have plans to utilize and build on Taproot are making of all of
> this. 

Geeks arguing over minutia is a well established stereotype.  That we've
conformed to that stereotype in this case is not great---but I don't
think it does us any significant reputational harm.  I hope those
individuals and businesses awaiting taproot are discerning enough to
realize that the method we use to activate taproot has nothing to do
with taproot itself.  I hope they realize that it remains the case that
there is nearly universal support for taproot from every entity that has
so far commented on it.

Hopefully we've made progress on Speedy Trial this week, that progress
will continue and we'll be able to release activation-ready software
soon, miners will be willing to signal for taproot, and we'll soon be
able to end this chapter in Bitcoin's storied history of soft fork
activations.[4]  (But I look forward to continued discussion about
better activation mechanisms for the future---if taproot locks in
quickly, I'd love to see human consensus form around a follow-up
deployment even before taproot reaches activation.)

Respectfully,

-Dave

[1] http://gnusha.org/taproot-activation/2021-04-04.log "<harding> [...]
If that's not our goal and we just want to give miners a chance to
activate taproot as soon as possible (which was certainly my original
objective in supporting ST), I'm personally happy with either MTP or
heights, and I'd be willing to join others in putting my effort behind
just one of them based on fair random chance."

[2] http://gnusha.org/taproot-activation/2021-04-04.log "18:09 <
harding> e.g.:   bitcoin-cli getblockhash 123456 | cut -b64 | grep -q
'[02468ace]' && echo MTP || echo height"

[3] E.g.,
https://github.com/bitcoin-dot-org/Bitcoin.org/pull/589#discussion_r18314009
and https://github.com/bitcoin-dot-org/Bitcoin.org/pull/566#issuecomment-56281595

[4] https://bitcoinops.org/en/topics/soft-fork-activation/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210408/4ab23028/attachment.sig>

From jlrubin at mit.edu  Fri Apr  9 03:57:39 2021
From: jlrubin at mit.edu (Jeremy)
Date: Thu, 8 Apr 2021 20:57:39 -0700
Subject: [bitcoin-dev] Designing Bitcoin Smart Contracts with Sapio
	(available on Mainnet today)
Message-ID: <CAD5xwhiwYLe8-0Ya2msJY5+XrTERCS20epALpqUPXz-0FEKZTg@mail.gmail.com>

Bitcoin Developers,

I'm very excited to introduce Sapio[0] <https://github.com/sapio-lang/sapio>
formally to you all.

Sapio empowers Bitcoin Developers to craft smart contracts in an intuitive,
safe, and composable way. Sapio challenges the notion that you can't make
complex smart contracts for Bitcoin, and opens the floodgates for a myriad
of new ideas to be defined easily. Sapio works today on mainnet without any
protocol changes (via user-configurable multisig oracles, it will work
with BIP-119
OP_CHECKTEMPLATEVERIFY[1] <https://utxos.org> and Taproot when they are
available).

You can learn more about what's possible by reading *Designing Bitcoin
Smart Contracts with Sapio[2] <https://learn.sapio-lang.org>*. My Reckless
VR Talk[3] <https://judica.org/blog/sapio/> also does a great job of
breaking down the core programming model for Sapio contracts, although the
language has evolved substantially since I gave the talk.

As a concrete instance of Sapio working in the wild, I am currently
executing on mainnet a Congestion Control Tree[4]
<https://utxos.org/analysis/bip_simulation/> contract with 25 recipients
(the first Sapio contract to run on mainnet ever, as far as I'm aware). You
can review the source code, arguments, compiler outputs, and transactions
here[5]
<https://gist.github.com/JeremyRubin/1374f0916bfdef0bd36bc10d73852886>.

To see more examples of what you can do with Sapio, the repo includes
examples[6]
<https://github.com/sapio-lang/sapio/tree/master/sapio-contrib/src/contracts>
for derivatives, vaults, coin pools, games, side chains, and more. These
aren't intended to be production grade contracts -- yet -- but are
demonstrative of what can be built and how. I'm excited to see what people
build -- please open up PRs with your ideas or any issues you encounter
trying to implement them.

You can also try out Tux[7] <https://github.com/sapio-lang/tux>, an
experimental GUI, to inspect, simulate, and interact with smart contracts.
You can see the Congestion Control Tree mentioned earlier loaded in Tux
below[8] <https://i.imgur.com/pg5SqfH.png>:




This is still early work-in-progress software, so tread lightly and use
regtest. Enough of the components work today that it was appropriate to
share now and invite more developers to contribute or otherwise support the
project.

Sapio is developed free and open source for all bitcoiners by Judica.org
(my organization).

Thank you to all who have helped reach this milestone of the first mainnet
Sapio contract, including Ryan Grant, BitMEX, ACINQ, Delphi Digital,
Backend Capital, my github sponsors https://github.com/sponsors/jeremyrubin,
and numerous other supporters both fiscal and technical. I also want to
highlight the excellent work done on Miniscript and the rust-bitcoin
ecosystem, the foundation upon which Sapio rests.

[0] https://github.com/sapio-lang/sapio
[1] https://utxos.org
[2] https://learn.sapio-lang.org
[3] https://judica.org/blog/sapio/
[4] https://utxos.org/analysis/bip_simulation/
[5] https://gist.github.com/JeremyRubin/1374f0916bfdef0bd36bc10d73852886
[6]
https://github.com/sapio-lang/sapio/tree/master/sapio-contrib/src/contracts
[7] https://github.com/sapio-lang/tux
[8] https://imgur.com/pg5SqfH


Eager for you feedback,

Jeremy

--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210408/0bc8fa33/attachment-0001.html>

From erik at q32.com  Fri Apr  9 08:15:01 2021
From: erik at q32.com (Erik Aronesty)
Date: Fri, 9 Apr 2021 04:15:01 -0400
Subject: [bitcoin-dev] maximum block height on transaction
In-Reply-To: <CAPg+sBi+WnzpJkcG6XACdpqqz9ZA3rHX8+H9b5eExUdgXaeiWQ@mail.gmail.com>
References: <5B6756D0-6BEF-4A01-BDB8-52C646916E29@friedenbach.org>
 <C623794E-F061-4C7A-B05D-378798ED2BF7@friedenbach.org>
 <201709190309.08669.luke@dashjr.org>
 <CAA2B000-6C54-4AD7-B931-43C99D615A61@friedenbach.org>
 <CAKzdR-phAarTY16BOnC95BPN0qMNEE_XZ9H-XmFeeaBc2V1U5w@mail.gmail.com>
 <3385CE20-C1BA-40DD-8FC3-8F53F3350717@friedenbach.org>
 <CAKzdR-pnvystx5H+P+OCXm73aVmWdyesCymerSgx=pCuXx+YGA@mail.gmail.com>
 <9FD4AF03-28A5-4B8A-9C12-CBCB1BC2E22C@friedenbach.org>
 <CAKzdR-r6u4J+_T5X516A=-tLWZ8zFFFsRokReiJndDE_S64OqQ@mail.gmail.com>
 <CAPg+sBi+WnzpJkcG6XACdpqqz9ZA3rHX8+H9b5eExUdgXaeiWQ@mail.gmail.com>
Message-ID: <CAJowKg+kbnExgKt7H8GD6Kc-iLJEOvZhtw0uVbophhLCszvOHg@mail.gmail.com>

is there any way to specify a maximum block height on a transaction?

ie: this tx is only valid if included in a block with a certain height or less

i feel like this would be useful

From parazyd at dyne.org  Fri Apr  9 10:23:27 2021
From: parazyd at dyne.org (Ivan J.)
Date: Fri, 09 Apr 2021 12:23:27 +0200
Subject: [bitcoin-dev] An Electrum server using libbitcoin
Message-ID: <20210409122327.GA8443@fq>

Hi.

I've been working on an Electrum server implementation that uses zmq
and libbitcoin as its backend. I wanted to use the Electrum wallet with
my libbitcoin server and this makes it possible now with (unfinished)
libbitcoin v4.

The code is here: https://github.com/parazyd/obelisk
(Yes, it's named Obelisk because of historical reasons :p)

As the Electrum/ElectrumX protocol is getting some new stuff in
protocol version 1.5, I will keep tracking the protocol and implement
it in Obelisk as it comes.

Eventually, the end-goal is to merge Obelisk into Electrum and simply
use libbitcoin public (or self-hosted) servers directly, without
the need of a boilerplate protocol/server between a client and a
daemon. In current Electrum git, this seems relatively simple to do
(and I personally already have done about 70% of it on my local
code repository), but the problem is that it's a breaking change
and replaces the old protocol, which invalidates all old servers
if/when this change happens. However, I don't doubt that removing
the boilerplate and querying a libbitcoin server directly is a bad
idea at all. I'll see if I can make upstream progress on this once
I get feedback.

In general, regarding Obelisk I'd appreciate some feedback, review,
and a bit of help with certain TODOs in the code. The entire codebase
is around 1000 lines of Python 3 with no external dependecies besides
pyzmq.

Thanks,
Ivan

From michaelfolkson at gmail.com  Fri Apr  9 11:19:02 2021
From: michaelfolkson at gmail.com (Michael Folkson)
Date: Fri, 9 Apr 2021 12:19:02 +0100
Subject: [bitcoin-dev] Update on "Speedy" Trial: The circus rolls on
In-Reply-To: <20210408215605.5qdcpwkay6cxyyvr@ganymede>
References: <CAFvNmHR54FCakJtaNvnwc3r6p8qhr+-e1MC2MennWm=tNZ2Unw@mail.gmail.com>
 <20210408215605.5qdcpwkay6cxyyvr@ganymede>
Message-ID: <CAFvNmHSd-YJk4Sst4pSxLDfMyLw_4g+76vBfdKOJj9LgdbD-Ew@mail.gmail.com>

I have no problem with coin tosses to decide for example shed colors
(an illustrative example discussed by copumpkin, roasbeef on IRC). In
this kind of example everyone should recognize it doesn't matter and
Approach ACK two competing PRs. No one should be NACKing or Approach
NACKing a PR based on shed color. If the maintainers don't care about
the shed color either then they are free to use a coin toss to decide
which PR to merge. In this example there shouldn't be any NACKs,
Approach NACKs or technical opposition from regular Core reviewers.
NACKs are not meant to be used for shed colors.

However, in this example the organizer of the coin toss had previously
NACKed one of the options (block height, though his position seems to
change by the day) and others have NACKed MTP. I think you have
consistently said it doesn't matter too much although you did
previously express a preference for block height.

I don't want to belabor the point but can we avoid even suggesting
using coin tosses on consensus code decisions in future please? It
makes a mockery of those who spent time understanding the technical
considerations and have spent months or years working on soft fork
activations. Even in the shed color example, leave it to the
maintainers to decide whether a coin toss is appropriate rather than
creating a circus around a coin toss in a public meeting where the PR
authors weren't present and no Core maintainers were present.

I understand the frustration and I understand the desire to break
deadlocks. But if the coin toss organizer hadn't previously NACKed one
of the options (block height) we may have avoided getting into this
deadlock in the first place.

Your recent review notes of PR #21377 look great and are proving very
helpful to me as I look at the PR.
https://gist.github.com/harding/e622323eaf80d620826a7cb74ab3fb40

Thanks
Michael

On Thu, Apr 8, 2021 at 10:57 PM David A. Harding <dave at dtrt.org> wrote:
>
> On Thu, Apr 08, 2021 at 12:40:42PM +0100, Michael Folkson via bitcoin-dev wrote:
> > So the latest circus act is apparently a technical decision made by a
> > coin toss [organized by] Jeremy Rubin
>
> Actually, the coin toss was my idea[1], used a bash oneliner I wrote[2],
> and is the same method I've been using in Bitcoin-related discussions
> for over seven years[3] to help people transition from ancillary arguments
> back to working on the things they really think are important.
>
> I proposed the coin toss because I understood that both the MTP and the
> height approaches required tradeoffs that were, to a certain degree,
> unresolvable to the best of our current knowledge.  MTP is harder to
> analyze for unexpected edge cases; heights would create extra work for
> seasoned developers working on post-taproot soft forks.  MTP would
> require developers of currently-planned UASF software either do extra
> work or wait to release their software; heights don't guarantee a
> minimum amount of time for a large number of economic full nodes to
> upgrade.
>
> Different people gave different weights to the different tradeoffs.  In
> cases like this where there's no known way to eliminate the tradeoffs
> and no way to objectively rank them, I think it's better to begin
> working on something concrete than it is to try to persuade everyone to
> adopt the same subjective ranking of the tradeoffs---or, as the IETF
> published in RFC7282:
>
>     "There are times where the result of [an informal open-ended
>     conversation] is a pretty even split.  In practical terms, that
>     means it doesn't matter where the chair starts the discussion.  And
>     in fact, we've had working groups where a coin flip decided which
>     proposal to start with.  That doesn't mean that the coin flip
>     determined the outcome; if a fatal technical flaw was found in the
>     solution that won the coin flip, it is still incumbent upon the
>     group to address the issue raised or abandon that solution and find
>     another.  Rough consensus on the technical points, in the end, is
>     always required.  Any way to find a place to start, be it the hum or
>     the coin flip, is only getting to the beginning of the discussion,
>     not the end."
>
> As Jeremy wrote, in this occassion, we didn't actually need the coin
> toss.  The authors of the two PRs we were considering found a compromise
> solution that seems to be good enough for both of them and which so far
> seems to be good enough for the handful of people who agreed to the coin
> toss (plus, it seems, several others who didn't agree to the toss).
>
> In short, I think the coin toss was a good attempt.  Although we didn't
> use its results this time, I think it's something we should keep in our
> toolkit for the future when a group of people want to coordinate their
> work on getting *a* solution released, even in cases where they don't
> necessarily start out in agreement about which solution is best.
>
> > I dread to think what individuals and businesses all over the world
> > who have plans to utilize and build on Taproot are making of all of
> > this.
>
> Geeks arguing over minutia is a well established stereotype.  That we've
> conformed to that stereotype in this case is not great---but I don't
> think it does us any significant reputational harm.  I hope those
> individuals and businesses awaiting taproot are discerning enough to
> realize that the method we use to activate taproot has nothing to do
> with taproot itself.  I hope they realize that it remains the case that
> there is nearly universal support for taproot from every entity that has
> so far commented on it.
>
> Hopefully we've made progress on Speedy Trial this week, that progress
> will continue and we'll be able to release activation-ready software
> soon, miners will be willing to signal for taproot, and we'll soon be
> able to end this chapter in Bitcoin's storied history of soft fork
> activations.[4]  (But I look forward to continued discussion about
> better activation mechanisms for the future---if taproot locks in
> quickly, I'd love to see human consensus form around a follow-up
> deployment even before taproot reaches activation.)
>
> Respectfully,
>
> -Dave
>
> [1] http://gnusha.org/taproot-activation/2021-04-04.log "<harding> [...]
> If that's not our goal and we just want to give miners a chance to
> activate taproot as soon as possible (which was certainly my original
> objective in supporting ST), I'm personally happy with either MTP or
> heights, and I'd be willing to join others in putting my effort behind
> just one of them based on fair random chance."
>
> [2] http://gnusha.org/taproot-activation/2021-04-04.log "18:09 <
> harding> e.g.:   bitcoin-cli getblockhash 123456 | cut -b64 | grep -q
> '[02468ace]' && echo MTP || echo height"
>
> [3] E.g.,
> https://github.com/bitcoin-dot-org/Bitcoin.org/pull/589#discussion_r18314009
> and https://github.com/bitcoin-dot-org/Bitcoin.org/pull/566#issuecomment-56281595
>
> [4] https://bitcoinops.org/en/topics/soft-fork-activation/



-- 
Michael Folkson
Email: michaelfolkson at gmail.com
Keybase: michaelfolkson
PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3

From roconnor at blockstream.com  Fri Apr  9 11:39:45 2021
From: roconnor at blockstream.com (Russell O'Connor)
Date: Fri, 9 Apr 2021 07:39:45 -0400
Subject: [bitcoin-dev] maximum block height on transaction
In-Reply-To: <CAJowKg+kbnExgKt7H8GD6Kc-iLJEOvZhtw0uVbophhLCszvOHg@mail.gmail.com>
References: <5B6756D0-6BEF-4A01-BDB8-52C646916E29@friedenbach.org>
 <C623794E-F061-4C7A-B05D-378798ED2BF7@friedenbach.org>
 <201709190309.08669.luke@dashjr.org>
 <CAA2B000-6C54-4AD7-B931-43C99D615A61@friedenbach.org>
 <CAKzdR-phAarTY16BOnC95BPN0qMNEE_XZ9H-XmFeeaBc2V1U5w@mail.gmail.com>
 <3385CE20-C1BA-40DD-8FC3-8F53F3350717@friedenbach.org>
 <CAKzdR-pnvystx5H+P+OCXm73aVmWdyesCymerSgx=pCuXx+YGA@mail.gmail.com>
 <9FD4AF03-28A5-4B8A-9C12-CBCB1BC2E22C@friedenbach.org>
 <CAKzdR-r6u4J+_T5X516A=-tLWZ8zFFFsRokReiJndDE_S64OqQ@mail.gmail.com>
 <CAPg+sBi+WnzpJkcG6XACdpqqz9ZA3rHX8+H9b5eExUdgXaeiWQ@mail.gmail.com>
 <CAJowKg+kbnExgKt7H8GD6Kc-iLJEOvZhtw0uVbophhLCszvOHg@mail.gmail.com>
Message-ID: <CAMZUoKmQyV67dhWS_+t1CmqNYT490_7g3WwKgxB-jiYfje+F+Q@mail.gmail.com>

>From https://bitcointalk.org/index.php?topic=1786.msg22119#msg22119:

We can't safely do OP_BLOCKNUMBER.  In the event of a block chain reorg
> after a segmentation, transactions need to be able to get into the chain in
> a later block.  The OP_BLOCKNUMBER transaction and all its dependants would
> become invalid.  This wouldn't be fair to later owners of the coins who
> weren't involved in the time limited transaction.
>
> nTimeLock does the reverse.  It's an open transaction that can be replaced
> with new versions until the deadline.  It can't be recorded until it
> locks.  The highest version when the deadline hits gets recorded.  It could
> be used, for example, to write an escrow transaction that will
> automatically permanently lock and go through unless it is revoked before
> the deadline.  The feature isn't enabled or used yet, but the support is
> there so it could be implemented later.
>

Unfortunately, limiting the maximum block height for a specific transaction
would have exactly the same problem as cited above for OP_BLOCKNUMBER.

On Fri, Apr 9, 2021 at 7:21 AM Erik Aronesty via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> is there any way to specify a maximum block height on a transaction?
>
> ie: this tx is only valid if included in a block with a certain height or
> less
>
> i feel like this would be useful
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210409/fed819a8/attachment.html>

From sjors at sprovoost.nl  Fri Apr  9 12:07:05 2021
From: sjors at sprovoost.nl (Sjors Provoost)
Date: Fri, 9 Apr 2021 14:07:05 +0200
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
Message-ID: <DDAD27D6-57F5-4B39-AADB-B28E04E36D29@sprovoost.nl>

Hi all,

First of all thanks for your continued work on standardising multisig setup.

The use case I personally find most interesting is not a multi-party setup, but rather just combining a bunch of my own devices. Those might even be in the same room during the setup, only to be moved to my moon base later.

This means I've paid less attention to the encryption scheme, so I might set TOKEN=0, but nevertheless I am skeptical about it. The first step is for the Coordinator to generate a TOKEN, presumably using its own entropy. But IIUC anyone who intercepts that token can decrypt any future step in the setup process. This suggests a chicken-egg problem where you need some pre-existing secure communications channel.

To the list of concerns at the top of the BIP, I would add one: losing multisig setup context. E.g. in the event of a fire where you only recover your steel engraved mnemonic(s), but no longer have the wallet descriptors.

If you still have all devices and know (or guess) the threshold then BIP48 and sorted_multi descriptors will save you. But if you have a 2-of-3 setup and lost 1 device then without the metadata your coins are lost. In a future with musig(?) and miniscript increasingly the setup data is just as critical as the seeds.

A future standard (or extension of this one) should recommend an encryption convention for the descriptor data, ideally such that with *any* of the seeds you can decrypt a file that contains the full setup. That file could then just float redundantly around the internet and pieces of paper in various locations, without compromising privacy.

The proposed encryption system doesn't help with that though, because it's based on entropy from the Coordinator, rather than from the signers.


Smaller suggestions:
* link to this new mail thread in the BIP
* use magic bytes so .bsms so operating systems like Android / iOs can open the right app for them
* don't use separate file extensions for encrypted vs unencrypted content, just indicate somehow that a given field is encrypted
* although plain text files are handy for debugging, I think a binary format like PSBT is much powerful. Any device that can parse and write binary PSBT should be able to implement a similar parser / writer for a binary .bsms format.
* BIP48 and sorted_multi descriptors are useful in a loss-of-metadata scenario. The BIP uses both in the examples, but doesn't explictly endorse these derivations. It also contradicts them: "If the Signer chooses the path, it should try to avoid reusing XPUBs for different wallets.". Maybe this is out of scope.
   * one way to resolve xpub reuse would be to make the "BIP48" path a function of the co-signer fingerprints and wallet threshold, but this requires an extra communication round
* there should be a way for signers to communicate their capabilities, perhaps with a different xpub for each potential scheme. E.g. there's m/48' native SegWit now, MuSig and/or or Tapleaf based multisig in the future, or even generic Miniscript support.
* the idea of only storing the receive descriptor, not the change descriptor, is fine by me, though I'd prefer an extension to the descriptor format to deal with this

Sjors

> Op 5 apr. 2021, om 09:02 heeft Hugo Nguyen via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> het volgende geschreven:
> 
> Hi all,
> 
> Please find below the complete draft of the Bitcoin Secure Multisig Setup (BSMS) BIP. The spec has gone through a number of important updates in the last month or so. Thanks everyone who has participated in the review process.
> 
> As a PR: https://github.com/bitcoin/bips/pull/1097

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: Message signed with OpenPGP
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210409/d254f217/attachment.sig>

From hugo at nunchuk.io  Fri Apr  9 14:09:51 2021
From: hugo at nunchuk.io (Hugo Nguyen)
Date: Fri, 9 Apr 2021 07:09:51 -0700
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <DDAD27D6-57F5-4B39-AADB-B28E04E36D29@sprovoost.nl>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <DDAD27D6-57F5-4B39-AADB-B28E04E36D29@sprovoost.nl>
Message-ID: <CAPKmR9u+Ron1AyLjPVsqNx6bWvkJMKzcF67JgP0TEEdysj78tw@mail.gmail.com>

Hi Sjors
Thanks for the feedback!

The first step is for the Coordinator to generate a TOKEN, presumably using
> its own entropy. But IIUC anyone who intercepts that token can decrypt any
> future step in the setup process. This suggests a chicken-egg problem where
> you need some pre-existing secure communications channel.
>

The exchange of the TOKEN is frequently mistaken as the chicken-and-egg
problem, but it is not so.

To understand why this isn't chicken-and-egg, and why the TOKEN actually
adds value, consider *the scale of the communication operation needed to
exchange the TOKEN*, and *the scale of the communication operation needed
to gather data for the creation of the multisig wallet *(with or without
the TOKEN):

1) The TOKEN itself is a single piece of data that is 64- or 96-bit. It is
small enough to be easily exchanged (even memorized) and entered into
various devices. It requires only a single round of communication, but can
protect as many rounds of communication as needed.

2) The data needed to create the multisig wallet, on the other hand, are
quite involving:
(a) Each Signer needs to share its XPUB, which cannot be memorized
(b) The XPUBs also come with their own metadata
(c) The creation of the wallet requires at least two rounds of
communications since the Signers need to voluntarily share their XPUBs
first, only then can a Coordinator combine the XPUBs into a single multisig
script and pass back the configuration to the Signers. (Note that without a
Coordinator, you'll need O(N^2) rounds of communication).
(d) Because Signers are typically off-line cold storage, the paths between
the Signers / the Signers <> Coordinator likely involve multiple hops
through various media, such as unsecure USB connection. This is the way
most multisig solutions are currently being implemented. It means the XPUBs
and the multisig configuration are vulnerable to leaking and/or
modifications.

Note that (d) is especially problematic for remote multisig setups. The
more remote, the more potential hops along the way, the more problematic.

So you can see that *the TOKEN ultimately reduces the problem of sharing a
large amount of sensitive data back and forth, to the sharing of a single,
small piece of data upfront.* An added advantage of this approach is that
if the parties fail to establish a shared TOKEN, the scheme fails with no
harm done.

The Coordinator, on the other hand, adds value by solving the O(n^2)
communication problem. Some minimal amount of trust is needed for the
Coordinator, but this can be greatly mitigated by a number of ways that we
have defined in the spec, such as:
* Signers must check that their XPUBs are included in the final descriptor
* Signers must display to the user the multisig configuration: M/N,
relative position(s) of XPUBs, etc.
* Signers must display the full descriptor upon user request for manual
inspection - this one is important because it means that the new scheme
cannot be worse than the status quo.
* Signers are recommended to display a preview of the first receive
address(es).

All in all, the Coordinator's role helps ease the setup process, while its
ability to pull off any shenanigans is greatly limited.

Best,
Hugo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210409/fadc12cb/attachment-0001.html>

From hugo at nunchuk.io  Fri Apr  9 14:54:11 2021
From: hugo at nunchuk.io (Hugo Nguyen)
Date: Fri, 9 Apr 2021 07:54:11 -0700
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <DDAD27D6-57F5-4B39-AADB-B28E04E36D29@sprovoost.nl>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <DDAD27D6-57F5-4B39-AADB-B28E04E36D29@sprovoost.nl>
Message-ID: <CAPKmR9u8zc3C7QmJYg-vg5jcutS07PK-0wdvpzCqMGLgnhHCBA@mail.gmail.com>

(Continue off last email: also keep in mind, that just like BIP174,
Coordinator and Signer are abstract roles. This means in theory a Signer
can be the Coordinator too. The same criteria for trust applies equally to
a Signer and a Coordinator.)

The use case I personally find most interesting is not a multi-party setup,
> but rather just combining a bunch of my own devices. Those might even be in
> the same room during the setup, only to be moved to my moon base later.
>

And that's fair. Both use cases (local and remote multisig) are valid and
currently being used. But IMO a standard should accommodate both.


> To the list of concerns at the top of the BIP, I would add one: losing
> multisig setup context. E.g. in the event of a fire where you only recover
> your steel engraved mnemonic(s), but no longer have the wallet descriptors.
>

Good point.


>
> If you still have all devices and know (or guess) the threshold then BIP48
> and sorted_multi descriptors will save you. But if you have a 2-of-3 setup
> and lost 1 device then without the metadata your coins are lost. In a
> future with musig(?) and miniscript increasingly the setup data is just as
> critical as the seeds.
>

How so? Each signer device should ideally have a copy of the multisig
configuration. If you lose 1 device in a 2-of-3, you can still spend from
the wallet? Unless I'm missing something here.


> A future standard (or extension of this one) should recommend an
> encryption convention for the descriptor data, ideally such that with *any*
> of the seeds you can decrypt a file that contains the full setup. That file
> could then just float redundantly around the internet and pieces of paper
> in various locations, without compromising privacy.
>

Post-wallet-creation, each Signer can apply extra encryption on top of BSMS
for the persistence of the configuration file any way it wants :) It
doesn't contradict with the current spec.


> The proposed encryption system doesn't help with that though, because it's
> based on entropy from the Coordinator, rather than from the signers.
>

They are for different purposes. The TOKEN-based encryption is only needed
temporarily for the setup.


> Smaller suggestions:
> * link to this new mail thread in the BIP
>

Will do.


> * use magic bytes so .bsms so operating systems like Android / iOs can
> open the right app for them
> * don't use separate file extensions for encrypted vs unencrypted content,
> just indicate somehow that a given field is encrypted
> * although plain text files are handy for debugging, I think a binary
> format like PSBT is much powerful. Any device that can parse and write
> binary PSBT should be able to implement a similar parser / writer for a
> binary .bsms format.
>

Will consider these points, but I prefer plaintext for wallet
configuration. Human readability for the wallet configuration is a pro not
a con IMO. Also helps when backing up.


> * BIP48 and sorted_multi descriptors are useful in a loss-of-metadata
> scenario. The BIP uses both in the examples, but doesn't explictly endorse
> these derivations. It also contradicts them: "If the Signer chooses the
> path, it should try to avoid reusing XPUBs for different wallets.". Maybe
> this is out of scope.
>    * one way to resolve xpub reuse would be to make the "BIP48" path a
> function of the co-signer fingerprints and wallet threshold, but this
> requires an extra communication round
>

We discussed this in the linked PR (
https://github.com/nunchuk-io/bips/pull/1), and decided that enforcing
against path reuse is out-of-scope. We give examples of sorted_multi and
multi because different vendors support different things.


> * there should be a way for signers to communicate their capabilities,
> perhaps with a different xpub for each potential scheme. E.g. there's m/48'
> native SegWit now, MuSig and/or or Tapleaf based multisig in the future, or
> even generic Miniscript support.
>

I considered Signers signaling capabilities (for a different reason), but
opted against it because it further complicates the scheme. Also BIP48-like
proposals are made redundant with the use of output descriptors.


> * the idea of only storing the receive descriptor, not the change
> descriptor, is fine by me, though I'd prefer an extension to the descriptor
> format to deal with this
>

That's not quite accurate. The spec stores the top-level descriptor
(XPUB/*) along with the path restrictions (/0/*,/1/*), not the receive
descriptor.

 The path restrictions would allow you to extend on the spec. There's also
a VERSION field.

Best,
Hugo


>
> Sjors
>
> > Op 5 apr. 2021, om 09:02 heeft Hugo Nguyen via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> het volgende geschreven:
> >
> > Hi all,
> >
> > Please find below the complete draft of the Bitcoin Secure Multisig
> Setup (BSMS) BIP. The spec has gone through a number of important updates
> in the last month or so. Thanks everyone who has participated in the review
> process.
> >
> > As a PR: https://github.com/bitcoin/bips/pull/1097
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210409/754162ae/attachment-0001.html>

From sjors at sprovoost.nl  Fri Apr  9 15:33:31 2021
From: sjors at sprovoost.nl (Sjors Provoost)
Date: Fri, 9 Apr 2021 17:33:31 +0200
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CAPKmR9u8zc3C7QmJYg-vg5jcutS07PK-0wdvpzCqMGLgnhHCBA@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <DDAD27D6-57F5-4B39-AADB-B28E04E36D29@sprovoost.nl>
 <CAPKmR9u8zc3C7QmJYg-vg5jcutS07PK-0wdvpzCqMGLgnhHCBA@mail.gmail.com>
Message-ID: <FF336476-DCD2-4380-83CC-584DAF7A1D72@sprovoost.nl>

Thanks for the detailed response. Just 1 thing I needed to clarify:

> To the list of concerns at the top of the BIP, I would add one: losing multisig setup context. E.g. in the event of a fire where you only recover your steel engraved mnemonic(s), but no longer have the wallet descriptors.
> 
> Good point.
> 
> 
> If you still have all devices and know (or guess) the threshold then BIP48 and sorted_multi descriptors will save you. But if you have a 2-of-3 setup and lost 1 device then without the metadata your coins are lost. In a future with musig(?) and miniscript increasingly the setup data is just as critical as the seeds.
> 
> How so? Each signer device should ideally have a copy of the multisig configuration. If you lose 1 device in a 2-of-3, you can still spend from the wallet? Unless I'm missing something here.

I was thinking about a scenario where all devices are destroyed. All you have left are the mnemonics. But indeed if at least one of your devices is still intact AND it has the configuration, you're also good.

But there are plenty of devices out there that can't do this. Those devices can still be useful, even if they can't fully check everything.

Sjors
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210409/7ec8f067/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: Message signed with OpenPGP
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210409/7ec8f067/attachment.sig>

From jlrubin at mit.edu  Fri Apr  9 15:54:39 2021
From: jlrubin at mit.edu (Jeremy)
Date: Fri, 9 Apr 2021 08:54:39 -0700
Subject: [bitcoin-dev] maximum block height on transaction
In-Reply-To: <CAMZUoKmQyV67dhWS_+t1CmqNYT490_7g3WwKgxB-jiYfje+F+Q@mail.gmail.com>
References: <5B6756D0-6BEF-4A01-BDB8-52C646916E29@friedenbach.org>
 <C623794E-F061-4C7A-B05D-378798ED2BF7@friedenbach.org>
 <201709190309.08669.luke@dashjr.org>
 <CAA2B000-6C54-4AD7-B931-43C99D615A61@friedenbach.org>
 <CAKzdR-phAarTY16BOnC95BPN0qMNEE_XZ9H-XmFeeaBc2V1U5w@mail.gmail.com>
 <3385CE20-C1BA-40DD-8FC3-8F53F3350717@friedenbach.org>
 <CAKzdR-pnvystx5H+P+OCXm73aVmWdyesCymerSgx=pCuXx+YGA@mail.gmail.com>
 <9FD4AF03-28A5-4B8A-9C12-CBCB1BC2E22C@friedenbach.org>
 <CAKzdR-r6u4J+_T5X516A=-tLWZ8zFFFsRokReiJndDE_S64OqQ@mail.gmail.com>
 <CAPg+sBi+WnzpJkcG6XACdpqqz9ZA3rHX8+H9b5eExUdgXaeiWQ@mail.gmail.com>
 <CAJowKg+kbnExgKt7H8GD6Kc-iLJEOvZhtw0uVbophhLCszvOHg@mail.gmail.com>
 <CAMZUoKmQyV67dhWS_+t1CmqNYT490_7g3WwKgxB-jiYfje+F+Q@mail.gmail.com>
Message-ID: <CAD5xwhhZpQ9AQEFHgGYvPh2ad9HyQqq9WwEZje1H1siioB6eLQ@mail.gmail.com>

You could accomplish your rough goal by having:



tx A: desired expiry at H
tx B: nlocktime H, use same inputs as A, create outputs equivalent to
inputs (have to be sure no relative timelocks)

Thus after a timeout the participants in A can cancel the action using TX B.

The difference is the coins have to move, without knowing your use case
this may or may not help you.

On Fri, Apr 9, 2021, 4:40 AM Russell O'Connor via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> From https://bitcointalk.org/index.php?topic=1786.msg22119#msg22119:
>
> We can't safely do OP_BLOCKNUMBER.  In the event of a block chain reorg
>> after a segmentation, transactions need to be able to get into the chain in
>> a later block.  The OP_BLOCKNUMBER transaction and all its dependants would
>> become invalid.  This wouldn't be fair to later owners of the coins who
>> weren't involved in the time limited transaction.
>>
>> nTimeLock does the reverse.  It's an open transaction that can be
>> replaced with new versions until the deadline.  It can't be recorded until
>> it locks.  The highest version when the deadline hits gets recorded.  It
>> could be used, for example, to write an escrow transaction that will
>> automatically permanently lock and go through unless it is revoked before
>> the deadline.  The feature isn't enabled or used yet, but the support is
>> there so it could be implemented later.
>>
>
> Unfortunately, limiting the maximum block height for a specific
> transaction would have exactly the same problem as cited above for
> OP_BLOCKNUMBER.
>
> On Fri, Apr 9, 2021 at 7:21 AM Erik Aronesty via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> is there any way to specify a maximum block height on a transaction?
>>
>> ie: this tx is only valid if included in a block with a certain height or
>> less
>>
>> i feel like this would be useful
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210409/a49670f6/attachment.html>

From bitcoinmechanicca at protonmail.com  Sat Apr 10 02:40:29 2021
From: bitcoinmechanicca at protonmail.com (BitcoinMechanic)
Date: Sat, 10 Apr 2021 02:40:29 +0000
Subject: [bitcoin-dev] Taproot activation meeting on IRC - Tuesday 13th
	April 19:00 UTC
Message-ID: <LXABjC3kHmtKvzKD0zz1rh0QxEEbCUr5bUv5A1uzu8OzJ0U3CMYG8e6i9OaXHmvIpeYTja0vN493GoC9rKV3W_MOMOuLbNWzCEdqEhGM-fs=@protonmail.com>

Taproot activation meeting on IRC - Tuesday 13th April 19:00 UTC

The focus of the meeting will be ratifying the Taproot activation plan previously discussed at the March 16th meeting (aka 2021-03 Plan Y as summarized here):

https://docs.google.com/spreadsheets/d/1K3pmH09yXLTHGV3wqFZGR3ei7QVwtdEwo0PjI2NHD3w/edit#gid=0

While there was never any consensus reached on the LOT parameter, there appears to be consensus on BIP8 and the remaining parameters, and more than sufficient support for LOT=True to proceed safely.

Miners will have 18 months in which to signal and accelerate activation. If not, taproot will activate regardless.

With a majority of the economy running this it will guarantee eventual lock-in of taproot with the smallest chance of a chain split.

As a reminder, the channel is also open for ongoing discussion 24/7, and there is a web chat client here:

https://webchat.freenode.net/?channel=##taproot-activation

Best,

Bitcoin Mechanic

Sent with [ProtonMail](https://protonmail.com/) Secure Email.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210410/397aaf20/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image1618022427865
Type: image/png
Size: 6217 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210410/397aaf20/attachment-0001.png>

From michaelfolkson at gmail.com  Sat Apr 10 12:07:40 2021
From: michaelfolkson at gmail.com (Michael Folkson)
Date: Sat, 10 Apr 2021 13:07:40 +0100
Subject: [bitcoin-dev] Update on "Speedy" Trial: The circus rolls on
In-Reply-To: <CAFvNmHSd-YJk4Sst4pSxLDfMyLw_4g+76vBfdKOJj9LgdbD-Ew@mail.gmail.com>
References: <CAFvNmHR54FCakJtaNvnwc3r6p8qhr+-e1MC2MennWm=tNZ2Unw@mail.gmail.com>
 <20210408215605.5qdcpwkay6cxyyvr@ganymede>
 <CAFvNmHSd-YJk4Sst4pSxLDfMyLw_4g+76vBfdKOJj9LgdbD-Ew@mail.gmail.com>
Message-ID: <CAFvNmHQTy+hfJHs7NvoOAOxkX0-dt6N8mg0Hj846KGr2H3mD5w@mail.gmail.com>

In my previous email in response to David Harding I said:
"I think you have consistently said it doesn't matter too much
although you did previously express a preference for block height."

This was based on:
"My preference would be for whatever solution is most preferred by
reviewers." March 7th
https://github.com/bitcoin/bitcoin/pull/21377#issuecomment-792220340

With a greater number of PR comments preferring block height at this
point I concluded that this equated to a preference for block height.
I'm happy to correct my previous statement having spoken to David.
This did not equate to a preference and David was entirely neutral.

For the sake of the mailing list (even though David didn't do so)
expressing preferences on a PR is absolutely fine. It is fine to say
"This is my preference" without NACKing a PR or NACKing a technical
decision. I (and many others) have done this. Maintainers can look
through the PR, read the rationales for the preferences and still
consider merging the PR. However, well reasoned NACKs (e.g. Concept,
Approach NACKs) make it difficult for maintainers to merge a PR
especially if they are from long term contributors. If you oscillate
from a preference one way to a full on NACK the other way to "Let's
coin flip it" with minimal rationale you are making maintainers' jobs
even more difficult. You are also wasting the time of reviewers who
don't know which PR to review and which PR stands a better chance of
being merged. You are also (unintentionally) increasing the risk of
bugs not being caught because the PR that eventually gets merged
hasn't received the review it could have.

I have been criticized on IRC for the tone of my emails. To be clear I
take Taproot activation seriously, I take the Core review process
seriously and I take keeping the community informed of the likely
timetable seriously. I'm not impressed by people wasting my time and
I'm doubly not impressed by people wasting other Core reviewers' time
and maintainers' time. If that informs my tone so be it. This is not
directed towards David who has worked hard to make progress with
Taproot activation, hasn't wasted anyone's time and I have a huge
amount of respect for.

In terms of the latest state of play with Core, there is an open Core
PR for Speedy Trial (#21377) that appears to be our best chance of
getting activation code merged into Core. The more testing and code
review this Core PR receives the better. If it continues to make
progress the discussion will then need to move onto a timetable.

On Fri, Apr 9, 2021 at 12:19 PM Michael Folkson
<michaelfolkson at gmail.com> wrote:
>
> I have no problem with coin tosses to decide for example shed colors
> (an illustrative example discussed by copumpkin, roasbeef on IRC). In
> this kind of example everyone should recognize it doesn't matter and
> Approach ACK two competing PRs. No one should be NACKing or Approach
> NACKing a PR based on shed color. If the maintainers don't care about
> the shed color either then they are free to use a coin toss to decide
> which PR to merge. In this example there shouldn't be any NACKs,
> Approach NACKs or technical opposition from regular Core reviewers.
> NACKs are not meant to be used for shed colors.
>
> However, in this example the organizer of the coin toss had previously
> NACKed one of the options (block height, though his position seems to
> change by the day) and others have NACKed MTP. I think you have
> consistently said it doesn't matter too much although you did
> previously express a preference for block height.
>
> I don't want to belabor the point but can we avoid even suggesting
> using coin tosses on consensus code decisions in future please? It
> makes a mockery of those who spent time understanding the technical
> considerations and have spent months or years working on soft fork
> activations. Even in the shed color example, leave it to the
> maintainers to decide whether a coin toss is appropriate rather than
> creating a circus around a coin toss in a public meeting where the PR
> authors weren't present and no Core maintainers were present.
>
> I understand the frustration and I understand the desire to break
> deadlocks. But if the coin toss organizer hadn't previously NACKed one
> of the options (block height) we may have avoided getting into this
> deadlock in the first place.
>
> Your recent review notes of PR #21377 look great and are proving very
> helpful to me as I look at the PR.
> https://gist.github.com/harding/e622323eaf80d620826a7cb74ab3fb40
>
> Thanks
> Michael
>
> On Thu, Apr 8, 2021 at 10:57 PM David A. Harding <dave at dtrt.org> wrote:
> >
> > On Thu, Apr 08, 2021 at 12:40:42PM +0100, Michael Folkson via bitcoin-dev wrote:
> > > So the latest circus act is apparently a technical decision made by a
> > > coin toss [organized by] Jeremy Rubin
> >
> > Actually, the coin toss was my idea[1], used a bash oneliner I wrote[2],
> > and is the same method I've been using in Bitcoin-related discussions
> > for over seven years[3] to help people transition from ancillary arguments
> > back to working on the things they really think are important.
> >
> > I proposed the coin toss because I understood that both the MTP and the
> > height approaches required tradeoffs that were, to a certain degree,
> > unresolvable to the best of our current knowledge.  MTP is harder to
> > analyze for unexpected edge cases; heights would create extra work for
> > seasoned developers working on post-taproot soft forks.  MTP would
> > require developers of currently-planned UASF software either do extra
> > work or wait to release their software; heights don't guarantee a
> > minimum amount of time for a large number of economic full nodes to
> > upgrade.
> >
> > Different people gave different weights to the different tradeoffs.  In
> > cases like this where there's no known way to eliminate the tradeoffs
> > and no way to objectively rank them, I think it's better to begin
> > working on something concrete than it is to try to persuade everyone to
> > adopt the same subjective ranking of the tradeoffs---or, as the IETF
> > published in RFC7282:
> >
> >     "There are times where the result of [an informal open-ended
> >     conversation] is a pretty even split.  In practical terms, that
> >     means it doesn't matter where the chair starts the discussion.  And
> >     in fact, we've had working groups where a coin flip decided which
> >     proposal to start with.  That doesn't mean that the coin flip
> >     determined the outcome; if a fatal technical flaw was found in the
> >     solution that won the coin flip, it is still incumbent upon the
> >     group to address the issue raised or abandon that solution and find
> >     another.  Rough consensus on the technical points, in the end, is
> >     always required.  Any way to find a place to start, be it the hum or
> >     the coin flip, is only getting to the beginning of the discussion,
> >     not the end."
> >
> > As Jeremy wrote, in this occassion, we didn't actually need the coin
> > toss.  The authors of the two PRs we were considering found a compromise
> > solution that seems to be good enough for both of them and which so far
> > seems to be good enough for the handful of people who agreed to the coin
> > toss (plus, it seems, several others who didn't agree to the toss).
> >
> > In short, I think the coin toss was a good attempt.  Although we didn't
> > use its results this time, I think it's something we should keep in our
> > toolkit for the future when a group of people want to coordinate their
> > work on getting *a* solution released, even in cases where they don't
> > necessarily start out in agreement about which solution is best.
> >
> > > I dread to think what individuals and businesses all over the world
> > > who have plans to utilize and build on Taproot are making of all of
> > > this.
> >
> > Geeks arguing over minutia is a well established stereotype.  That we've
> > conformed to that stereotype in this case is not great---but I don't
> > think it does us any significant reputational harm.  I hope those
> > individuals and businesses awaiting taproot are discerning enough to
> > realize that the method we use to activate taproot has nothing to do
> > with taproot itself.  I hope they realize that it remains the case that
> > there is nearly universal support for taproot from every entity that has
> > so far commented on it.
> >
> > Hopefully we've made progress on Speedy Trial this week, that progress
> > will continue and we'll be able to release activation-ready software
> > soon, miners will be willing to signal for taproot, and we'll soon be
> > able to end this chapter in Bitcoin's storied history of soft fork
> > activations.[4]  (But I look forward to continued discussion about
> > better activation mechanisms for the future---if taproot locks in
> > quickly, I'd love to see human consensus form around a follow-up
> > deployment even before taproot reaches activation.)
> >
> > Respectfully,
> >
> > -Dave
> >
> > [1] http://gnusha.org/taproot-activation/2021-04-04.log "<harding> [...]
> > If that's not our goal and we just want to give miners a chance to
> > activate taproot as soon as possible (which was certainly my original
> > objective in supporting ST), I'm personally happy with either MTP or
> > heights, and I'd be willing to join others in putting my effort behind
> > just one of them based on fair random chance."
> >
> > [2] http://gnusha.org/taproot-activation/2021-04-04.log "18:09 <
> > harding> e.g.:   bitcoin-cli getblockhash 123456 | cut -b64 | grep -q
> > '[02468ace]' && echo MTP || echo height"
> >
> > [3] E.g.,
> > https://github.com/bitcoin-dot-org/Bitcoin.org/pull/589#discussion_r18314009
> > and https://github.com/bitcoin-dot-org/Bitcoin.org/pull/566#issuecomment-56281595
> >
> > [4] https://bitcoinops.org/en/topics/soft-fork-activation/
>
>
>
> --
> Michael Folkson
> Email: michaelfolkson at gmail.com
> Keybase: michaelfolkson
> PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3



-- 
Michael Folkson
Email: michaelfolkson at gmail.com
Keybase: michaelfolkson
PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3

From erik at q32.com  Sat Apr 10 13:53:20 2021
From: erik at q32.com (Erik Aronesty)
Date: Sat, 10 Apr 2021 09:53:20 -0400
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
Message-ID: <CAJowKg+4KsVej3M+9mMD8Y8sYvAGAVYLOA6+4v0AXc6B78bW9g@mail.gmail.com>

here's what we do for multisig:

- each member generates their own public/private key pair first and
publishes the pair to all other members
- members are then verified using a secondary channel, like a phone
call ... where the H128(pubk) is turned into BIP-words for
manual/visual verification
- multi-round DKG is used with appropriate commitments and
verification of components  (nice article:
https://link.springer.com/content/pdf/10.1007/s00145-006-0347-3.pdf)

without that, there's simply no guarantee that you're not
communicating with an attacker during setup.

On Tue, Feb 9, 2021 at 2:53 AM Hugo Nguyen via bitcoin-dev
<bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> Hi all,
> I would like to propose a new BIP for Secure Multisig Setup.
> This proposal has taken inputs from folks at Coldcard, Shift Crypto and Cobo -- listed below as co-authors.
>
> This was inspired by my own experience working with hardware wallets on the market, as well as existing research into the challenges of multisig.
>
> Cheers,
> Hugo
>
> <pre>
>   BIP: To be determined
>   Layer: Applications
>   Title: Bitcoin Secure Multisig Setup (BSMS)
>   Author: Hugo Nguyen <hugo at nunchuk.io>, Peter Gray <peter at coinkite.com>, Marko Bencun <marko at shiftcrypto.ch>, Aaron Chen <aarondongchen at gmail.com>, Rodolfo Novak <rodolfo at coinkite.com>
>   Comments-Summary: No comments yet.
>   Comments-URI:
>   Status: Proposed
>   Type: Standards Track
>   Created: 2020-11-10
>   License: BSD-2-Clause
> </pre>
>
> ==Introduction==
>
> ===Abstract===
>
> This document proposes a mechanism to set up multisig wallets securely.
>
> ===Copyright===
>
> This BIP is licensed under the 2-clause BSD license.
>
> ===Motivation===
>
> The Bitcoin multisig experience has been greatly streamlined under [https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki BIP-0174 (Partially Signed Bitcoin Transaction)]. However, what is still missing is a standardized process for setting up multisig wallets securely across different vendors.
>
> There are a number of concerns when it comes to setting up a multisig wallet:
>
> # Whether the multisig configuration, such as Signer membership, script type, derivation paths and number of signatures required, is correct and not tampered with.
> # Whether Signer persists the multisig configuration in their respective storage, and under what format.
> # Whether Signer's storage is tamper-proof.
> # Whether Signer subsequently uses the multisig configuration to generate and verify receive and change addresses.
>
> An attacker who can modify the multisig configuration can steal or hold funds to ransom by duping the user into sending funds to the wrong address.
>
> This proposal seeks to address concerns #1 and #2: to mitigate the risk of tampering during the initial setup phase, and to define an interoperable multisig configuration format.
>
> Concerns #3 and #4 should be handled by Signers and is out of scope of this proposal.
>
> ==Specification==
>
> ===Prerequisites===
> This proposal assumes the parties in the multisig support [https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki BIP32], [https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md the descriptor language] and encryption.
>
> ==Roles==
> ===Coordinator===
>
> The Coordinator initiates the multisig setup. The Coordinator determines what type of multisig is used and how many members and signatures are needed. If encryption is enabled, the Coordinator generates a secret token, to be shared among the parties for secure communication. The Coordinator gathers information from the Signers to generate a descriptor record. The Coordinator distributes the descriptor record back to the Signers.
>
> ===Signer===
>
> The Signer is a participating member in the multisig. Its responsibilities include providing its XPUB to the Coordinator, verifying that its XPUB is included in the descriptor record and persisting the descriptor record in its storage.
>
> ==Setup Process==
>
> ===Round 1===
>
> ====Coordinator====
>
> * The Coordinator creates a multisig wallet creation session. The Coordinator determines the type of multisig script used and the signing configuration (<tt>M</tt> and <tt>N</tt>).
> * If encryption is enabled, the Coordinator also generates a secret token, hereby denoted <tt>TOKEN</tt>.
> * TOKEN is in ASCII format and must have a minimum of 8 characters. TOKEN should expire after some time period determined by the Coordinator, e.g., 24 hours.
> * TOKEN acts as an encryption key among the parties. The method of encryption is AES, CTR mode. The encryption key can be calculated by performing a double hash operation on the TOKEN: <tt>ENCRYPTION_KEY = SHA256(SHA256(TOKEN))</tt>.
> * A TOKEN value of <tt>-1</tt> means that encryption is disabled and all the encryption/decryption steps below can be skipped.
> * The Coordinator shares the TOKEN with all participating Signers over a secure channel.
>
> ====Signer====
>
> * The Signer generates a key record by prompting the user for the TOKEN and a derivation path.
> * The first line in the record must be the <tt>TOKEN</tt>. If encryption is disabled, set the TOKEN to -1. The second line must be the <tt>KEY</tt>, whereas KEY is an XPUB. KEY must include key origin information and written in the descriptor-defined format, i.e.: <tt>[{master key fingerprint}/{derivation path}]{XPUB}</tt>. The third line must be a <tt>SIG</tt>, whereas SIG is the signature generated by using the corresponding private key to sign the first two lines. Finally, the Signer encrypts the entire record with ENCRYPTION_KEY.
>
> ===Round 2===
>
> ====Coordinator====
>
> * The Coordinator gathers key records from all participating Signers. Abort the setup if TOKEN has expired.
> * For each key record, the Coordinator decrypts it using ENCRYPTION_KEY. The Coordinator verifies that the included SIG is valid given the KEY.
> * If all key records look good, the Coordinator generates a descriptor record, which is simply the descriptor string plus a <tt>CHECKSUM</tt>, all in one line. The CHECKSUM has BECH32 encoding and is described at [https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md#checksums]. The Coordinator encrypts this descriptor record with ENCRYPTION_KEY.
> * The Coordinator sends the encrypted descriptor record to all participating Signers.
>
> ====Signer====
>
> * The Signer imports the descriptor record, decrypts it by prompting the user for TOKEN.
> * The Signer calculates and verifies the descriptor?s CHECKSUM. Abort the setup if the CHECKSUM is incorrect.
> * The Signer checks whether one of the KEYs in the descriptor belongs to it, using path and fingerprint information included in the descriptor. The check must perform an exact match on the KEYs, and not using shortcuts such as matching fingerprints (which is trivial to spoof). Abort the setup if it doesn?t detect its own KEY.
> * For confirmation, the Signer must display to the user the descriptor's CHECKSUM, plus other configurations, such as M and N. The total number of Signers, N, is important to prevent a KEY insertion attack. All participating Signers should be able to display the same confirmation.
> * If all checks pass, the Signer persists the descriptor record in its storage. The Signer should subsequently use the descriptor to generate and verify receive and change addresses.
>
> This completes the setup.
>
> ==QR Codes==
> For signers that use QR codes to transmit data, key and descriptor records can be converted to QR codes, following [https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-005-ur.md the BCR standard].
>
> ==Security==
>
> This proposal introduce two layers of protection. The first one is a temporary, secret token, used to encrypt the two rounds of communication between the Signers and the Coordinator. The second one is through the descriptor checksum and visual inspection of the descriptor itself.
>
> The token is only needed during the setup phase, and can be safely thrown away afterwards. The token does not guarantee that the Signer membership set is not modified, since that depends on the overall security of all parties in the setup, but it can make it significantly harder for an attacker to do so.
>
> There are three ways an attacker can modify the membership set: by changing an existing member, by removing an existing member, or by adding a new member.
>
> For the first two methods, one of the Signers will be able to detect that its membership has been changed or removed, and reject the final descriptor. Thus, it is vital that all participating Signers check that their membership is intact in the descriptor. Even one Signer failing to check for its membership means that the setup could be compromised.
>
> For the third type of attack, the descriptor checksum and visual inspection of the descriptor itself are the only way to guard against malicious members from being inserted into the set.
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

From michaelfolkson at gmail.com  Sat Apr 10 16:06:43 2021
From: michaelfolkson at gmail.com (Michael Folkson)
Date: Sat, 10 Apr 2021 17:06:43 +0100
Subject: [bitcoin-dev] Taproot activation meeting on IRC - Tuesday 13th
 April 19:00 UTC
Message-ID: <CAFvNmHRW_pDarfatpUtebd9K0=LohBtRqpYSnNVc58rC5_c10w@mail.gmail.com>

Hi Bitcoin Mechanic

I will attend but I will be looking at Core PR #21377 over the next
couple of days and I would encourage other reviewers to review that PR
too. If that PR is merged into Core I would strongly recommend any
alternative release be fully compatible with the activation parameters
in Core.

We can discuss in the meeting what we think the cut off date should be
for when Core should no longer be a consideration. Personally I think
(and hope) we will see progress on #21377 in the coming days.

For the sake of the mailing list Bitcoin Mechanic has set up a meeting
to discuss an alternative release to Core with Taproot activation
code.

Thanks
Michael

> Taproot activation meeting on IRC - Tuesday 13th April 19:00 UTC

> The focus of the meeting will be ratifying the Taproot activation plan previously discussed at the March 16th meeting (aka 2021-03 Plan Y as summarized here):

https://docs.google.com/spreadsheets/d/1K3pmH09yXLTHGV3wqFZGR3ei7QVwtdEwo0PjI2NHD3w/edit#gid=0

> While there was never any consensus reached on the LOT parameter, there appears to be consensus on BIP8 and the remaining parameters, and more than sufficient support for LOT=True to proceed safely.

> Miners will have 18 months in which to signal and accelerate activation. If not, taproot will activate regardless.

> With a majority of the economy running this it will guarantee eventual lock-in of taproot with the smallest chance of a chain split.

> As a reminder, the channel is also open for ongoing discussion 24/7, and there is a web chat client here:

> https://webchat.freenode.net/?channel=##taproot-activation

> Best,

> Bitcoin Mechanic

> Sent with [ProtonMail](https://protonmail.com/) Secure Email.


-- 
Michael Folkson
Email: michaelfolkson at gmail.com
Keybase: michaelfolkson
PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3

From jlrubin at mit.edu  Sat Apr 10 16:59:46 2021
From: jlrubin at mit.edu (Jeremy)
Date: Sat, 10 Apr 2021 09:59:46 -0700
Subject: [bitcoin-dev] Taproot activation meeting on IRC - Tuesday 13th
 April 19:00 UTC
In-Reply-To: <CAFvNmHRW_pDarfatpUtebd9K0=LohBtRqpYSnNVc58rC5_c10w@mail.gmail.com>
References: <CAFvNmHRW_pDarfatpUtebd9K0=LohBtRqpYSnNVc58rC5_c10w@mail.gmail.com>
Message-ID: <CAD5xwhjZtEqs4ZmZQsEmUufQ3-v2esMiJberK7FR0x53To21Gw@mail.gmail.com>

I concur that reviewing #21377 is the best path at this time.

However, I want to draw attention to the middle road here:

If Core chooses to not release activation params (which has been discussed
as a general concept previously), #21377 can also be used to safely issue a
community release.

It's a false dichotomy between ST released by Core and a BIP8 UASF.
--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>


On Sat, Apr 10, 2021 at 9:48 AM Michael Folkson via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Hi Bitcoin Mechanic
>
> I will attend but I will be looking at Core PR #21377 over the next
> couple of days and I would encourage other reviewers to review that PR
> too. If that PR is merged into Core I would strongly recommend any
> alternative release be fully compatible with the activation parameters
> in Core.
>
> We can discuss in the meeting what we think the cut off date should be
> for when Core should no longer be a consideration. Personally I think
> (and hope) we will see progress on #21377 in the coming days.
>
> For the sake of the mailing list Bitcoin Mechanic has set up a meeting
> to discuss an alternative release to Core with Taproot activation
> code.
>
> Thanks
> Michael
>
> > Taproot activation meeting on IRC - Tuesday 13th April 19:00 UTC
>
> > The focus of the meeting will be ratifying the Taproot activation plan
> previously discussed at the March 16th meeting (aka 2021-03 Plan Y as
> summarized here):
>
>
> https://docs.google.com/spreadsheets/d/1K3pmH09yXLTHGV3wqFZGR3ei7QVwtdEwo0PjI2NHD3w/edit#gid=0
>
> > While there was never any consensus reached on the LOT parameter, there
> appears to be consensus on BIP8 and the remaining parameters, and more than
> sufficient support for LOT=True to proceed safely.
>
> > Miners will have 18 months in which to signal and accelerate activation.
> If not, taproot will activate regardless.
>
> > With a majority of the economy running this it will guarantee eventual
> lock-in of taproot with the smallest chance of a chain split.
>
> > As a reminder, the channel is also open for ongoing discussion 24/7, and
> there is a web chat client here:
>
> > https://webchat.freenode.net/?channel=##taproot-activation
>
> > Best,
>
> > Bitcoin Mechanic
>
> > Sent with [ProtonMail](https://protonmail.com/) Secure Email.
>
>
> --
> Michael Folkson
> Email: michaelfolkson at gmail.com
> Keybase: michaelfolkson
> PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210410/94434db8/attachment-0001.html>

From RobertSpigler at protonmail.ch  Sat Apr 10 19:32:25 2021
From: RobertSpigler at protonmail.ch (Robert Spigler)
Date: Sat, 10 Apr 2021 19:32:25 +0000
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <FF336476-DCD2-4380-83CC-584DAF7A1D72@sprovoost.nl>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <DDAD27D6-57F5-4B39-AADB-B28E04E36D29@sprovoost.nl>
 <CAPKmR9u8zc3C7QmJYg-vg5jcutS07PK-0wdvpzCqMGLgnhHCBA@mail.gmail.com>
 <FF336476-DCD2-4380-83CC-584DAF7A1D72@sprovoost.nl>
Message-ID: <5ATicbU2lYnPIDoWeZGXMtfpTZTWHhmt3g_xla1Ub7S6AIwReck_jZWQTsfRX-HB6v1I86gGnkkA5XLGKc7NWzsJMNCC2htbrHhVNFUFsKw=@protonmail.ch>

Hi Sjors,

Thanks for your comments.

>Chicken-egg problem

I agree with Hugo's detailed response here.

>Losing multisig setup context (in the event of a fire where you only recover your steel engraved mnemonic(s), but no longer have the wallet descriptors.)

Devices need to persist the descriptor, if they currently can't, they don't comply with this standard and they can't be used securely for multisig. There's no reasons the master seed and descriptor both can't be backed up outside of each device. I can't see a scenario where it would be possible to recover only the seed. (I don't know yet how Core will decide how to best backup this info, seeing as BIP39 was rejected).

>BIP48

I agree with Hugo that BIP48 is redundant with descriptors, please see https://github.com/bitcoin/bips/pull/1089 for a proposed updated hierarchy for multisignature wallets.

>An encryption convention for the descriptor data

I understand this concern. Like you mentioned previously, I too often set up multisignature wallets for clients where they are actually owned by the single party. A concern is that while the backup location owners cannot spend (due to the M-of-N restriction), they can view the wallet balance/history. As Hugo mentioned, you can apply any encryption you want after the setup, so a solution may be to use Shamir Secret Sharing (Blockchain Commons has done a lot of work on that here: https://github.com/BlockchainCommons/Airgapped-Wallet-Community/discussions/37#discussioncomment-287993)

>Plain text vs binary

I too favor plain text

Robert Spigler
Personal Fingerprint: BF0D 3C08 A439 5AC6 11C1 5395 B70B 4A77 F850 548F

??????? Original Message ???????
On Friday, April 9, 2021 11:33 AM, Sjors Provoost via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:

> Thanks for the detailed response. Just 1 thing I needed to clarify:
>
>>> To the list of concerns at the top of the BIP, I would add one: losing multisig setup context. E.g. in the event of a fire where you only recover your steel engraved mnemonic(s), but no longer have the wallet descriptors.
>>
>> Good point.
>>
>>> If you still have all devices and know (or guess) the threshold then BIP48 and sorted_multi descriptors will save you. But if you have a 2-of-3 setup and lost 1 device then without the metadata your coins are lost. In a future with musig(?) and miniscript increasingly the setup data is just as critical as the seeds.
>>
>> How so? Each signer device should ideally have a copy of the multisig configuration. If you lose 1 device in a 2-of-3, you can still spend from the wallet? Unless I'm missing something here.
>
> I was thinking about a scenario where all devices are destroyed. All you have left are the mnemonics. But indeed if at least one of your devices is still intact AND it has the configuration, you're also good.
>
> But there are plenty of devices out there that can't do this. Those devices can still be useful, even if they can't fully check everything.
>
> Sjors
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210410/83ab6a0b/attachment.html>

From michael.flaxman at protonmail.com  Sun Apr 11 02:34:21 2021
From: michael.flaxman at protonmail.com (Michael.flaxman)
Date: Sun, 11 Apr 2021 02:34:21 +0000
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
Message-ID: <s7sT6UplllXDfiCyf2HWJvEdz-1Gp9D5bvpwtAcmXEq2sRYm99FZZXJEFs-fDuhLKyxpgEvMrKa3P5OIRznxHLUqMjMIaUs-s5CGsx7zO_Q=@protonmail.com>

Hi Hugo,

I appreciate the effort you and everyone else is making to improve multisig in bitcoin!

I like that this BIP gets rid of SLIP132 version bytes, as those have been de-facto deprecated in favor of output descriptors for some time. Having a standard for how to communicate descriptor records (BSMS 1.0) also seems like a nice positive.

The most commonly raised issues from [the 10x security guide](https://btcguide.github.io/) are about how to properly verify that all hardware wallets are participants in the user's multisig quorum (and with the correct m-of-n). This shows up in two big ways:

- The O(n^2) xpub validation problem creates a bad UX and is hard for non-advanced users.
- The risk for stateless hardware wallets (like Trezor) to have their xpubs swapped out by a compromised Coordinator.

Unfortunately, this BIP does not improve either of these issues, while adding considerable complexity.

1. O(n^2) Xpub Validation

The proposed use of an output descriptor checksum has an obvious 40-bit MITM collision attack. A compromised Coordinator could trick a Signer into displaying an attacker's receive address, despite a correctly functioning Signers and the user properly validating the checksum ([github link](https://github.com/nunchuk-io/bips/pull/1/#issuecomment-801629857)).

Using a checksum with much higher entropy would reduce xpub validation to O(n) and create a very nice UX for signers. This would be a huge win for multisig! Instead, the recommended solution from the BIP is to validate all the key records manually, which is how multisig is currently done and what we desperately want to move away from. With a proper checksum, there?s no reason for a user to ever see an xpub.

Users should not be shown a checksum and asked to validate it in meatspace (across Signers) if an attacker?s address could still be substituted! Validating a single address across devices does solve this problem, but if you?re going to validate an address there?s no reason to display the checksum at all. However, validating an address is confusing to non-experts:

- Is it a wallet ID or a bitcoin address?

- Am I supposed to send funds to this address?

If creating a new checksum standard for the descriptor record is undesirable, we could use a child address (from an unhardened BIP32 path) and encode that in some way for end-users to verify it matches across all Signers. It would be strongly preferable for the encoding to be an unambiguously different format from a bitcoin address / BIP39 seed phrase, so that it?s clear it?s just a wallet ID. One non-ideal but simple solution is to use a hash function (i.e. dsha256) to calculate the digest of the child address, and display this in hexadecimal format. While hexadecimal is non-ideal for manual verification, it is already trivial for any bitcoin library to perform these steps.

2. Allow Support for Stateless Wallets

The current BIP states:

"If all checks pass, the Signer must persist the descriptor record in its storage."

While persistence has a lot of benefits, it is not a feature of the most sold multisig hardware wallet: Trezor. A simple solution here is to have each Signer sign the entire descriptor record at the end of round 2, not just its own key record in round 1. Then the data can be stored anywhere (including on the Signer itself) and played back to each Signer for validation when needed. The end-user would have no idea this was happening, but the device could refuse to display information it hasn?t fully validated (or at least add a warning message). Even a device with persistent storage would be better served using a signature, so that an evil maid couldn't tamper with the device (say in the no-encryption case for simplicity).

This existing vulnerability in stateless wallets is particularly bad for hosted multisig services like Casa/Unchained, where the service might control m-1 keys. It?s far easier for a hosted service to potentially trick non-expert users into displaying an attacker's receive address on their stateless Signer.

For example, assume the user is doing 2-of-3 multisig, where the Coordinator (service) controls 1 key. Here is how the Coordinator could trick their end-users:

- Coordinator swaps out 1 of the end-user?s xpubs, going from a 2-of-3 where the end-user has 2 seeds to a 2-of-3 where the Coordinator has 2 seeds.

- The end-user logs into the service to get a new receive address, and the service (Coordinator) displays malicious receive address X (as part of a 2-of-3).

- The end user connects stateless Signer 1 to the service (Coordinator), which under-the-hood gives stateless Signer 1 proof that it is included in this 2-of-3. Stateless singer 1 displays malicious receive address X!

- The end-user doesn't verify the address on Signer 2, as many users unfortunately don't -- perhaps it is in a far away location and the end-user (incorrectly) thinks that it?s already been validated in 2 places -- and makes a large deposit to receive address X. These funds now belong to the attacker and can be swept at any time!

If stateless Signer 1 required a signature to be replayed at step 3, stateless Signer 1 would refuse to display malicious receive address X (or at a minimum warn the end-user that it did not have enough info to properly validate the address).

This is also a concern for self-hosted multisig, I just used the hosted services as the best example.

It's also not just Trezor that is stateless. For example, I wrote [a simple CLI software multisig wallet as part of the buidl library](https://twitter.com/mflaxman/status/1321503036724989952) to be used mostly for emergency recovery. At 800 lines of code, it's too simple/minimal to touch the file system.

BIP39

While unrelated, the use of BIP39 words for session tokens seems like a big mistake, as end-users have learned over years that BIP39 words are for private key material. A small percent of users may backup their token BIP39 mnemonic and not their seed phrase BIP39 mnemonic! My suggestion is to just stick with the other two Token options: decimal and hex.

Conclusion

The main purpose/benefit of the BIP seems to be the encryption protocol. I wouldn't have strong objections if the BIP were simply renamed Bitcoin Multisig Encryption, as that more accurately reflects what it does. That said, I think this BIP is missing out on a real opportunity to improve security in setting up a multisig scheme, and if adopted in the current form will negatively impact multisig adoption.

I can't support this BIP in the current form, but I'd be happy to submit a PR if it's helpful.

Best,

Michael

https://btcguide.github.io/

??????? Original Message ???????
On Monday, April 5, 2021 2:02 AM, Hugo Nguyen via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:

> Hi all,
>
> Please find below the complete draft of the Bitcoin Secure Multisig Setup (BSMS) BIP. The spec has gone through a number of important updates in the last month or so. Thanks everyone who has participated in the review process.
>
> As a PR: https://github.com/bitcoin/bips/pull/1097
>
> A few notes:
> * PBKDF2-SHA512 was chosen instead of PBKDF2-SHA256 for the key derivation function, due to widespread existing hardware support for PBKDF2-SHA512
> * Only one descriptor is stored in the multisig configuration - this simplifies wallet setup and recovery
> (For the full review and relevant discussions, please check out https://github.com/nunchuk-io/bips/pull/1).
>
> Best,
> Hugo
>
> <pre>
>   BIP: To be determined
>   Layer: Applications
>   Title: Bitcoin Secure Multisig Setup (BSMS)
>   Author: Hugo Nguyen <hugo at
> nunchuk.io
>>, Peter Gray <peter at
> coinkite.com
>>, Marko Bencun <marko at
> shiftcrypto.ch
>>, Aaron Chen <aarondongchen at
> gmail.com
>>, Rodolfo Novak <rodolfo at
> coinkite.com
>>
>   Comments-Summary: No comments yet.
>   Comments-URI:
>   Status: Proposed
>   Type: Standards Track
>   Created: 2020-11-10
>   License: BSD-2-Clause
> </pre>
>
> ==Introduction==
>
> ===Abstract===
>
> This document proposes a mechanism to set up multisig wallets securely.
>
> ===Copyright===
>
> This BIP is licensed under the 2-clause BSD license.
>
> ===Motivation===
>
> The Bitcoin multisig experience has been greatly streamlined under [
> https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki
> BIP-0174
> (Partially Signed Bitcoin Transaction)]. However, what is still missing is a standardized process for setting up multisig wallets securely across different vendors.
>
> There are a number of concerns when it comes to setting up a multisig wallet:
>
> # Whether the multisig configuration, such as Signer membership, script type, derivation paths and number of signatures required, is correct and not tampered with.
> # Whether the keys or the multisig configuration are leaked during the setup.
> # Whether the Signer persists the multisig configuration in their respective storage, and under what format.
> # Whether the Signer's storage is tamper-proof.
> # Whether the Signer subsequently uses the multisig configuration to generate and verify receive and change addresses.
>
> An attacker who can modify the multisig configuration can steal or hold funds for ransom by duping the user into sending funds to the wrong address. An attacker who cannot modify the configuration but can learn about the keys and/or the configuration can monitor transactions in the wallet, resulting in loss of privacy.
>
> This proposal seeks to address concerns #1, #2 and #3: to mitigate the risk of tampering during the initial setup phase, and to define an interoperable multisig configuration format.
>
> Concerns #4 and #5 should be handled by Signers and are out of scope of this proposal.
>
> ==Specification==
>
> ===Prerequisites===
> This proposal assumes the parties in the multisig support [
> https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki
> BIP-0032], [
> https://github.com/bitcoin/bips/blob/master/bip-0322.mediawiki
> BIP-0322], [
> https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md
> the descriptor language] and [
> https://tools.ietf.org/html/rfc3686
> AES encryption].
>
> ===File Extension===
> All descriptor and key records should have a <tt>.bsms</tt> file extension. Encrypted data should have a <tt>.dat</tt> extension.
>
> ===Roles===
> ====Coordinator====
>
> The Coordinator initiates the multisig setup. The Coordinator determines what type of multisig is used and the exact policy script. If encryption is enabled, the Coordinator also distributes a shared secret or shared secrets to the parties involved for secure communication. The Coordinator gathers information from the Signers to generate a descriptor record. The Coordinator distributes the descriptor record back to the Signers.
>
> ====Signer====
>
> The Signer is a participating member in the multisig. Its responsibilities include providing its key record -- which contains an Extended Public Key (XPUB) -- to the Coordinator, verifying that its XPUB is included in the descriptor record and persisting the descriptor record in its storage.
>
> ===Setup Process===
>
> ====Round 1====
>
> =====Coordinator=====
>
> * The Coordinator creates a new multisig wallet creation session. The Coordinator constructs the multisig script and its policy parameters, such as the required number of signatures and the total number of Signers (<tt>M</tt> and <tt>N</tt>).
> * The session should expire after some time period determined by the Coordinator, e.g., 24 hours. The timeout allows the encryption key to have lower entropy.
> * If encryption is enabled, the Coordinator distributes a secret <tt>TOKEN</tt> to each Signer over a secure channel. The Signer can use the <tt>TOKEN</tt> to derive an <tt>ENCRYPTION_KEY</tt>. Refer to the Encryption section below for details on the <tt>TOKEN</tt>, the key derivation function and the encryption scheme. Depending on the use case, the Coordinator can decide whether to share one common <tt>TOKEN</tt> for all Signers, or to have one per Signer.
> * If encryption is disabled, the <tt>TOKEN</tt> is set to <tt>0</tt>, and all the encryption/decryption steps below can be skipped.
>
> =====Signer=====
>
> * The Signer initiates the multisig wallet creation session by setting the <tt>TOKEN</tt>. The Signer derives an <tt>ENCRYPTION_KEY</tt> from the <tt>TOKEN</tt>. The Signer can keep the session open until a different value for the <tt>TOKEN</tt> is set.
> * The Signer generates a key record by prompting the user for a multisig derivation path and retrieves the XPUB at that derivation path. Alternatively, the Signer can choose a path on behalf of the user. If the Signer chooses the path, it should try to avoid reusing XPUBs for different wallets.
> * The first line in the record must be the specification version (<tt>BSMS 1.0</tt> as of this writing). The second line must be the hex-encoded <tt>TOKEN</tt>. The third line must be the <tt>KEY</tt>. The <tt>KEY</tt> is an XPUB plus its key origin information, written in the descriptor-defined format, i.e.: <tt>[{master key fingerprint}/{derivation path}]{XPUB}</tt>. The fourth line is a text description of the key, 80 characters maximum. The fifth line must be a <tt>SIG</tt>, whereas <tt>SIG</tt> is the signature generated by using the private key associated with the XPUB to sign the first four lines. The signature should follow [
> https://github.com/bitcoin/bips/blob/master/bip-0322.mediawiki
> BIP-0322], legacy format accepted.
> * The Signer calculates the Message Authentication Code (<tt>MAC</tt>) for the record. The first 16 bytes of the <tt>MAC</tt> serves as the Initialization Vector (<tt>IV</tt>) for the encryption.
> * The Signer encrypts the key record with the <tt>ENCRYPTION_KEY</tt> and <tt>IV</tt>.
> * The Signer encodes the <tt>MAC</tt> and the ciphertext into hexadecimal format, then concatenates the results: <tt>(MAC || ciphertext)</tt>.
>
> ====Round 2====
>
> =====Coordinator=====
>
> * The Coordinator gathers key records from all participating Signers. The Coordinator verifies that there are exactly <tt>N</tt> unique key records before the wallet setup session expires.
> * For each key record, the Coordinator extracts the <tt>MAC</tt> from the data, sets <tt>IV</tt> to the first 16 bytes of the <tt>MAC</tt>, then decrypts the ciphertext using the <tt>ENCRYPTION_KEY</tt> and <tt>IV</tt>.
> * The Coordinator verifies that the included <tt>MAC</tt> is valid given the plaintext.
> * The Coordinator verifies that the key records have compatible specification versions.
> * The Coordinator verifies that the included <tt>SIG</tt> is valid given the <tt>KEY</tt>.
> * If all key records look good, the Coordinator fills in all necessary information to generate a descriptor record.
> * The first line in the descriptor record must be the specification version (<tt>BSMS 1.0</tt> as of this writing). The second line must be a comma-separated list of accepted derivation paths that the Signers can use to generate addresses from the included XPUBs. The paths must start with <tt>/</tt> and use non-hardened derivation. For example, <tt>/0/*</tt> and <tt>/1/*</tt> are some common paths. If there are no restrictions, it must say <tt>No path restrictions</tt>. The third line must be the descriptor string plus a <tt>CHECKSUM</tt>, all in one line. The <tt>CHECKSUM</tt> has [
> https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md#checksums
> BECH32 encoding].
> * The Coordinator calculates the <tt>MAC</tt> for the record. The first 16 bytes of the <tt>MAC</tt> serves as the <tt>IV</tt> for the encryption..
> * The Coordinator encrypts the descriptor record with the <tt>ENCRYPTION_KEY</tt> and <tt>IV</tt>.
> * The Coordinator encodes the <tt>MAC</tt> and the ciphertext into hexadecimal format, then concatenates the results: <tt>(MAC || ciphertext)</tt>.
> * The Coordinator sends the encrypted descriptor record to all participating Signers.
>
> =====Signer=====
>
> * The Signer imports the descriptor record.
> * The Signer extracts the <tt>MAC</tt> from the data, sets <tt>IV</tt> to the first 16 bytes of the <tt>MAC</tt>, then decrypts the ciphertext using the <tt>ENCRYPTION_KEY</tt> (derived from the open session) and <tt>IV</tt>.
> * The Signer verifies that the included <tt>MAC</tt> is valid given the plaintext.
> * The Signer verifies that it can support the included specification version.
> * The Signer verifies that it is compatible with the derivation path restrictions.
> * The Signer verifies the descriptor?s <tt>CHECKSUM</tt>.
> * The Signer verifies that it can support the descriptor.
> * The Signer checks that its <tt>KEY</tt> is included in the descriptor, using path and fingerprint information provided. The check must perform an exact match on the <tt>KEY</tt>s and not using shortcuts such as matching fingerprints, which is trivial to spoof.
> * For confirmation, the Signer must display to the user the <tt>CHECKSUM</tt>, the derivation path restrictions and the policy parameters, such as <tt>M</tt>, <tt>N</tt> and the position(s) of its own XPUB in the policy script. The total number of Signers, <tt>N</tt>, is important to prevent a <tt>KEY</tt> insertion attack. The position is important for scripts where key order matters. When applicable, all positions of the XPUB must be displayed. The full descriptor must also be available for review upon user request.
> * When possible, the Signer should also show a preview of the first address(es) of the wallet.
> * Parties must check with each other that all Signers have verified the descriptor and has the same confirmation (except for the key positions).
> * If all checks pass, the Signer must persist the descriptor record in its storage.
>
> This completes the setup.
>
> ===Encryption===
>
> ====The Token====
> We define three modes of encryption.
>
> # <tt>NO_ENCRYPTION</tt> : the <tt>TOKEN</tt> is set to <tt>0</tt>. Encryption is disabled.
> # <tt>STANDARD</tt> : the <tt>TOKEN</tt> is a 64-bit nonce.
> # <tt>EXTENDED</tt> : the <tt>TOKEN</tt> is a 96-bit nonce.
>
> The <tt>TOKEN</tt> can be converted to one of these formats:
> * A decimal number (recommended). The number must not exceed the maximum value of the nonce.
> * A mnemonic phrase using [
> https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki
> BIP-0039] word list (6 words in <tt>STANDARD</tt> mode; 9 words in <tt>EXTENDED</tt> mode).
> * A QR code.
> * Other formats.
>
> The flexibility in the data format allows each Signer to customize the User Experience based on its respective capabilities.
>
> ====Key Derivation====
> The key derivation function is [
> https://tools.ietf.org/html/rfc2898
> PBKDF2], with PRF = SHA512. Specifically:
>
> <tt>DKey = PBKDF2(PRF, Password, Salt, c, dkLen)</tt>
>
> Whereas:
>
> * PRF = SHA512
> * Password = "No SPOF"
> * Salt = <tt>TOKEN</tt>
> * c = 2048
> * dkLen = 256
> * DKey = Derived <tt>ENCRYPTION_KEY</tt>
>
> ====Encryption Scheme====
> The encryption scheme is [
> https://tools.ietf.org/html/rfc3686
> AES-256-CTR].
>
> <tt>MAC = HMAC-SHA256(HMAC_Key, hex-encoded TOKEN || Data)</tt>
>
> <tt>IV = First 16 bytes of MAC</tt>
>
> <tt>Ciphertext = AES-256-CTR-Encrypt(Plaintext, DKey, IV)</tt>
>
> <tt>Plaintext = AES-256-CTR-Decrypt(Ciphertext, DKey, IV)</tt>
>
> Whereas:
> * DKey = <tt>ENCRYPTION_KEY</tt>
> * HMAC_Key = SHA256(<tt>ENCRYPTION_KEY</tt>)
> * Data = the plaintext, e.g. the entire key record in round 1 and the entire descriptor record in round 2
>
> The <tt>MAC</tt> is to be sent along with the key and descriptor record, as specified above. Because it is a <tt>MAC</tt> over the entire plaintext, this is essentially an [
> https://en.wikipedia.org/wiki/Authenticated_encryption#Encrypt-and-MAC_(E&M)
> Encrypt-and-MAC] form of authenticated encryption.
>
> ==QR Codes==
> For signers that use QR codes to transmit data, key and descriptor records can be converted to QR codes, following [
> https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-005-ur.md
> the BCR standard].
>
> Also refer to [
> https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-015-account.md
> UR Type Definition for BIP44 Accounts] and [
> https://github.com/BlockchainCommons/Research/blob/master/papers/bcr-2020-010-output-desc.md
> UR Type Definition for Bitcoin Output Descriptors] for more details.
>
> ==Security==
>
> This proposal introduces two layers of protection. The first one is a temporary, secret <tt>TOKEN</tt>. The second one is the descriptor <tt>CHECKSUM</tt>.
>
> The <tt>TOKEN</tt> is used to encrypt the two rounds of communication between the Signer and the Coordinator. A <tt>MAC</tt> is also generated from the <tt>TOKEN</tt> and plaintext to authenticate the data being exchanged. The <tt>TOKEN</tt> is only needed during the setup phase, and can be safely discarded afterwards.
>
> The descriptor <tt>CHECKSUM</tt>, on the other hand, can be used to verify the integrity of the multisig configuration. An attacker who tampers with the multisig configuration must also change the descriptor <tt>CHECKSUM</tt>. Parties must check with each other that all Signers have the same <tt>CHECKSUM</tt>, along with the policy parameters, to reduce the chance of tampering. The <tt>CHECKSUM</tt> must be persisted along with the descriptor in each Signer?s storage.
>
> The <tt>TOKEN</tt> and the <tt>CHECKSUM</tt> can?t guarantee complete protection, since that depends on the overall security of all parties in the setup, but they can make it significantly harder for an attacker to tamper with the multisig configuration.
>
> ==Privacy==
> Encryption helps improve the privacy of the wallet by avoiding sharing XPUBs and descriptors in plaintext.
>
> If the parties wish to have stronger privacy, it is recommended to use a higher number of bits for the <tt>TOKEN</tt>, and to completely erase knowledge of the <tt>TOKEN</tt> after the multisig wallet has been set up.
>
> ==Test Vectors==
>
> ===Mode: <tt>NO_ENCRYPTION</tt>===
> ====ROUND 1====
> * Coordinator
> ** M-of-N: 2/2
> ** ADDRESS_TYPE: NATIVE_SEGWIT
> ** TOKEN: 0
>
> * Signer 1
> ** MASTER_KEY_FINGERPRINT: 539f3d89
> ** PRIVATE_KEY (m/48'/0'/0'/2'): KyoXqiwiz6qm21BSYebiZFfNF7obkhiJW6TdPMZTQQMF4kZtfD78
> ** XPUB (m/48'/0'/0'/2'): xpub6ETerig7tq89mtaD8Gau2xRWxouRMBy6XHqciA8GZzC2dJv3w6FxfgoegH4b2qYF4oG6VBrhpLrauPs5E1q58GLCnhKp6g9QsV9ZA7J5JNa
> ** Legacy signature
> ** <tt>signer_1_key.bsms</tt>:
> <pre>BSMS 1.0
> 00
> [539f3d89/48'/0'/0'/2']xpub6ETerig7tq89mtaD8Gau2xRWxouRMBy6XHqciA8GZzC2dJv3w6FxfgoegH4b2qYF4oG6VBrhpLrauPs5E1q58GLCnhKp6g9QsV9ZA7J5JNa
> Signer 1 key
> IPXsnNSZb8M6H4fAWtpjAc75hyHHd89fskpM5o7qFg+mPDzEPc1k2mjuIpVIIzaCe45FwPfAAa91RaStfC5Sak0=</pre>
>
> * Signer 2
> ** MASTER_KEY_FINGERPRINT: f8b12aa6
> ** PRIVATE_KEY (m/48'/0'/0'/2'): L1zht7muKnUYFMdzC3jwXd78u8tGoKr46AXGh4waF9nphUYWq7ow
> ** XPUB (m/48'/0'/0'/2'): xpub6EWPNhGSX86SN4J2DrBUaQ826o6V4egHqAJZUDJqnsthv9CcjBZV79u68M3YZkuTJnJBXfCrHuJy97fkVurntwgt3V7Ms5hXpJV2vS8fQZM
> ** Legacy signature
> ** <tt>signer_2_key.bsms</tt>:
> <pre>BSMS 1.0
> 00
> [f8b12aa6/48'/0'/0'/2']xpub6EWPNhGSX86SN4J2DrBUaQ826o6V4egHqAJZUDJqnsthv9CcjBZV79u68M3YZkuTJnJBXfCrHuJy97fkVurntwgt3V7Ms5hXpJV2vS8fQZM
> Signer 2 key
> H38+lp9iaesBeCN05BDTH/SnmarlH6+X+Kmw1pgCk+c1Pc1evYIdBag9Nc0nsKhvPtfEbRt9r/qsUVZ5onCtBTc=</pre>
>
> ====ROUND 2====
> * Coordinator
> ** <tt>my_multisig_wallet.bsms</tt>:
> <pre>BSMS 1.0
> /0/*,/1/*
> wsh(sortedmulti(2,[539f3d89/48'/0'/0'/2']xpub6ETerig7tq89mtaD8Gau2xRWxouRMBy6XHqciA8GZzC2dJv3w6FxfgoegH4b2qYF4oG6VBrhpLrauPs5E1q58GLCnhKp6g9QsV9ZA7J5JNa/*,[f8b12aa6/48'/0'/0'/2']xpub6EWPNhGSX86SN4J2DrBUaQ826o6V4egHqAJZUDJqnsthv9CcjBZV79u68M3YZkuTJnJBXfCrHuJy97fkVurntwgt3V7Ms5hXpJV2vS8fQZM/*))#fntxdj7p</pre>
>
> ===Mode: <tt>STANDARD</tt> Encryption===
> ====ROUND 1====
> * Coordinator
> ** M-of-N: 2/2
> ** ADDRESS_TYPE: NATIVE_SEGWIT
> ** TOKEN (hex): 1ed4ba49e96336b8
> *** TOKEN (decimal): 2221605342811469496
> *** TOKEN (mnemonic): burst place mystery spot cricket foster
> ** ENCRYPTION_KEY (hex): 72185a0e25b4efc5d6ac0f8ed32b0165199100e32385040e3a48eb30164bf492
>
> * Signer 1
> ** MASTER_KEY_FINGERPRINT: 98d79e95
> ** PRIVATE_KEY (m/48'/0'/0'/2'): KydC7hZFtWe56oQUAw14HvQ3gKeKVd3m8frFgVMxUqpuhKHvcmm3
> ** XPUB (m/48'/0'/0'/2'): xpub6DvvwHS5pd1D36xt4YBGJvtdThWXfn8L9qRj9DbFMExMeP6eBE6Aw9WyBC7XUQwiPPDFurirewsKZpYv68yTV5RBy7SZmw45QEkaLka5BCt
> ** Legacy signature
> ** <tt>signer_1_key.bsms</tt>:
> <pre>BSMS 1.0
> 1ed4ba49e96336b8
> [98d79e95/48'/0'/0'/2']xpub6DvvwHS5pd1D36xt4YBGJvtdThWXfn8L9qRj9DbFMExMeP6eBE6Aw9WyBC7XUQwiPPDFurirewsKZpYv68yTV5RBy7SZmw45QEkaLka5BCt
> Signer 1 key
> HxtPoP0DrQSac/7ypcwC07R2s6jjpXR6Li2Q92zXj/FSIMQcV5yOU0/ONsDgHXamq0gD5DfPbvuVCp9ZJubclV4=</pre>
>
> * Signer 1 encryption
> ** HMAC_KEY (hex): 4dab3988cbc683ad7a8c93d43f9b11a78b63a93d5e33ea19c603f4b7b87ac284
> ** MAC (hex): afe99e92f0eadc3308eb990045e90a4f54e9f59d22aae5034ac3d866d29c508d
> ** IV (hex) : afe99e92f0eadc3308eb990045e90a4f
> ** CIPHERTEXT (hex): 214ec9a861a238ba7f0412305a97a6e0faa332be15af09127e131d669e5d55d73891580a5808cea5d2bf39f43496d3c0f8236eff3854fcc7446daf9d2b58fd40d97ce3b1745de2959e29767039b99969821400eca0c3517fae56d2d24d5235a3430af1ed894b68681d706cce7c75adf35d8580603aa302bc01fef06d0336a37f19dd46100baa9e4eabd8796a810e13941ad0980c126ad55d6a4bbef11a7bf893b7d2ed8fb0d8324c4c9b512d4d1e75096c63511e15018fc832816b5639d58fc28c60c049487d04bd5a6cb32aa1381d0809660d54376b9f63325c18cfd1ac5024088e74cb703fe165972cc4485abb1feefe92a0b4ea297fe2f4f7416eeee1efc9b942540931ef
> ** <tt>signer_1_key.dat</tt>: <pre>afe99e92f0eadc3308eb990045e90a4f54e9f59d22aae5034ac3d866d29c508d214ec9a861a238ba7f0412305a97a6e0faa332be15af09127e131d669e5d55d73891580a5808cea5d2bf39f43496d3c0f8236eff3854fcc7446daf9d2b58fd40d97ce3b1745de2959e29767039b99969821400eca0c3517fae56d2d24d5235a3430af1ed894b68681d706cce7c75adf35d8580603aa302bc01fef06d0336a37f19dd46100baa9e4eabd8796a810e13941ad0980c126ad55d6a4bbef11a7bf893b7d2ed8fb0d8324c4c9b512d4d1e75096c63511e15018fc832816b5639d58fc28c60c049487d04bd5a6cb32aa1381d0809660d54376b9f63325c18cfd1ac5024088e74cb703fe165972cc4485abb1feefe92a0b4ea297fe2f4f7416eeee1efc9b942540931ef</pre>
>
> * Signer 2
> ** MASTER_KEY_FINGERPRINT: 3e94b5a1
> ** PRIVATE_KEY (m/48'/0'/0'/2'): KyPh5XYjExjNHPiBjYhp8iAntAehrDziiwRv7y9Ln6eK9QU2xP55
> ** XPUB (m/48'/0'/0'/2'): xpub6E1W1DUYY29V2b8czCcpi36GG2uD33B11vwNopgTZwsVyfgAkA4kPCqLP5R4YzaRvzW17CQrDkgmDQbA848AdkR7W18nNvMKXzzCBSnZP9c
> ** Legacy signature
> ** <tt>signer_2_key.bsms</tt>:
> <pre>BSMS 1.0
> 1ed4ba49e96336b8
> [3e94b5a1/48'/0'/0'/2']xpub6E1W1DUYY29V2b8czCcpi36GG2uD33B11vwNopgTZwsVyfgAkA4kPCqLP5R4YzaRvzW17CQrDkgmDQbA848AdkR7W18nNvMKXzzCBSnZP9c
> Signer 2 key
> ILR49QLy9+xkMS11TIXJRSMgOQOzGbAaooq4/ZRcd8VgM6j5upJMI0mjJHseQOMYSGk8FqjXZbMvBGyiX9wdutM=</pre>
>
> * Signer 2 encryption
> ** HMAC_KEY (hex): 4dab3988cbc683ad7a8c93d43f9b11a78b63a93d5e33ea19c603f4b7b87ac284
> ** MAC (hex): 5c7cb2ac407cd60b1f2b86ef46077d3a312b6ce921df2a141347e8bf1e5c6573
> ** IV (hex) : 5c7cb2ac407cd60b1f2b86ef46077d3a
> ** CIPHERTEXT (hex): f23e6c76ff45d308dea6014030a274127ad437228f1d5ec2431d2ea9e3cedd5b0a207a9efa6f926d5420205003f3cb9c4b82b2d595180e62a173a2e5aa0322de48a70a873f641bdae1764e6b1667c241e0fe03a4ccdc3fe0cfa5f75b239d6497c3b69dca17bb685ba70b307d1243836d8fb198ce727cfae4057ee0b4fdcb09f4ba5ae127f49c5de780edb4e40aec96303c8a7b98b1b8e53dd5e07e01d4f3ffd836763209a1f0cbc61adcfdc2951e77528ee7b6e68114c3a4bec38875d285021e68ae8aa913bb1e2e65dd52c649a0e98bfb4e8bab6dd10295c1167a0854ba44f094feb75d2fb00c944f07d4b47114f483df9838459316f3ddbc4a82e6507881931f8e20f5b805
> ** <tt>signer_2_key.dat</tt>: <pre>5c7cb2ac407cd60b1f2b86ef46077d3a312b6ce921df2a141347e8bf1e5c6573f23e6c76ff45d308dea6014030a274127ad437228f1d5ec2431d2ea9e3cedd5b0a207a9efa6f926d5420205003f3cb9c4b82b2d595180e62a173a2e5aa0322de48a70a873f641bdae1764e6b1667c241e0fe03a4ccdc3fe0cfa5f75b239d6497c3b69dca17bb685ba70b307d1243836d8fb198ce727cfae4057ee0b4fdcb09f4ba5ae127f49c5de780edb4e40aec96303c8a7b98b1b8e53dd5e07e01d4f3ffd836763209a1f0cbc61adcfdc2951e77528ee7b6e68114c3a4bec38875d285021e68ae8aa913bb1e2e65dd52c649a0e98bfb4e8bab6dd10295c1167a0854ba44f094feb75d2fb00c944f07d4b47114f483df9838459316f3ddbc4a82e6507881931f8e20f5b805</pre>
>
> ====ROUND 2====
> *Coordinator
> ** <tt>my_multisig_wallet.bsms</tt>:
> <pre>BSMS 1.0
> /0/*,/1/*
> wsh(sortedmulti(2,[98d79e95/48'/0'/0'/2']xpub6DvvwHS5pd1D36xt4YBGJvtdThWXfn8L9qRj9DbFMExMeP6eBE6Aw9WyBC7XUQwiPPDFurirewsKZpYv68yTV5RBy7SZmw45QEkaLka5BCt/*,[3e94b5a1/48'/0'/0'/2']xpub6E1W1DUYY29V2b8czCcpi36GG2uD33B11vwNopgTZwsVyfgAkA4kPCqLP5R4YzaRvzW17CQrDkgmDQbA848AdkR7W18nNvMKXzzCBSnZP9c/*))#x0lx92qk</pre>
>
> *Coordinator encryption
> ** HMAC_KEY (hex): 4dab3988cbc683ad7a8c93d43f9b11a78b63a93d5e33ea19c603f4b7b87ac284
> ** MAC (hex): df3d06db6c8b8a5f25de202e10ea225df6415d1ed0e36c64cc2be1b7e86c2a38
> ** IV (hex) : df3d06db6c8b8a5f25de202e10ea225d
> ** CIPHERTEXT (hex): 2761e6bfe839586b4c90954200bc4ce6d39ef164c5d14997755575d1691ee249ffd20beda526f57a7424907f839c6c2e3ecd46889ede290a2c81de22d3f33a7fa5e55ec95c0e26005c596d0f6346f819823f361f9f9f54d1eae48b325240d66c5888bd5ebab843061dcdd73b675346da982646c83026694d757661d31c2d654fb263c9ab3e874a258bc234c48532f15e9450c982fcf161404746e9f23d25e17b74139cd799983fd0c7a7a0386a823d3789b4578879a764172cc8ef96ab003eee24f6288007d31e2b999aff5a6d30cc524a0111a99730a29cf28ae41dbff6ce21ca6bc1df37074228178048e835584e6e70dba941154d024cd03cb6c56d0bde441ce464aa749de5e814dd30e21b75f62e831ac1f28eda1a7ba7e122076789e284402c8ba85b5a0e864bce220e3c78fa2f465e2bcf6b1d378816319de99f99ce7068
> ** <tt>my_multisig_wallet.dat</tt>: <pre>df3d06db6c8b8a5f25de202e10ea225df6415d1ed0e36c64cc2be1b7e86c2a382761e6bfe839586b4c90954200bc4ce6d39ef164c5d14997755575d1691ee249ffd20beda526f57a7424907f839c6c2e3ecd46889ede290a2c81de22d3f33a7fa5e55ec95c0e26005c596d0f6346f819823f361f9f9f54d1eae48b325240d66c5888bd5ebab843061dcdd73b675346da982646c83026694d757661d31c2d654fb263c9ab3e874a258bc234c48532f15e9450c982fcf161404746e9f23d25e17b74139cd799983fd0c7a7a0386a823d3789b4578879a764172cc8ef96ab003eee24f6288007d31e2b999aff5a6d30cc524a0111a99730a29cf28ae41dbff6ce21ca6bc1df37074228178048e835584e6e70dba941154d024cd03cb6c56d0bde441ce464aa749de5e814dd30e21b75f62e831ac1f28eda1a7ba7e122076789e284402c8ba85b5a0e864bce220e3c78fa2f465e2bcf6b1d378816319de99f99ce7068</pre>
>
> ===Mode: <tt>EXTENDED</tt> Encryption===
> ====ROUND 1====
> *Coordinator
> ** M-of-N: 2/3
> ** ADDRESS_TYPE: NESTED_SEGWIT
> ** TOKEN for Signer 1 (hex): 654d63309464afcda558c6aa
> *** TOKEN (decimal): 31351541690484562733651510954
> *** TOKEN (mnemonic): grab help slow churn enough traffic nice boat price
> *** ENCRYPTION_KEY (hex): 4073adac2351e164b8d68039abd9d4b8e4d07adccfdf73ece6e236d60b107802
> ** TOKEN for Signer 2 (hex): b0344f51d5cb04083d598fa3
> *** TOKEN (decimal): 54532600447720520868878192547
> *** TOKEN (mnemonic): rabbit pen stamp process raccoon advice voice cradle person
> *** ENCRYPTION_KEY (hex): 6bae6b670e257d7468c3e90194029dd468a2f39d8b9a3ff187b08209b1d409b6
> ** TOKEN for Signer 3 (hex): 163fd307195982c4c39d50bb
> *** TOKEN (decimal): 6885829092987042066541138107
> *** TOKEN (mnemonic): bike write scrub crawl oblige give attack present rookie
> *** ENCRYPTION_KEY (hex): c78b94589214b6dc98b337ba4ce54380553ed00a1e5b1955fc540ce3b30d6566
>
> * Signer 1
> ** MASTER_KEY_FINGERPRINT: 110dc257
> ** PRIVATE_KEY (m/48'/0'/0'/1'): KzshDDEBhzyiwXHoyE7ZiLegzztEy54AG6Wq8N844LqHSQMHt4Ji
> ** XPUB (m/48'/0'/0'/1'): xpub6EPQbDFezXYvVFHqnc8R7QUSE8hTepbyCXU7jJBT4dVm2rQHe1i6isqoj59qhyBiCdKquo6QsgMZNHvEz3BM4cNSszF25siTqLUCznBm8vk
> ** Legacy signature
> ** <tt>signer_1_key.bsms</tt>:
> <pre>BSMS 1.0
> 654d63309464afcda558c6aa
> [110dc257/48'/0'/0'/1']xpub6EPQbDFezXYvVFHqnc8R7QUSE8hTepbyCXU7jJBT4dVm2rQHe1i6isqoj59qhyBiCdKquo6QsgMZNHvEz3BM4cNSszF25siTqLUCznBm8vk
> Signer 1 key
> IDX6xLdM4XjetYPvVfpVBXAfT7oE3tHAOB4blZpbIst8bjJ+LbDeP4tZl4O8utAuys9igXE0G3kaHz1mg/+OU8w=</pre>
>
> * Signer 1 encryption
> ** HMAC_KEY (hex): f43c359a4b3d7b2e01be73c54519b12545ca9a23a86f824aadf577b314a7caa7
> ** MAC (hex): 40b6b43e2f1bc01b748eb242235d7e09fa8a2fd6cebe35784cf3adf81910ec98
> ** IV (hex) : 40b6b43e2f1bc01b748eb242235d7e09
> ** CIPHERTEXT (hex): 0877987764401c27e6c60ed2f1bb89dff1dbc5e8204149f682d53049bffe39553f24af3928aa2f78ac2d04ac5baa0c3ec39aaccf0d258e7bb6659a7b92e92f2c2784a94f4df8e8af2270d9d411bfff2cfb9f71b4e1ac87561c7d2ac57ca86a1f9716d5da7571719d24830fc8d015a0daf04b3742439484488798335357f2eeaa8e2db2ba630f9dffd88236e327ab5bfcfb6e29ee3ef6cc18e0b71c1731465c2351e76b92f7b1bd28ef6eff5414c22aa6c80090fa59b973c22e3044e92dbf3688990a49a42828e52c1e686f1193dcdf7b7118930e01419fe938c6811c58c84c36d692fd52846f998bc328471f1e73c22261791a08cda096ee3ac8b37f31afd0b1d9c335ff9ac67ff230eb0d69f2d7
> ** <tt>signer_1_key.dat</tt>: <pre>40b6b43e2f1bc01b748eb242235d7e09fa8a2fd6cebe35784cf3adf81910ec980877987764401c27e6c60ed2f1bb89dff1dbc5e8204149f682d53049bffe39553f24af3928aa2f78ac2d04ac5baa0c3ec39aaccf0d258e7bb6659a7b92e92f2c2784a94f4df8e8af2270d9d411bfff2cfb9f71b4e1ac87561c7d2ac57ca86a1f9716d5da7571719d24830fc8d015a0daf04b3742439484488798335357f2eeaa8e2db2ba630f9dffd88236e327ab5bfcfb6e29ee3ef6cc18e0b71c1731465c2351e76b92f7b1bd28ef6eff5414c22aa6c80090fa59b973c22e3044e92dbf3688990a49a42828e52c1e686f1193dcdf7b7118930e01419fe938c6811c58c84c36d692fd52846f998bc328471f1e73c22261791a08cda096ee3ac8b37f31afd0b1d9c335ff9ac67ff230eb0d69f2d7</pre>
>
> * Signer 2
> ** MASTER_KEY_FINGERPRINT: 5c890401
> ** PRIVATE_KEY (m/48'/0'/0'/1'): L41Jnc9CdBtBJd18429MDGcTgP2DNoXaKyyGr271ndTprvrHXDQf
> ** XPUB (m/48'/0'/0'/1'): xpub6EW1SmjSXq9YwVwcan5qWEncgx89SozMvGNpYF6hfZHYNTikNZ4gsXuVhHTi6xYJCkmY4X4wpPPS5Gr7aY39dVJMS2TGfihr25oaspKtU8q
> ** Legacy signature
> ** <tt>signer_2_key.bsms</tt>:
> <pre>BSMS 1.0
> b0344f51d5cb04083d598fa3
> [5c890401/48'/0'/0'/1']xpub6EW1SmjSXq9YwVwcan5qWEncgx89SozMvGNpYF6hfZHYNTikNZ4gsXuVhHTi6xYJCkmY4X4wpPPS5Gr7aY39dVJMS2TGfihr25oaspKtU8q
> Signer 2 key
> H5kN6UHaK2xACB6iYdTxxQPD8qyFEYv9iMsQs5B0MRfCM7NA5GB+7EFgmBpSctwt6B122zWBr6mRjpYjKmj+7hs=</pre>
>
> * Signer 2 encryption
> ** HMAC_KEY (hex): e0a20b5f5285fbaa35aad08fb70f5626c9abbe1b384a4950735b28aca6325ff2
> ** MAC (hex): 3a6deec8dbdbd6606a52c7d7e64eca4f972a293cbabac6f62736629fbe77928a
> ** IV (hex) : 3a6deec8dbdbd6606a52c7d7e64eca4f
> ** CIPHERTEXT (hex): bb0fb72f61b0c4858bd9c65235390b67651b94c4b0329238b0116dd6d3365ade33cb1c1b1619638968791a5d2d1d263d90280bdad8d9ca24c34a78e320076e0dccf59e7f729b541b44bbe40ba803dedd3b17c49765377cb2d913a856b86c3dd383dab475790e89226ed8ef2301574212d2809ed9c099aa67be434024ee2a4e82a146300acf755863da64807cb7bb2636f6616489636d254a870778d3540832aea44abac4328b5d90f3e6045ef36a526ce5d575f2305e3e4699dccbc713e9e68f50364036c1054c2a506aab77ea7c43a89536947c24330b09a62a90c3b4ae2d452f96ef34ec871af2c52d68ddede2503c87e2ba68d5cf9be589457879e06021ea6a6176f7dded820ba4c0e709e2a2
> ** <tt>signer_2_key.dat</tt>: <pre>3a6deec8dbdbd6606a52c7d7e64eca4f972a293cbabac6f62736629fbe77928abb0fb72f61b0c4858bd9c65235390b67651b94c4b0329238b0116dd6d3365ade33cb1c1b1619638968791a5d2d1d263d90280bdad8d9ca24c34a78e320076e0dccf59e7f729b541b44bbe40ba803dedd3b17c49765377cb2d913a856b86c3dd383dab475790e89226ed8ef2301574212d2809ed9c099aa67be434024ee2a4e82a146300acf755863da64807cb7bb2636f6616489636d254a870778d3540832aea44abac4328b5d90f3e6045ef36a526ce5d575f2305e3e4699dccbc713e9e68f50364036c1054c2a506aab77ea7c43a89536947c24330b09a62a90c3b4ae2d452f96ef34ec871af2c52d68ddede2503c87e2ba68d5cf9be589457879e06021ea6a6176f7dded820ba4c0e709e2a2</pre>
>
> * Signer 3
> ** MASTER_KEY_FINGERPRINT: 614cbf5f
> ** PRIVATE_KEY (m/48'/0'/0'/1'): L2ccRLzH7GfVxWpU8YSY9y5UGyRoqW3UdeNT1vGfVbxAGhwU5qhD
> ** XPUB (m/48'/0'/0'/1'): xpub6F9TfWTFcMYy5Ycd2ka2az1brJj78J2isLAWptZnCpFsesss5sZv5B8xsgt71ZXfhDWhUtf4vng4zY6HUVrQbDMPDYRLYvFFoLnAYfzgYPH
> ** Legacy signature
> ** <tt>signer_3_key.bsms</tt>:
> <pre>BSMS 1.0
> 163fd307195982c4c39d50bb
> [614cbf5f/48'/0'/0'/1']xpub6F9TfWTFcMYy5Ycd2ka2az1brJj78J2isLAWptZnCpFsesss5sZv5B8xsgt71ZXfhDWhUtf4vng4zY6HUVrQbDMPDYRLYvFFoLnAYfzgYPH
> Signer 3 key
> H0jf2JMtke5zDDIWys6fihOCA6QBmC5+hbgVB/c2mMPNPLB6tDXt0TFZU1f9wvaCR9762anKSc8CCqXLogw8V00=</pre>
>
> * Signer 3 encryption
> ** HMAC_KEY (hex): 1f51ea067c121e2f86af5e1d484905046bc63e861573157d8b1ae9e7e47e224b
> ** MAC (hex): 1a5624fcb39cebabb6174456173eec19b756bc916cf2c9d815e9bcce070898c4
> ** IV (hex) : 1a5624fcb39cebabb6174456173eec19
> ** CIPHERTEXT (hex): 48d6e139bdc8c19e93cbbf5b4478340c8cf08aa91c28803084d5f58618773f7e615e0134492b496c4e7c130351c0350701f686918033f621378552d7040efedd5539d38c258bf936475de775f23da3953fe3ba5bbbd24816b8902b87a9a09700c446b085119dedee2395dd69665e742f72f2fb6da4ebe3f4704eaf45486fbfb84d764b718cc0b756e72f72ab6069d47765bdd3ebd4074af4fa99a95691a659675ce5f72235c28ddf3c3d53179e598cddc967fc896adc6e97edeeffc85b9e44611df748d923ff3dd921ad4d6e98e0de12359a37558e326faf585ba57e73ab45bc4a49f6e8a756f365f5d204e70f7c7bed269e81e9524a41e5d4cbaad0b6b442d6eea1e5da1ca345cc665a0cffe2c3
> ** <tt>signer_3_key.dat</tt>: <pre>1a5624fcb39cebabb6174456173eec19b756bc916cf2c9d815e9bcce070898c448d6e139bdc8c19e93cbbf5b4478340c8cf08aa91c28803084d5f58618773f7e615e0134492b496c4e7c130351c0350701f686918033f621378552d7040efedd5539d38c258bf936475de775f23da3953fe3ba5bbbd24816b8902b87a9a09700c446b085119dedee2395dd69665e742f72f2fb6da4ebe3f4704eaf45486fbfb84d764b718cc0b756e72f72ab6069d47765bdd3ebd4074af4fa99a95691a659675ce5f72235c28ddf3c3d53179e598cddc967fc896adc6e97edeeffc85b9e44611df748d923ff3dd921ad4d6e98e0de12359a37558e326faf585ba57e73ab45bc4a49f6e8a756f365f5d204e70f7c7bed269e81e9524a41e5d4cbaad0b6b442d6eea1e5da1ca345cc665a0cffe2c3</pre>
>
> ====ROUND 2====
> * Coordinator
> ** <tt>my_multisig_wallet.bsms</tt>:
> <pre>BSMS 1.0
> /0/*,/1/*
> sh(wsh(multi(2,[110dc257/48'/0'/0'/1']xpub6EPQbDFezXYvVFHqnc8R7QUSE8hTepbyCXU7jJBT4dVm2rQHe1i6isqoj59qhyBiCdKquo6QsgMZNHvEz3BM4cNSszF25siTqLUCznBm8vk/*,[5c890401/48'/0'/0'/1']xpub6EW1SmjSXq9YwVwcan5qWEncgx89SozMvGNpYF6hfZHYNTikNZ4gsXuVhHTi6xYJCkmY4X4wpPPS5Gr7aY39dVJMS2TGfihr25oaspKtU8q/*,[614cbf5f/48'/0'/0'/1']xpub6F9TfWTFcMYy5Ycd2ka2az1brJj78J2isLAWptZnCpFsesss5sZv5B8xsgt71ZXfhDWhUtf4vng4zY6HUVrQbDMPDYRLYvFFoLnAYfzgYPH/*)))#j3ykhz7f</pre>
>
> * Send to Signer 1:
> ** HMAC_KEY (hex): f43c359a4b3d7b2e01be73c54519b12545ca9a23a86f824aadf577b314a7caa7
> ** MAC (hex): ee74a0f50943d7d1b65270028bb05133e87c832cdc1ef0a07c79db2093ca3432
> ** IV (hex) : ee74a0f50943d7d1b65270028bb05133
> ** CIPHERTEXT (hex): 8e3ba3dac0f979fad0d160bd00c8294ff1726d51b95ff3e1534e5a1900f3d7cd4f6d929985a94b9da2c11e4e0f7770cc53c6739fd099477323bd26a3eca9c8016e79848d15e274463424b8355cd73cced61f1816ac8bac87f8c650ee9052f50e347c52ad24b00794a9d5523714be2fdcf731f14b7a8d7c93eab44c258e1c417d2837b9676832e8ce7239dc28b4e1166803209947b8a875a99b9478ee94f7bc17399e886179ab2a0285dc11a3883f6fa439d0f2277dadbec8c355c379fc50e945897e1a738f6a55b09f6b8b6bdf6d4bc248219cbad3662a78a2f539c989e055e00b8efd42fbff978e1a5cc10f83df56117ece4d17f94a0a6d3803778ed53531419250c5a0fff6cad4ab401468dd054915b068cc8826ae1308a71b38060d68c9248d59eea11c2c52a66d5f6bc0d7ae6cb44305c36e56068456d293b70037902e7b05a3ee0af710201128dffc0c16c3306b66bd19b9ae5b91aded35ef33f07743e5b185a9f88a5c67d40270e3bbcf592167ceaf82ead693728d5129b50075edd5ce24863f3484b4b063599ed1327e1c87d0a2051fed3b1234a702722b686e4c9392a403b79726800dd6b691e516e44d9e836c190b10cf2bb262bba98293c97f2c323e59acd0a1f988c5
> ** <tt>my_multisig_wallet_for_signer_1.dat</tt>: <pre>ee74a0f50943d7d1b65270028bb05133e87c832cdc1ef0a07c79db2093ca34328e3ba3dac0f979fad0d160bd00c8294ff1726d51b95ff3e1534e5a1900f3d7cd4f6d929985a94b9da2c11e4e0f7770cc53c6739fd099477323bd26a3eca9c8016e79848d15e274463424b8355cd73cced61f1816ac8bac87f8c650ee9052f50e347c52ad24b00794a9d5523714be2fdcf731f14b7a8d7c93eab44c258e1c417d2837b9676832e8ce7239dc28b4e1166803209947b8a875a99b9478ee94f7bc17399e886179ab2a0285dc11a3883f6fa439d0f2277dadbec8c355c379fc50e945897e1a738f6a55b09f6b8b6bdf6d4bc248219cbad3662a78a2f539c989e055e00b8efd42fbff978e1a5cc10f83df56117ece4d17f94a0a6d3803778ed53531419250c5a0fff6cad4ab401468dd054915b068cc8826ae1308a71b38060d68c9248d59eea11c2c52a66d5f6bc0d7ae6cb44305c36e56068456d293b70037902e7b05a3ee0af710201128dffc0c16c3306b66bd19b9ae5b91aded35ef33f07743e5b185a9f88a5c67d40270e3bbcf592167ceaf82ead693728d5129b50075edd5ce24863f3484b4b063599ed1327e1c87d0a2051fed3b1234a702722b686e4c9392a403b79726800dd6b691e516e44d9e836c190b10cf2bb262bba98293c97f2c323e59acd0a1f988c5</pre>
>
> * Send to Signer 2:
> ** HMAC_KEY (hex): e0a20b5f5285fbaa35aad08fb70f5626c9abbe1b384a4950735b28aca6325ff2
> ** MAC (hex): 81df9e064f1de1d5f754c4e20f9286f9d81b856d3965677a9f2430cb9297ad1f
> ** IV (hex) : 81df9e064f1de1d5f754c4e20f9286f9
> ** CIPHERTEXT (hex): dcd82038ef627d6cb2deb62d04c4ccbaa3a354633d960e46312c22791f039f23fd9782a1e3a63504c1e5b3a0770bb8d32fdf168738b6c03278f1391dd5d01e9aafee7be2c8136ee018feff6fc8cdb926df13a36e115ddca8254934f56b7f700768c94cb8388a8297834de9affcd959417ae3d6ec3251387904f50f51f06306cc4d36eefc51418dd3b2c5454910a23ec67a40a3b918d2a740e812929aae949d8dde2c41cbbb3a2b7c2103788421c147f4794d6a26947c15ef4a99ceb825d0c5aaa78b8737d0ef712ba8e269a9941b1af5d217dcdd9cd06727fbdc70fabe3f5a8c09acff4e76992be7f27c6b12ca84739f62a6da86e5b79103d632c0dc8ab3f91fddb3cfbe67084dc4b861c4ac7c86fb171a058c98c67cffdc40ff17ae1533361cc6fb7b63657af0408cf30bf9d6d97aaacf9d3ff443eee61f207228cd91769ce83a0709c1be1847884c6a8fdc86ede66aef8e34fc509c49edf30f743bdc8f9052961ee340924ec2d1caadc6fd286bb3e233c153cd08c1934127752dc28e0d12efa92a050c4061653edb1cbf2fd4b2ba4e038f0b44f5735f198e92571c029156f65f534bfc149f38d611829901372cfc0176b9d2f9ac6512b7f37941a02dff701df0bceadaacfc6935
> ** <tt>my_multisig_wallet_for_signer_2.dat</tt>: <pre>81df9e064f1de1d5f754c4e20f9286f9d81b856d3965677a9f2430cb9297ad1fdcd82038ef627d6cb2deb62d04c4ccbaa3a354633d960e46312c22791f039f23fd9782a1e3a63504c1e5b3a0770bb8d32fdf168738b6c03278f1391dd5d01e9aafee7be2c8136ee018feff6fc8cdb926df13a36e115ddca8254934f56b7f700768c94cb8388a8297834de9affcd959417ae3d6ec3251387904f50f51f06306cc4d36eefc51418dd3b2c5454910a23ec67a40a3b918d2a740e812929aae949d8dde2c41cbbb3a2b7c2103788421c147f4794d6a26947c15ef4a99ceb825d0c5aaa78b8737d0ef712ba8e269a9941b1af5d217dcdd9cd06727fbdc70fabe3f5a8c09acff4e76992be7f27c6b12ca84739f62a6da86e5b79103d632c0dc8ab3f91fddb3cfbe67084dc4b861c4ac7c86fb171a058c98c67cffdc40ff17ae1533361cc6fb7b63657af0408cf30bf9d6d97aaacf9d3ff443eee61f207228cd91769ce83a0709c1be1847884c6a8fdc86ede66aef8e34fc509c49edf30f743bdc8f9052961ee340924ec2d1caadc6fd286bb3e233c153cd08c1934127752dc28e0d12efa92a050c4061653edb1cbf2fd4b2ba4e038f0b44f5735f198e92571c029156f65f534bfc149f38d611829901372cfc0176b9d2f9ac6512b7f37941a02dff701df0bceadaacfc6935</pre>
>
> * Send to Signer 3:
> ** HMAC_KEY (hex): 1f51ea067c121e2f86af5e1d484905046bc63e861573157d8b1ae9e7e47e224b
> ** MAC (hex): 159a91100cacd123480b7d085c8bb32ec8eb06f0391b6dc8fac07ae67eb37b81
> ** IV (hex) : 159a91100cacd123480b7d085c8bb32e
> ** CIPHERTEXT (hex): c7269d8be21d1cfe172e35aa106760f1fdc929fce19da8fb7f74f759efec1ee02796fb1e8b008cf177f60a2021570f17aeeb41f8636858654082734b90959b98fd08419f901683c4ca3e76b3e482fea4c67162775e0d80bcb45df729f646c1364a3d8a7d1ff961717b00897e877c1c0554d3502942149726806269c546ad2dd34ba286ddf5cd336b83aabf7091fa25e607faf7e54017d84113e1e3ec440b3704addea188b89293469306fc0a98570afdcf269026b2d2e760f466c1f75bcf75fdf030c0a692e5681fd4487e59d6e96451ff5b6b9f2521b8e95e796ef4ab0a917794d91a30fdac7ee9ddbd89d174831bd133ab12a74f52f6283ee2c5fe3d5a957a7c1a15530b2c5224f76d90057dc94f2ee34e28b037ae7f518cc6dfe725cd3e657648de82b200ea77830eb93219f883998d3207a4ef5902d1119b0cde6b364bc1effb86109d9c2babc8ab26dce90329779d8cd0d737e9825a25586aa3c8fa5317e3e433ff235b82f629de0504e3c992f8e8de299f62751bc1fcb2e75e0262c7a27be7068cea69b14f303e97c24b99ed29cae142564e285657704b4c411d0d4f8c58819e2c0e0ffc3667eb5a408aad8a3023a5f00875e7deab95dc365d8757f7b79815a4fd9e6de2b3
> ** <tt>my_multisig_wallet_for_signer_3.dat</tt>: <pre>159a91100cacd123480b7d085c8bb32ec8eb06f0391b6dc8fac07ae67eb37b81c7269d8be21d1cfe172e35aa106760f1fdc929fce19da8fb7f74f759efec1ee02796fb1e8b008cf177f60a2021570f17aeeb41f8636858654082734b90959b98fd08419f901683c4ca3e76b3e482fea4c67162775e0d80bcb45df729f646c1364a3d8a7d1ff961717b00897e877c1c0554d3502942149726806269c546ad2dd34ba286ddf5cd336b83aabf7091fa25e607faf7e54017d84113e1e3ec440b3704addea188b89293469306fc0a98570afdcf269026b2d2e760f466c1f75bcf75fdf030c0a692e5681fd4487e59d6e96451ff5b6b9f2521b8e95e796ef4ab0a917794d91a30fdac7ee9ddbd89d174831bd133ab12a74f52f6283ee2c5fe3d5a957a7c1a15530b2c5224f76d90057dc94f2ee34e28b037ae7f518cc6dfe725cd3e657648de82b200ea77830eb93219f883998d3207a4ef5902d1119b0cde6b364bc1effb86109d9c2babc8ab26dce90329779d8cd0d737e9825a25586aa3c8fa5317e3e433ff235b82f629de0504e3c992f8e8de299f62751bc1fcb2e75e0262c7a27be7068cea69b14f303e97c24b99ed29cae142564e285657704b4c411d0d4f8c58819e2c0e0ffc3667eb5a408aad8a3023a5f00875e7deab95dc365d8757f7b79815a4fd9e6de2b3</pre>
>
> ==Acknowledgement==
>
> Special thanks to Pavol Rusnak, Dmitry Petukhov, Christopher Allen, Craig Raw, Robert Spigler, Gregory Sanders, Ta Tat Tai, Michael Flaxman, Pieter Wuille and others for their feedback on the specification.
>
> ==References==
>
> Original mailing list thread:
> https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-February/018385.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210411/89cff413/attachment-0001.html>

From hugo at nunchuk.io  Sun Apr 11 16:45:00 2021
From: hugo at nunchuk.io (Hugo Nguyen)
Date: Sun, 11 Apr 2021 09:45:00 -0700
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <s7sT6UplllXDfiCyf2HWJvEdz-1Gp9D5bvpwtAcmXEq2sRYm99FZZXJEFs-fDuhLKyxpgEvMrKa3P5OIRznxHLUqMjMIaUs-s5CGsx7zO_Q=@protonmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <s7sT6UplllXDfiCyf2HWJvEdz-1Gp9D5bvpwtAcmXEq2sRYm99FZZXJEFs-fDuhLKyxpgEvMrKa3P5OIRznxHLUqMjMIaUs-s5CGsx7zO_Q=@protonmail.com>
Message-ID: <CAPKmR9v7xX7ASXAUkNXwjM5ExEF8xs5ihKw6MiY=RXk6o5s2Ng@mail.gmail.com>

Hi Michael,
Comments inline.

On Sat, Apr 10, 2021 at 7:34 PM Michael.flaxman <
michael.flaxman at protonmail.com> wrote:

> Hi Hugo,
>
> I appreciate the effort you and everyone else is making to improve
> multisig in bitcoin!
>

Thanks.


> I like that this BIP gets rid of SLIP132 version bytes, as those have been
> de-facto deprecated in favor of output descriptors for some time. Having a
> standard for how to communicate descriptor records (BSMS 1.0) also seems
> like a nice positive.
>
> The most commonly raised issues from the 10x security guide
> <https://btcguide.github.io/> are about how to properly verify that all
> hardware wallets are participants in the user's multisig quorum (and with
> the correct m-of-n). This shows up in two big ways:
>
>    1. The O(n^2) xpub validation problem creates a bad UX and is hard for
>    non-advanced users.
>    2. The risk for stateless hardware wallets (like Trezor) to have their
>    xpubs swapped out by a compromised Coordinator.
>
> Unfortunately, this BIP does not improve either of these issues, while
> adding considerable complexity.
>
> *1. O(n^2) Xpub Validation*
>
> The proposed use of an output descriptor checksum has an obvious 40-bit
> MITM collision attack. A compromised Coordinator could trick a Signer into
> displaying an attacker's receive address, despite a correctly functioning
> Signers and the user properly validating the checksum (github link
> <https://github.com/nunchuk-io/bips/pull/1/#issuecomment-801629857>).
>
> Using a checksum with much higher entropy would reduce xpub validation to
> O(n) and create a very nice UX for signers. This would be a huge win for
> multisig! Instead, the recommended solution from the BIP is to validate all
> the key records manually, which is how multisig is currently done and what
> we desperately want to move away from. With a proper checksum, there?s no
> reason for a user to ever see an xpub.
>
> Users should not be shown a checksum and asked to validate it in meatspace
> (across Signers) if an attacker?s address could still be substituted!
> Validating a single address across devices does solve this problem, but if
> you?re going to validate an address there?s no reason to display the
> checksum at all. However, validating an address is confusing to non-experts:
>
>    - Is it a wallet ID or a bitcoin address?
>    - Am I supposed to send funds to this address?
>
> If creating a new checksum standard for the descriptor record is
> undesirable, we could use a child address (from an unhardened BIP32 path)
> and encode that in some way for end-users to verify it matches across all
> Signers. It would be strongly preferable for the encoding to be an
> unambiguously different format from a bitcoin address / BIP39 seed phrase,
> so that it?s clear it?s just a wallet ID. One non-ideal but simple solution
> is to use a hash function (i.e. dsha256) to calculate the digest of the
> child address, and display this in hexadecimal format. While hexadecimal is
> non-ideal for manual verification, it is already trivial for any bitcoin
> library to perform these steps.
>

As I have responded to your previous comment about the same on Github (
https://github.com/nunchuk-io/bips/pull/1), I do see the value of a
longer checksum.

There are trade-offs when it comes to designing checksum. Mainly complexity
and size. At one end of the spectrum you can have a single-byte XOR
checksum. At the other end you can have something like HMAC-SHA256 (which
we are using in the proposal to calculate the MACs for the key and
descriptor records). And then there's everything in between. But we should
know that nothing comes for free.

It's a good topic that warrants further discussion.

Confirming a single address is a promising direction, since it's something
the user should do anyway prior to using the wallet. Currently the proposal
recommends that the Signers show a preview of the first address(es) upon
wallet creation. But we can elevate this and make it a mandatory part of
the spec: have all Signers confirm that they have the same 1st receive
address. If we go with this approach, the checksum can stay as-is, and only
there for error detection. (We get the checksum for free with the
descriptor language anyway, so there's no reason to remove it).

Also nice to see that you have come around and agree that moving away from
manual inspection is desirable.


> *2. Allow Support for Stateless Wallets*
>
> The current BIP states:
>
> * "If all checks pass, the Signer must persist the descriptor record in
> its storage."*
>
> While persistence has a lot of benefits, it is not a feature of the most
> sold multisig hardware wallet: Trezor. A simple solution here is to have
> each Signer sign the entire descriptor record at the end of round 2, not
> just its own key record in round 1. Then the data can be stored anywhere
> (including on the Signer itself) and played back to each Signer for
> validation when needed. The end-user would have no idea this was happening,
> but the device could refuse to display information it hasn?t fully
> validated (or at least add a warning message). Even a device with
> persistent storage would be better served using a signature, so that an
> evil maid couldn't tamper with the device (say in the no-encryption case
> for simplicity).
>

I reiterate that I strongly disagree that going stateless is the direction
we want to pursue when it comes to multisig.

In a multisig or any type of MPC smart contract, any Signer in the contract
must know who the other co-Signers are at all times. You can choose to do
this verification once at setup and persist this info on the Signer, or
you'd have to re-do the verification for every single transaction. There is
no other choice.

Signing the descriptor record is insufficient, while also introducing a
great deal of complexity. Here are the problems:
1) The signature needs to be stored somewhere. Who stores it if it's not
the Signer itself? What if it gets lost? (If the Signer stores its own
signature, then the scheme is no longer stateless. You might as well store
the full descriptor).
2) When the signature is "played back" to the Signer, a copy of the
original descriptor must be included. Who stores the descriptor? What if it
gets lost? This is an under-appreciated aspect of the stateful approach:
every participant in the multisig has a full copy of the original contract,
which adds resilience to the wallet backup / recovery process.
3) Because the full descriptor must be "played back" for every single
transaction, this means every detail of the contract must be shared again
and again, indefinitely. Not only does this add overhead (engineering and
cognitive) to the spending process, it has massive privacy implications,
since the descriptor contains everything you need to know about the wallets
and its participants.

Here's an analogy in the physical world. Would you:
a) Enter any type of written contract and
b) Not keep a copy of the contract, forget about it, and
c) Later on rely on your counter-parties or a third-party to provide you
with the original contract and your signature, when the terms get carried
out?

One would be insane to enter such a contract in the real world.

I realize that some vendors are currently not stateful, but I take this as
an unfortunate fact, because multisig wasn't a priority when these hardware
were originally designed. But that is no reason to keep going with a broken
architecture. The industry is green enough that we still can learn and
recover from these sorts of flaws.

Since you mentioned Trezor, I want to thank Pavol in particular here,
because as Trezor CTO Pavol knows best that Trezor is currently stateless,
but he's still on-board with the general idea here, AFAIU.

Bottom line: IMO, signers in a multisig MUST be stateful.

This existing vulnerability in stateless wallets is particularly bad for
> hosted multisig services like Casa/Unchained, where the service might
> control m-1 keys. It?s far easier for a hosted service to potentially trick
> non-expert users into displaying an attacker's receive address on their
> stateless Signer.
>
> For example, assume the user is doing 2-of-3 multisig, where the
> Coordinator (service) controls 1 key. Here is how the Coordinator could
> trick their end-users:
>
>    1. Coordinator swaps out 1 of the end-user?s xpubs, going from a
>    2-of-3 where the end-user has 2 seeds to a 2-of-3 where the Coordinator has
>    2 seeds.
>    2. The end-user logs into the service to get a new receive address,
>    and the service (Coordinator) displays malicious receive address X (as part
>    of a 2-of-3).
>    3. The end user connects stateless Signer 1 to the service
>    (Coordinator), which under-the-hood gives stateless Signer 1 proof that it
>    is included in this 2-of-3. Stateless singer 1 displays malicious receive
>    address X!
>    4. The end-user doesn't verify the address on Signer 2, as many users
>    unfortunately don't -- perhaps it is in a far away location and the
>    end-user (incorrectly) thinks that it?s already been validated in 2 places
>    -- and makes a large deposit to receive address X. These funds now belong
>    to the attacker and can be swept at any time!
>
> If stateless Signer 1 required a signature to be replayed at step 3,
> stateless Signer 1 would refuse to display malicious receive address X (or
> at a minimum warn the end-user that it did not have enough info to properly
> validate the address).
>
> This is also a concern for self-hosted multisig, I just used the hosted
> services as the best example.
>
> It's also not just Trezor that is stateless. For example, I wrote a
> simple CLI software multisig wallet as part of the buidl library
> <https://twitter.com/mflaxman/status/1321503036724989952> to be used
> mostly for emergency recovery. At 800 lines of code, it's too
> simple/minimal to touch the file system.
>
> *BIP39*
>
> While unrelated, the use of BIP39 words for session tokens seems like a
> big mistake, as end-users have learned over years that BIP39 words are for
> private key material. A small percent of users may backup their token BIP39
> mnemonic and not their seed phrase BIP39 mnemonic! My suggestion is to just
> stick with the other two Token options: decimal and hex.
>

Repost of my previous response. We discussed this at length on the
linked Github PR:
"We decided to keep the TOKEN at 6-9 words, not 12 or anything above
precisely for this reason. Please note that the user has to back up their
Signers first, before proceeding to setting up the multisig wallet. So
there's no writing both things down at once or mixing of the two flows here.

I also find it hard to believe that someone who wants to invest in a safe
multisig solution (and therefore must know at minimum what keys and
multisig represent) will not know the difference between (permanent) 12
words and (one-time use) 6 words. Also note that the TOKEN can be used
without using BIP39 mnemonic at all."

We also made the decimal format, not BIP39 mnemonic, the recommended
encoding in the spec.

Best,
Hugo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210411/92f6fc7e/attachment-0001.html>

From salvatore.ingala at gmail.com  Mon Apr 12 15:03:12 2021
From: salvatore.ingala at gmail.com (Salvatore Ingala)
Date: Mon, 12 Apr 2021 17:03:12 +0200
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CAPKmR9v7xX7ASXAUkNXwjM5ExEF8xs5ihKw6MiY=RXk6o5s2Ng@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <s7sT6UplllXDfiCyf2HWJvEdz-1Gp9D5bvpwtAcmXEq2sRYm99FZZXJEFs-fDuhLKyxpgEvMrKa3P5OIRznxHLUqMjMIaUs-s5CGsx7zO_Q=@protonmail.com>
 <CAPKmR9v7xX7ASXAUkNXwjM5ExEF8xs5ihKw6MiY=RXk6o5s2Ng@mail.gmail.com>
Message-ID: <CAMhCMoGWGFOuPA4iTacCP3HVudg80L+-xmjzvcGjohMhwnzVtA@mail.gmail.com>

Hi Hugo,

First of all, thank you for the impressive work on leading the
standardization efforts!

I believe one ought to more clearly distinguish the "Signer" (as in: one of
the parties in the multisig setup), from the "*Signing device*" (which is
likely a hardware wallet). BSMS defines a "Signer" as "a participating
member in the multisig",  therefore a person/entity who is likely using
both a hardware wallet and some BSMS-friendly software wallet (e.g. the
next version of Specter Desktop). It is therefore relevant to discuss which
parts of the BSMS mechanism are implemented in the Signer's software
wallet, and which should be in the Signer's hardware wallet.
>From the discussion, it appears to me that different people might have
different expectations on what the signing device/HWW should do, so I would
like to comment on this point specifically (while I reckon that it mostly
falls within the realm of concerns #4 and #5 of the motivation paragraph,
which are explicitly left out of scope).

I fully agree that a *Signer* must persist the full wallet's description,
and should also create physical backups which include the full descriptor
and the cosigner's information. I would disagree, however, if any standards
were to force *hardware wallets* to persist any substantial amount of state
other than the seed, as I believe that it gives no substantial advantage
over externally stored signed data for many use cases.

The following is the *wallet registration flow* I am currently working on
(in the context of adding support to multisig wallets at Ledger). The goal
is to allow a *Signer* (the person) to persist a multisig setup in its
storage, while achieving a similar level of security you would have if you
were storing it on the hardware wallet itself (note that the following flow
would happen as part of Round 2):

1) The desktop wallet of the requests the HWW to register a new multisig
wallet. The request includes the full multisig wallet description, and some
extra metadata (e.g.: a name to be associated to this multisig wallet).
2) The HWW validates the wallet and verifies it with the user with the
trusted screen (as per BSMS Round 2); on confirmation, it returns a wallet
id (which is a vendor-specific hash of all the wallet description +
metadata) and signature
3) The desktop wallet stores the full wallet description/id/signature.
(Optionally, a backup could be stored elsewhere).

Whenever an operation related to the multisig wallet is required (verifying
a receiving address, or signing a spending transaction), the HWW first
receives and verifies all the data stored at step 3 above (without any user
interaction). Then it proceeds exactly the same way as if it had always
stored the multisig wallet in their own storage. I think this is basically
the same flow Michael Flaxman is suggesting here:
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-April/018775.html

(Note that none of this is flow specific to Multisig wallet, as the same
flow would be unchanged for any arbitrary supported script that needs to be
"registered" on a stateless device, and can be generalized for MPC
protocols)

The only caveat I can think of is that the script registration is never
revocable if a signing key derived from the seed is used in step (2), which
might or might not be desirable. One could instead prefer to use a
different signing key that is destroyed if the device is wiped, which would
therefore need to be stored on the device. Note that the only thing that is
lost is the on-device multisig wallet registration, which could easily be
repeated from a backup.


On Sun, 11 Apr 2021 at 19:11, Hugo Nguyen via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> I reiterate that I strongly disagree that going stateless is the direction
> we want to pursue when it comes to multisig.
>
> In a multisig or any type of MPC smart contract, any Signer in the
> contract must know who the other co-Signers are at all times. You can
> choose to do this verification once at setup and persist this info on the
> Signer, or you'd have to re-do the verification for every single
> transaction. There is no other choice.
>

>
Signing the descriptor record is insufficient, while also introducing a
> great deal of complexity. Here are the problems:
> 1) The signature needs to be stored somewhere. Who stores it if it's not
> the Signer itself? What if it gets lost? (If the Signer stores its own
> signature, then the scheme is no longer stateless. You might as well store
> the full descriptor).
>

In the flow I describe above, the desktop wallet would indeed store the
signed descriptor record and wallet metadata. So yes, the *Signer* as in *the
party in the protocol* stores it, but not the signing device*. *The same
method could be used to store state temporarily between round 1 and 2,
where the only *state* on the hardware wallet would be the TOKEN, while
everything else is stored (encrypted and signed) on the Signer's desktop.


> 2) When the signature is "played back" to the Signer, a copy of the
> original descriptor must be included. Who stores the descriptor? What if it
> gets lost? This is an under-appreciated aspect of the stateful approach:
> every participant in the multisig has a full copy of the original contract,
> which adds resilience to the wallet backup / recovery process.
>

"Playing back" the signature and wallet's setup data to the hardware wallet
would indeed happen transparently from the Signer's wallet software. If the
Signer lost this data due to malware, faulty hardware, etc., the user would
indeed have to recover from backup, which seems ok to me.


> 3) Because the full descriptor must be "played back" for every single
> transaction, this means every detail of the contract must be shared again
> and again, indefinitely. Not only does this add overhead (engineering and
> cognitive) to the spending process, it has massive privacy implications,
> since the descriptor contains everything you need to know about the wallets
> and its participants.
>

I agree with some of these concerns, but I observe:
- The engineering overhead in handling externally-stored-signed-data is
paid once, and would mostly fall on the hardware wallet vendor. External
software only cares about storing certain data and sending it back later.
- Storing xpubs/descriptors in the desktop software that interacts with
the HWW is already common practice, and necessary for using any watch-only
wallet.

Summarizing, I argue that the stateful/stateless characteristic of a
hardware wallet does not really affect (modulo some extra work) the ability
to participate in the BSMS ceremony, whose *Signers* should indeed be
stateful.
Some more clarifications on the trust assumptions might help at clarifying
the best possible software/hardware implementation tradeoffs, either in
this or a follow-up BIP.

Best,
Salvatore Ingala
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210412/0e23254c/attachment.html>

From hugo at nunchuk.io  Mon Apr 12 17:55:36 2021
From: hugo at nunchuk.io (Hugo Nguyen)
Date: Mon, 12 Apr 2021 10:55:36 -0700
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CAMhCMoGWGFOuPA4iTacCP3HVudg80L+-xmjzvcGjohMhwnzVtA@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <s7sT6UplllXDfiCyf2HWJvEdz-1Gp9D5bvpwtAcmXEq2sRYm99FZZXJEFs-fDuhLKyxpgEvMrKa3P5OIRznxHLUqMjMIaUs-s5CGsx7zO_Q=@protonmail.com>
 <CAPKmR9v7xX7ASXAUkNXwjM5ExEF8xs5ihKw6MiY=RXk6o5s2Ng@mail.gmail.com>
 <CAMhCMoGWGFOuPA4iTacCP3HVudg80L+-xmjzvcGjohMhwnzVtA@mail.gmail.com>
Message-ID: <CAPKmR9uoA_tgz690GPAgYWM32UPkR5P2Nc_TigJZi-SiLYcFLw@mail.gmail.com>

Hello Salvatore,

On Mon, Apr 12, 2021 at 8:03 AM Salvatore Ingala <salvatore.ingala at gmail.com>
wrote:

> Hi Hugo,
>
> First of all, thank you for the impressive work on leading the
> standardization efforts!
>
> I believe one ought to more clearly distinguish the "Signer" (as in: one
> of the parties in the multisig setup), from the "*Signing device*" (which
> is likely a hardware wallet).
>

Actually, in the current spec, a "Signer" is *any software/hardware that
possesses the private keys and can sign using those keys* -- it doesn't
have to be hardware. "Signer" does not mean the human user. I will clarify
the definition and clear up any ambiguous language in the spec. Thanks for
bringing this to my attention!


> BSMS defines a "Signer" as "a participating member in the multisig",
> therefore a person/entity who is likely using both a hardware wallet and
> some BSMS-friendly software wallet (e.g. the next version of Specter
> Desktop).
>

As mentioned above, "Signer" does not refer to the user or any entity that
does not have the private keys / signing capability.


> It is therefore relevant to discuss which parts of the BSMS mechanism are
> implemented in the Signer's software wallet, and which should be in the
> Signer's hardware wallet.
> From the discussion, it appears to me that different people might have
> different expectations on what the signing device/HWW should do, so I would
> like to comment on this point specifically (while I reckon that it mostly
> falls within the realm of concerns #4 and #5 of the motivation paragraph,
> which are explicitly left out of scope).
>
> I fully agree that a *Signer* must persist the full wallet's description,
> and should also create physical backups which include the full descriptor
> and the cosigner's information. I would disagree, however, if any standards
> were to force *hardware wallets* to persist any substantial amount of
> state other than the seed, as I believe that it gives no substantial
> advantage over externally stored signed data for many use cases.
>
> The following is the *wallet registration flow* I am currently working on
> (in the context of adding support to multisig wallets at Ledger). The goal
> is to allow a *Signer* (the person) to persist a multisig setup in its
> storage, while achieving a similar level of security you would have if you
> were storing it on the hardware wallet itself (note that the following flow
> would happen as part of Round 2):
>
> 1) The desktop wallet of the requests the HWW to register a new multisig
> wallet. The request includes the full multisig wallet description, and some
> extra metadata (e.g.: a name to be associated to this multisig wallet).
> 2) The HWW validates the wallet and verifies it with the user with the
> trusted screen (as per BSMS Round 2); on confirmation, it returns a wallet
> id (which is a vendor-specific hash of all the wallet description +
> metadata) and signature
> 3) The desktop wallet stores the full wallet description/id/signature.
> (Optionally, a backup could be stored elsewhere).
>

> Whenever an operation related to the multisig wallet is required
> (verifying a receiving address, or signing a spending transaction), the HWW
> first receives and verifies all the data stored at step 3 above (without
> any user interaction). Then it proceeds exactly the same way as if it had
> always stored the multisig wallet in their own storage.
>

Now that we're clear on definitions, then it should become obvious that
redefining the "Coordinator-Signer" pair as "a Signer" does not address the
underlying problem. (What you call "the desktop wallet" here is a
Coordinator, not a Signer).

As long as the Signer does not own up the task of storing the wallet
configuration, it must rely indefinitely on others for critical data when
working in a multisig wallet, as I have explained in my last email.

Best,
Hugo


>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210412/d2c96113/attachment-0001.html>

From ChristopherA at lifewithalacrity.com  Mon Apr 12 18:45:27 2021
From: ChristopherA at lifewithalacrity.com (Christopher Allen)
Date: Mon, 12 Apr 2021 11:45:27 -0700
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CAMhCMoGWGFOuPA4iTacCP3HVudg80L+-xmjzvcGjohMhwnzVtA@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <s7sT6UplllXDfiCyf2HWJvEdz-1Gp9D5bvpwtAcmXEq2sRYm99FZZXJEFs-fDuhLKyxpgEvMrKa3P5OIRznxHLUqMjMIaUs-s5CGsx7zO_Q=@protonmail.com>
 <CAPKmR9v7xX7ASXAUkNXwjM5ExEF8xs5ihKw6MiY=RXk6o5s2Ng@mail.gmail.com>
 <CAMhCMoGWGFOuPA4iTacCP3HVudg80L+-xmjzvcGjohMhwnzVtA@mail.gmail.com>
Message-ID: <CACrqygBgPtNtHS31emSRM3FBzAjNyi6x6EhbHqYVBxmoXsG8+g@mail.gmail.com>

Though I am ACK on that we need to solve the problem of xpub privacy and
reuse, I'm NACK on this solution. It is currently too complex and doesn't
really solve the problem.

I believe that the ultimate solution will be some form of multi-round
cryptographic commitment scheme, and as musig threshold signatures with
Taproot/Schnoor also require multi-round scheme, we should start thinking
now about how maybe we can leverage that work to address this problem as
well. However, I'm not a cryptographer and don't have a specific solution
in this area to offer.

In the meantime, there are some possible measures we can take as new best
practices. This is not a formal list, and I'm open to other suggestions,
but each are currently relatively easy and are functional with some
existing wallets that CAN support state. Let us get it right with stateful
wallets, then we can return back to better best practices for stateless
wallets like Trezor, Ledger, etc.

A) We should accept that users must to backup their multisig account maps
(descriptor with only xpubs) along with their cosigner key material to be
able to recover funds. In the Airgap Community we make this very easy with
a simple UR code that works efficiently as a QR. I personally keep multiple
copies of this account map in multiple locations, as it is less of a risk
(mostly privacy) if one of the locations is compromised.

B) Cosigner wallets and transaction coordinator services should not share
the master xpub, only the derived co-signer xpubs required for that
specific account. Currently too many libraries, wallets and coordinators
only function if they get the master xpub ? these should be updated to not
require them.

C) In many current wallets, the master xpub fingerprint is required ? that
master fingerprint is also a privacy risk and should not be used. For
instance, the current practice of offering what the Airgap Community calls
a `crypto-hdkey` [604b93f2/48'/1'/0'/2'] with the master fingerprint root,
could instead be to only offer a single parent fingerprint [f93749a7/2']
from that grandparent master key. Thus different fingerprints can be
offered for each account, and only the signer knows the actual master
fingerprint and its children.

D) Given C, when creating a new multisig account, a transaction coordinator
may request a specific master fingerprint and/or a fixed 48' derivation
xpub from a cosigner wallet, but these are only hints. If it gets back a
different fingerprint or derivation, it should accept it. In the case of
the Airgap Community's specifications, in our "crypto-request" we actually
specifically allow for wildcard requests which makes this easy and
explicit. Yes, only stateful signers can know to return an xpub something
other than the fingerprint  and m/48'/1'/0'/2' default, but a transaction
coordinator should accept it if it receives it.

E) Transaction coordinators should send the cosigner "policy" (basically
the multisign descriptor without any keys in it) along with any request to
derive a new xpub for that new account. Stateful wallets can use this
policy to know later if they are asked to sign a PSBT that does not match
this policy.

F) Transaction coordinators should also send the final "account map" to all
the cosigner wallets as a best practice as well. This would replace the
temporary "policy" in D. If a PSBT request to sign using a key doesn't
match the original account map, the cosigner wallet can reject it.

These best practices don't solve the problem with stateless wallets like
Trezor, but they are possible now with the new generation of multisig
hardware and software wallets, such as Foundation Devices, CoboVault,
Sparrow, Bluwallet and my Gordian reference wallet tools. We have available
NOW working interoperable specifications, reference code, and example apps
that support these best practices, and some are already supported by
multiple wallets in the Airgapped Wallet Community hosted by Blockchain
Commons at https://github.com/blockchainCommons/airgapped-Wallet-Community.

I've put a copy of this rough proposal in our Airgapped Wallet Community
discussion area if you have suggestions or alternative best practices.

[Initial proposal for best practice to avoid XPUB reuse in multisig account
creation](
https://github.com/BlockchainCommons/Airgapped-Wallet-Community/discussions/53
)

-- Christopher Allen, Blockchain Commons
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210412/16421f4e/attachment.html>

From billy.tetrud at gmail.com  Mon Apr 12 19:39:13 2021
From: billy.tetrud at gmail.com (Billy Tetrud)
Date: Mon, 12 Apr 2021 09:39:13 -1000
Subject: [bitcoin-dev] Taproot activation meeting on IRC - Tuesday 13th
 April 19:00 UTC
In-Reply-To: <LXABjC3kHmtKvzKD0zz1rh0QxEEbCUr5bUv5A1uzu8OzJ0U3CMYG8e6i9OaXHmvIpeYTja0vN493GoC9rKV3W_MOMOuLbNWzCEdqEhGM-fs=@protonmail.com>
References: <LXABjC3kHmtKvzKD0zz1rh0QxEEbCUr5bUv5A1uzu8OzJ0U3CMYG8e6i9OaXHmvIpeYTja0vN493GoC9rKV3W_MOMOuLbNWzCEdqEhGM-fs=@protonmail.com>
Message-ID: <CAGpPWDbtuz6LDMy-x3nG3k1sp3PCHN6o+UTZo_ihzYeZoG344g@mail.gmail.com>

> more than sufficient support for LOT=True to proceed safely

This seems to contradict what you said about "there was never any consensus
reached on the LOT parameter". Can you clarify?

On Sat, Apr 10, 2021 at 4:13 AM BitcoinMechanic via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Taproot activation meeting on IRC - Tuesday 13th April 19:00 UTC
>
> The focus of the meeting will be ratifying the Taproot activation plan
> previously discussed at the March 16th meeting (aka 2021-03 Plan Y as
> summarized here):
>
>
> https://docs.google.com/spreadsheets/d/1K3pmH09yXLTHGV3wqFZGR3ei7QVwtdEwo0PjI2NHD3w/edit#gid=0
>
> While there was never any consensus reached on the LOT parameter, there
> appears to be consensus on BIP8 and the remaining parameters, and more than
> sufficient support for LOT=True to proceed safely.
>
> Miners will have 18 months in which to signal and accelerate activation.
> If not, taproot will activate regardless.
>
> With a majority of the economy running this it will guarantee eventual
> lock-in of taproot with the smallest chance of a chain split.
>
> As a reminder, the channel is also open for ongoing discussion 24/7, and
> there is a web chat client here:
>
> https://webchat.freenode.net/?channel=##taproot-activation
>
> Best,
>
> Bitcoin Mechanic
>
>
> Sent with ProtonMail <https://protonmail.com/> Secure Email.
>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210412/e83dc9c8/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image1618022427865
Type: image/png
Size: 6217 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210412/e83dc9c8/attachment-0001.png>

From billy.tetrud at gmail.com  Mon Apr 12 20:04:51 2021
From: billy.tetrud at gmail.com (Billy Tetrud)
Date: Mon, 12 Apr 2021 10:04:51 -1000
Subject: [bitcoin-dev] maximum block height on transaction
In-Reply-To: <CAD5xwhhZpQ9AQEFHgGYvPh2ad9HyQqq9WwEZje1H1siioB6eLQ@mail.gmail.com>
References: <5B6756D0-6BEF-4A01-BDB8-52C646916E29@friedenbach.org>
 <C623794E-F061-4C7A-B05D-378798ED2BF7@friedenbach.org>
 <201709190309.08669.luke@dashjr.org>
 <CAA2B000-6C54-4AD7-B931-43C99D615A61@friedenbach.org>
 <CAKzdR-phAarTY16BOnC95BPN0qMNEE_XZ9H-XmFeeaBc2V1U5w@mail.gmail.com>
 <3385CE20-C1BA-40DD-8FC3-8F53F3350717@friedenbach.org>
 <CAKzdR-pnvystx5H+P+OCXm73aVmWdyesCymerSgx=pCuXx+YGA@mail.gmail.com>
 <9FD4AF03-28A5-4B8A-9C12-CBCB1BC2E22C@friedenbach.org>
 <CAKzdR-r6u4J+_T5X516A=-tLWZ8zFFFsRokReiJndDE_S64OqQ@mail.gmail.com>
 <CAPg+sBi+WnzpJkcG6XACdpqqz9ZA3rHX8+H9b5eExUdgXaeiWQ@mail.gmail.com>
 <CAJowKg+kbnExgKt7H8GD6Kc-iLJEOvZhtw0uVbophhLCszvOHg@mail.gmail.com>
 <CAMZUoKmQyV67dhWS_+t1CmqNYT490_7g3WwKgxB-jiYfje+F+Q@mail.gmail.com>
 <CAD5xwhhZpQ9AQEFHgGYvPh2ad9HyQqq9WwEZje1H1siioB6eLQ@mail.gmail.com>
Message-ID: <CAGpPWDZHKJ8BvD3TqrvP=5pxbAc0ez-ikJmO6a51WDad1xuLSw@mail.gmail.com>

@Russell I think there were sound arguments against Satoshi's statement
made in that very thread. Especially that software can be written to warn
the user about edge cases.

If a person waited for the standard 6 blocks before accepting a transaction
as confirmed, there should be no significantly likely scenario where any
finalized transaction needs to be reverted. If 6 blocks is indeed a safe
threshold for finalization, then any transaction that has 5 or fewer
confirmations should be considered fair game for reversal. I don't agree
that this is "unfair". In fact, I think that's pretty standard, is it not?
Any chain of transactions that happen in the span of 5 blocks shouldn't be
doing anything that expects those transactions to become finalized until
the relevant transactions get 6 confirmations.

I don't think the possibility of buggy software is a good reason to block
an opcode. Not that I'm hankering for OP_BLOCKNUMBER specifically. However,
I think there are good use cases for spend paths that expire (eg for more
effective wallet vaults).

I've come across this argument before, and it seems kind of like Satoshi's
word here is held as gospel. I haven't heard any deep discussion of this
topic, and I even asked a question on the bitcoin SE
<https://bitcoin.stackexchange.com/questions/96366/what-are-the-reasons-to-avoid-spend-paths-that-become-invalid-over-time-without>
about it. Sorry to hijack this conversation, but I'm very curious if
there's something more to this or if the thinking was simply decided that
OP_BLOCKNUMBER wasn't useful enough to warrant the (dubious) potential
footgun of people accepting sub-6-block transactions from a transaction
that uses an expired spend-path?

On Fri, Apr 9, 2021 at 5:55 AM Jeremy via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> You could accomplish your rough goal by having:
>
>
>
> tx A: desired expiry at H
> tx B: nlocktime H, use same inputs as A, create outputs equivalent to
> inputs (have to be sure no relative timelocks)
>
> Thus after a timeout the participants in A can cancel the action using TX
> B.
>
> The difference is the coins have to move, without knowing your use case
> this may or may not help you.
>
> On Fri, Apr 9, 2021, 4:40 AM Russell O'Connor via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> From https://bitcointalk.org/index.php?topic=1786.msg22119#msg22119:
>>
>> We can't safely do OP_BLOCKNUMBER.  In the event of a block chain reorg
>>> after a segmentation, transactions need to be able to get into the chain in
>>> a later block.  The OP_BLOCKNUMBER transaction and all its dependants would
>>> become invalid.  This wouldn't be fair to later owners of the coins who
>>> weren't involved in the time limited transaction.
>>>
>>> nTimeLock does the reverse.  It's an open transaction that can be
>>> replaced with new versions until the deadline.  It can't be recorded until
>>> it locks.  The highest version when the deadline hits gets recorded.  It
>>> could be used, for example, to write an escrow transaction that will
>>> automatically permanently lock and go through unless it is revoked before
>>> the deadline.  The feature isn't enabled or used yet, but the support is
>>> there so it could be implemented later.
>>>
>>
>> Unfortunately, limiting the maximum block height for a specific
>> transaction would have exactly the same problem as cited above for
>> OP_BLOCKNUMBER.
>>
>> On Fri, Apr 9, 2021 at 7:21 AM Erik Aronesty via bitcoin-dev <
>> bitcoin-dev at lists.linuxfoundation.org> wrote:
>>
>>> is there any way to specify a maximum block height on a transaction?
>>>
>>> ie: this tx is only valid if included in a block with a certain height
>>> or less
>>>
>>> i feel like this would be useful
>>> _______________________________________________
>>> bitcoin-dev mailing list
>>> bitcoin-dev at lists.linuxfoundation.org
>>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>>
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210412/2d4313bc/attachment.html>

From RobertSpigler at protonmail.ch  Mon Apr 12 20:43:39 2021
From: RobertSpigler at protonmail.ch (Robert Spigler)
Date: Mon, 12 Apr 2021 20:43:39 +0000
Subject: [bitcoin-dev] Proposal: Bitcoin Secure Multisig Setup
In-Reply-To: <CACrqygBgPtNtHS31emSRM3FBzAjNyi6x6EhbHqYVBxmoXsG8+g@mail.gmail.com>
References: <CAPKmR9uyY70MhmVCh=C9DeyF2Tyxibux1E_bLPo00aW_h+OjLw@mail.gmail.com>
 <CAPKmR9v=RK7byF0z0hKiLiA=Zm3ZZKbu3vEiuBuzQSXFwa+izw@mail.gmail.com>
 <s7sT6UplllXDfiCyf2HWJvEdz-1Gp9D5bvpwtAcmXEq2sRYm99FZZXJEFs-fDuhLKyxpgEvMrKa3P5OIRznxHLUqMjMIaUs-s5CGsx7zO_Q=@protonmail.com>
 <CAPKmR9v7xX7ASXAUkNXwjM5ExEF8xs5ihKw6MiY=RXk6o5s2Ng@mail.gmail.com>
 <CAMhCMoGWGFOuPA4iTacCP3HVudg80L+-xmjzvcGjohMhwnzVtA@mail.gmail.com>
 <CACrqygBgPtNtHS31emSRM3FBzAjNyi6x6EhbHqYVBxmoXsG8+g@mail.gmail.com>
Message-ID: <woeip5Zez_zUe79iagMJo3Y3ghOhuJZ7tHugD8cWhtm0eZbC7p2eomF0Ia0efq90ayZ-jJTfMrpy69vEmfeB-2ojpx4HMV87H2SluJZ7oL8=@protonmail.ch>

I don't quite understand your NACK.

The following are measures you say we should take as best practices, which I believe are all implemented:

>A) We should accept that users must to backup their multisig account maps (descriptor with only xpubs) along with their cosigner key material to be able to recover funds.

BSMS requires that the descriptor persist in storage and be able to be displayed when requested by the user. It is already industry standard that the same apply to cosigner key material. Backing up both is good practice. (My BIP for a new key hierarchy enforces this as well (https://github.com/bitcoin/bips/pull/1089))

>B) Cosigner wallets and transaction coordinator services should not share the master xpub
Again, check out my updated hierarchy for multisignature wallets, which enforces this and works very well with BSMS.

>C) In many current wallets, the master xpub fingerprint is required
I am confused by this - the descriptor language standardizes the master xpub fingerprint in the key origin information?

>E) Transaction coordinators should send the cosigner "policy"
There is no cosigner "policy" in this standard, but the same checks are implemented (N unique key records, key is included in descriptor, plus valid MAC, valid signatures, valid checksum, etc).

>F) Transaction coordinators should also send the final "account map" to all the cosigner wallets
This is done

Robert Spigler

Personal Fingerprint: BF0D 3C08 A439 5AC6 11C1 5395 B70B 4A77 F850 548F

??????? Original Message ???????
On Monday, April 12, 2021 2:45 PM, Christopher Allen via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:

> Though I am ACK on that we need to solve the problem of xpub privacy and reuse, I'm NACK on this solution. It is currently too complex and doesn't really solve the problem.
>
> I believe that the ultimate solution will be some form of multi-round cryptographic commitment scheme, and as musig threshold signatures with Taproot/Schnoor also require multi-round scheme, we should start thinking now about how maybe we can leverage that work to address this problem as well. However, I'm not a cryptographer and don't have a specific solution in this area to offer.
>
> In the meantime, there are some possible measures we can take as new best practices. This is not a formal list, and I'm open to other suggestions, but each are currently relatively easy and are functional with some existing wallets that CAN support state. Let us get it right with stateful wallets, then we can return back to better best practices for stateless wallets like Trezor, Ledger, etc.
>
> A) We should accept that users must to backup their multisig account maps (descriptor with only xpubs) along with their cosigner key material to be able to recover funds. In the Airgap Community we make this very easy with a simple UR code that works efficiently as a QR. I personally keep multiple copies of this account map in multiple locations, as it is less of a risk (mostly privacy) if one of the locations is compromised.
>
> B) Cosigner wallets and transaction coordinator services should not share the master xpub, only the derived co-signer xpubs required for that specific account. Currently too many libraries, wallets and coordinators only function if they get the master xpub ? these should be updated to not require them.
>
> C) In many current wallets, the master xpub fingerprint is required ? that master fingerprint is also a privacy risk and should not be used. For instance, the current practice of offering what the Airgap Community calls a `crypto-hdkey` [604b93f2/48'/1'/0'/2'] with the master fingerprint root, could instead be to only offer a single parent fingerprint [f93749a7/2'] from that grandparent master key. Thus different fingerprints can be offered for each account, and only the signer knows the actual master fingerprint and its children.
>
> D) Given C, when creating a new multisig account, a transaction coordinator may request a specific master fingerprint and/or a fixed 48' derivation xpub from a cosigner wallet, but these are only hints. If it gets back a different fingerprint or derivation, it should accept it. In the case of the Airgap Community's specifications, in our "crypto-request" we actually specifically allow for wildcard requests which makes this easy and explicit. Yes, only stateful signers can know to return an xpub something other than the fingerprint and m/48'/1'/0'/2' default, but a transaction coordinator should accept it if it receives it.
>
> E) Transaction coordinators should send the cosigner "policy" (basically the multisign descriptor without any keys in it) along with any request to derive a new xpub for that new account. Stateful wallets can use this policy to know later if they are asked to sign a PSBT that does not match this policy.
>
> F) Transaction coordinators should also send the final "account map" to all the cosigner wallets as a best practice as well. This would replace the temporary "policy" in D. If a PSBT request to sign using a key doesn't match the original account map, the cosigner wallet can reject it.
>
> These best practices don't solve the problem with stateless wallets like Trezor, but they are possible now with the new generation of multisig hardware and software wallets, such as Foundation Devices, CoboVault, Sparrow, Bluwallet and my Gordian reference wallet tools. We have available NOW working interoperable specifications, reference code, and example apps that support these best practices, and some are already supported by multiple wallets in the Airgapped Wallet Community hosted by Blockchain Commons at https://github.com/blockchainCommons/airgapped-Wallet-Community.
>
> I've put a copy of this rough proposal in our Airgapped Wallet Community discussion area if you have suggestions or alternative best practices.
>
> [Initial proposal for best practice to avoid XPUB reuse in multisig account creation](https://github.com/BlockchainCommons/Airgapped-Wallet-Community/discussions/53)
>
> -- Christopher Allen, Blockchain Commons
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210412/bf6756eb/attachment-0001.html>

From michaelfolkson at gmail.com  Wed Apr 14 11:58:58 2021
From: michaelfolkson at gmail.com (Michael Folkson)
Date: Wed, 14 Apr 2021 12:58:58 +0100
Subject: [bitcoin-dev] Yesterday's Taproot activation meeting on IRC
Message-ID: <CAFvNmHRDKtRmsXwGLVF+yjT=LqC_T=vVHEO9g+bCNx22pmxOkw@mail.gmail.com>

Yesterday there was a Taproot activation meeting on the
##taproot-activation Freenode channel.

The agenda was posted in advance to the mailing list by BitcoinMechanic.
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-April/018769.html

The conversation log is here:
http://gnusha.org/taproot-activation/2021-04-13.log

Discussion focused on an alternative release to Bitcoin Core with the
naming of the release not yet finalized. Some participants expressed
concern of having "Bitcoin Core" in the name e.g. "Bitcoin Core +
Taproot" as it would be confusing to users and give them the mistaken
impression that it had been signed off by Bitcoin Core maintainers.

The activation mechanism(s) for this alternative release is Speedy
Trial (BIP 8, consistent use of block height) followed by BIP 8 (1
year, LOT=true). The BIP 8 (1 year, LOT=true) is only started assuming
Taproot hasn't activated during the Speedy Trial deployment.

Draft release notes for this alternative release are here:
https://docs.google.com/document/d/1Uhn1SEDMAqQkzkPZ4B5lPTSjUFEXKPndt_oBI4eUm7A/edit?usp=sharing

The GitHub repo for this alternative release is here:
https://github.com/BitcoinActivation/bitcoin

To compare this to the most likely activation mechanism(s) in Bitcoin
Core at this point. If the Core PR #21377 is merged in its current
form then the activation mechanism in Bitcoin Core will be Speedy
Trial (BIP to be decided, mix of block height and MTP). The starttime
and timeout will use MTP and the activation point will use block
height.

The Core PR #21377 is here: https://github.com/bitcoin/bitcoin/pull/21377

In addition a BIP PR for the Core release has been opened here with
suggested finalized parameters:
https://github.com/bitcoin/bips/pull/1104

If these plans continue as is Bitcoin Core and this alternative
release won't be entirely compatible due to startheight and timeout
being defined according to MTP and block height respectively. In the
majority of cases they should both activate at the same block height
(or not activate) but there are unlikely edge cases where one
activates and one doesn't (in addition to a possible timewarp attack
on MTP).

The use of MTP in Speedy Trial for Bitcoin Core has been discussed
extensively and reviewers' opinions are summarized here:
https://github.com/bitcoin/bitcoin/pull/21377#issuecomment-818758277

>From this point on I will try to stay as neutral as I can and just
summarize the facts to keep this list informed but anyone can review
my past mailing list posts to get my personal views if you are
interested.

As a reminder anyone can host a meeting on the ##taproot-activation
channel. All they need to do is contact me to book a time slot and
ideally post an agenda to this mailing list in advance of the meeting.
That meeting host will have the ability to issue warnings and if
necessary kick participants if the meeting host feels they are
disrupting the meeting or diverting conversation from the agenda.

-- 
Michael Folkson
Email: michaelfolkson at gmail.com
Keybase: michaelfolkson
PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3

From amiti at uttarwar.org  Wed Apr 14 20:59:35 2021
From: amiti at uttarwar.org (Amiti Uttarwar)
Date: Wed, 14 Apr 2021 20:59:35 +0000
Subject: [bitcoin-dev] Proposed Improvements To addr Relay
Message-ID: <BD7C4E40-5304-4BD8-B2AC-6F72FF37AAB8@uttarwar.org>

Hi all,

I?m proposing a change to addr relay in Bitcoin Core with the intention of reducing ?addr blackholes?. At the current stage, I am most interested in understanding whether this change would have negative consequences for other software on the network. 

Exposure to a diverse set of addresses is important for nodes to be protected against network partitions or eclipse attacks. Ensuring addr messages propagate well is fundamental to the success of the network. In the Bitcoin p2p protocol, there are two main ways for nodes to communicate about addresses: addr gossip and getaddr requests. 

Bitcoin Core will respond to a maximum of one getaddr message for each inbound peer. Thus, the main ongoing method for updating which addresses a node knows about is through addr gossip. Self-advertisements initiate a new addr message to each peer approximately once a day. When a Bitcoin Core node receives an addr message that contains 10 or fewer addresses, it will forward them to 1-2 peers. Forwarding addresses to peers who will not relay them further effectively ?blackholes? the message, reducing the ability for the addr message to successfully propagate through the network.

Although we cannot prevent addr blackholes in malicious cases, we can improve it for the more common honest cases, and reduce the overall likelihood of occurrence. Two known instances in which an honest peer would not participate in addr relay are 1. If they have opened a block-relay-only connection or 2. If they are a light client. The current blackhole behavior with block-relay-only connections is acceptable since Bitcoin Core nodes have a maximum of 2 outbound block-relay-only connections. However, improving this behavior is a prerequisite to increasing that number.

My proposal for Bitcoin Core is to identify whether or not an inbound connection is a candidate for forwarding addrs based on whether it has sent an addr related message (addr, addrv2, getaddr, sendaddrv2) over the connection. The code for this proposal can be found here: https://github.com/bitcoin/bitcoin/pull/21528. This would allow nodes to avoid sending addresses to honest connections which never intended to participate in address relay on the link. 

This proposed change in behavior could be problematic if there is software on the network that is relying on receiving addr messages, but never initiates an addr related message. (This could be easily remedied by updating the software to send a getaddr to its outbound connections.) If anyone is aware of software with this behavior, could you please point me towards it? This would be very helpful to identify if #21528 is a viable approach. 

Thank you,
Amiti

From ZmnSCPxj at protonmail.com  Fri Apr 16 03:39:27 2021
From: ZmnSCPxj at protonmail.com (ZmnSCPxj)
Date: Fri, 16 Apr 2021 03:39:27 +0000
Subject: [bitcoin-dev] Prediction Markets and Bitcoin
In-Reply-To: <MXhivQp----2@tutanota.de>
References: <MXhivQp----2@tutanota.de>
Message-ID: <y8Kg6O56gsHAibyZ_UbVSFVWXtS-77wg7H-KKhpDfL-CdGyt7KaZ5y9RDhU7kdgr8JDfkQjTtbkm4vX8UMnxAhSs0nKdt8yFhpfZmc-JBLU=@protonmail.com>

Good morning Prayank,


> I think prediction markets or such tokens might help in adding to the information we already have however they don't decide or replace anything. Bitcoin development should impact such markets and not the other way around.?

"Human behavior is economic behavior. The particulars may vary, but competition for limited resources remains a constant. Need as well as greed have followed us to the stars, and the rewards of wealth still await those wise enough to recognize this deep thrumming of our common pulse. " -- CEO Nwabudike Morgan, "The Centauri Monopoly", *Sid Meier's Alpha Centauri*

This is the tension between the necessary freedom of discovering strange new techniques, and the exigencies of life, where every joule of negentropy is a carefully measured resource.

Of course development must be free to do what is best technically, and to experiment and see what other techniques are possible or workable.
Thus the market must follow development.

Of course the people ultimately funding the development must impose what direction that development goes to, after all, it is their money that is being modified.
Thus development must follow the market.

It is the negotiation of the two that is difficult.

Overall, I think a lot of the developer arguments are reasonably clear --- what is unclear is what the market wants, thus I think prediction markets are something that are needed in order for the negotiation between these two aspects to advance.

Regards,
ZmnSCPxj

From ZmnSCPxj at protonmail.com  Fri Apr 16 03:47:45 2021
From: ZmnSCPxj at protonmail.com (ZmnSCPxj)
Date: Fri, 16 Apr 2021 03:47:45 +0000
Subject: [bitcoin-dev] PSA: Taproot loss of quantum protections
In-Reply-To: <CAH5Bsr20n2T7KRTYqycSUx0iEuEApC8NGtPCfN8rYhRyHLE4gA@mail.gmail.com>
References: <202103152148.15477.luke@dashjr.org>
 <20210316002401.zlfbc3y2s7vbrh35@ganymede>
 <CAH5Bsr20n2T7KRTYqycSUx0iEuEApC8NGtPCfN8rYhRyHLE4gA@mail.gmail.com>
Message-ID: <aRiFFJKz5wyHFDi2dXcGbNEHZD2nIwDRk7gaXIte-N1BoOEOQ-ySYRnk0P70S5igANSr2iqF2ZKV1dWvipaQHK4fJSv9A61-uH7w4pzxKRE=@protonmail.com>

Good morning LL,

> On Tue, 16 Mar 2021 at 11:25, David A. Harding via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> > I curious about whether anyone informed about ECC and QC
> > knows how to create output scripts with lower difficulty that could be
> > used to measure the progress of QC-based EC key cracking.? E.g.,
> > NUMS-based ECDSA- or taproot-compatible scripts with a security strength
> > equivalent to 80, 96, and 112 bit security.
>
> Hi Dave,
>
> This is actually relatively easy if you are willing to use a trusted setup. The trusted party takes a secp256k1 secret key and verifiably encrypt it under a NUMS public key from the weaker group. Therefore if you can crack the weaker group's public key you get the secp256k1 secret key. Camenisch-Damgard[1] cut-and-choose verifiable encryption works here.
> People then pay the secp256k1 public key funds to create the bounty. As long as the trusted party deletes the secret key afterwards the scheme is secure.
>
> Splitting the trusted setup among several parties where only one of them needs to be honest looks doable but would take some engineering and analysis work.

To simplify this, perhaps `OP_CHECKMULTISIG` is sufficient?
Simply have the N parties generate individual private keys, encrypt each of them with the NUMS pubkey from the weaker group, then pay out to an N-of-N `OP_CHECKMULTISIG` address of all the participants.
Then a single honest participant is enough to ensure security of the bounty.

Knowing the privkey from the weaker groups would then be enough to extract all of the SECP256K1 privkeys that would unlock the funds in Bitcoin.

This should reduce the need for analysis and engineering.

Regards,
ZmnSCPxj

From ZmnSCPxj at protonmail.com  Fri Apr 16 04:24:28 2021
From: ZmnSCPxj at protonmail.com (ZmnSCPxj)
Date: Fri, 16 Apr 2021 04:24:28 +0000
Subject: [bitcoin-dev] maximum block height on transaction
In-Reply-To: <CAGpPWDZHKJ8BvD3TqrvP=5pxbAc0ez-ikJmO6a51WDad1xuLSw@mail.gmail.com>
References: <5B6756D0-6BEF-4A01-BDB8-52C646916E29@friedenbach.org>
 <CAKzdR-pnvystx5H+P+OCXm73aVmWdyesCymerSgx=pCuXx+YGA@mail.gmail.com>
 <9FD4AF03-28A5-4B8A-9C12-CBCB1BC2E22C@friedenbach.org>
 <CAKzdR-r6u4J+_T5X516A=-tLWZ8zFFFsRokReiJndDE_S64OqQ@mail.gmail.com>
 <CAPg+sBi+WnzpJkcG6XACdpqqz9ZA3rHX8+H9b5eExUdgXaeiWQ@mail.gmail.com>
 <CAJowKg+kbnExgKt7H8GD6Kc-iLJEOvZhtw0uVbophhLCszvOHg@mail.gmail.com>
 <CAMZUoKmQyV67dhWS_+t1CmqNYT490_7g3WwKgxB-jiYfje+F+Q@mail.gmail.com>
 <CAD5xwhhZpQ9AQEFHgGYvPh2ad9HyQqq9WwEZje1H1siioB6eLQ@mail.gmail.com>
 <CAGpPWDZHKJ8BvD3TqrvP=5pxbAc0ez-ikJmO6a51WDad1xuLSw@mail.gmail.com>
Message-ID: <3mg9xnvKEhrXuQ5QriYQcLKmrhdYpO0hlxyRpJwZJZInyHCtva208PTZlIxglcq4afO8ftTFRBjRfG0ZEVPvIqxMJhHnFYpnPYTo_mp3qA0=@protonmail.com>

Good morning Billy,


> I've come across this argument before, and it seems kind of like Satoshi's word here is held as gospel. I haven't heard any deep discussion of this topic, and I even asked a question on the bitcoin SE about it. Sorry to hijack this conversation, but I'm very curious if there's something more to this or if the thinking was simply decided that OP_BLOCKNUMBER wasn't useful enough to warrant the (dubious) potential footgun of people accepting sub-6-block transactions from a transaction that uses an expired spend-path?

Another argument I have encountered has to do with the implementation of Bitcoin Core.

As an optimization, SCRIPT is evaluated only when a transaction enters the mempool.
It is not evaluated at any other time.
Indeed, when accepting a new block, if a transaction in that block is in the mempool, its SCRIPT is not re-evaluated.

If the max-blockheight-constraint is implemented as a SCRIPT opcode, then at each block, every SCRIPT in every transaction in the mempool must be re-evaluated, as the SCRIPT might not reject.
During times of high chain bloat, there will be large numbers of transactions in the mempool, only a tiny fraction will be removed at each block before the mempool finally clears, leading to effective O(n^2) CPU time spent (n blocks are needed in order to empty a mempool with n transactions, each block triggers re-evaluation of SCRIPT of n transactions in the mempool).
That O(n^2) assumes a single SCRIPT is O(1), which is untrue as well (but is generally approached in practice as most transactions are simple singlesig or `OP_CHECKMULTISIG` affairs).

That is, the mempool assumes that once a SCRIPT accepts, it will always accept in the future.
Thus, any SCRIPT opcode cannot change from "accept" (because at the current blockheight the max-block is not yet reached) to "reject" (because the max-block constraint is now violated).

Thus, we cannot use an opcode to impose the max-block cosntraint.

The alternative is to add a new field `maxtime` to the transaction.
Then possibly, we can have an `OP_CHECKMAXTIMEVERIFY` opcode that checks that the field has a particular value.
Then the mempool can have a separate index according to `maxtime` fields, where it can remove the indexed transactions at each block.
The index will be likely O(log n), and the filtering at each block would be O(n log n), which is an improvement.
Note in particular that the index itself would require O(n) storage.

However, adding a new field to the transaction format would require techniques similar to what was used in SegWit, i.e. post-maxtime nodes have to "baby talk" to pre-maxtime nodes and pretend transactions do not have this field, in much the same way post-SegWit nodes "baby talk" to pre-SegWit nodes and pretend transactions do not have a `witness` field.
We would then need a third Merkle Tree to hold the "really real" transaction ID that contains the `maxtime` field as well.

Thus, it seems to me that the tradeoffs are simply not good enough, when you can get 99% of what you need using just another transaction with `nLockTime`:

* Using an opcode would greatly increase CPU usage because the script cache would need to be reworked (and probably cannot be made to work).
* Adding a field would greatly increase the code complexity to the level of SegWit, without all the important bugfixes+features (tx malleability, quadratic sighash, well-defined extensible outputs) that SegWit provides.
* You can do what you want with a second `nLockTime`d transaction that spends the output anyway.

Indeed, it is helpful to realize *why* `OP_CHECKLOCKTIMEVERIFY` and `OP_CHECKSEQUENCEVERIFY` work the way they are implemented.
They are typically discussed and described as if they were imposing time-based constraints, but the *real* implementation only imposes constraints on `nLockTime` and `nSequence` fields --- the SCRIPT interpreter itself does not look at the block that the transaction is in (because that is not available, as the SCRIPT interpreter is invoked at mempool entry, when the transaction *has* no block it is contained in).
There is instead a separate layer (the entry into the mempool) that implements the *actual* time-based cosntraints, based on the fields and not the SCRIPT opcodes.

Regards,
ZmnSCPxj

>
> On Fri, Apr 9, 2021 at 5:55 AM Jeremy via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> > You could accomplish your rough goal by having:
> >
> > tx A: desired expiry at H
> > tx B: nlocktime H, use same inputs as A, create outputs equivalent to inputs (have to be sure no relative timelocks)
> >
> > Thus after a timeout the participants in A can cancel the action using TX B.
> >
> > The difference is the coins have to move, without knowing your use case this may or may not help you.?
> >
> > On Fri, Apr 9, 2021, 4:40 AM Russell O'Connor via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
> >
> > > From https://bitcointalk.org/index.php?topic=1786.msg22119#msg22119:
> > >
> > > > We can't safely do OP_BLOCKNUMBER.? In the event of a block chain reorg after a segmentation, transactions need to be able to get into the chain in a later block.? The OP_BLOCKNUMBER transaction and all its dependants would become invalid.? This wouldn't be fair to later owners of the coins who weren't involved in the time limited transaction.
> > > >
> > > > nTimeLock does the reverse.? It's an open transaction that can be replaced with new versions until the deadline.? It can't be recorded until it locks.? The highest version when the deadline hits gets recorded.? It could be used, for example, to write an escrow transaction that will automatically permanently lock and go through unless it is revoked before the deadline.? The feature isn't enabled or used yet, but the support is there so it could be implemented later.
> > >
> > > Unfortunately, limiting the maximum block height for a specific transaction would have exactly the same problem as cited above for OP_BLOCKNUMBER.
> > >
> > > On Fri, Apr 9, 2021 at 7:21 AM Erik Aronesty via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
> > >
> > > > is there any way to specify a maximum block height on a transaction?
> > > >
> > > > ie: this tx is only valid if included in a block with a certain height or less
> > > >
> > > > i feel like this would be useful
> > > > _______________________________________________
> > > > bitcoin-dev mailing list
> > > > bitcoin-dev at lists.linuxfoundation.org
> > > > https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> > >
> > > _______________________________________________
> > > bitcoin-dev mailing list
> > > bitcoin-dev at lists.linuxfoundation.org
> > > https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> >
> > _______________________________________________
> > bitcoin-dev mailing list
> > bitcoin-dev at lists.linuxfoundation.org
> > https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev



From lloyd.fourn at gmail.com  Fri Apr 16 05:00:07 2021
From: lloyd.fourn at gmail.com (Lloyd Fournier)
Date: Fri, 16 Apr 2021 15:00:07 +1000
Subject: [bitcoin-dev] PSA: Taproot loss of quantum protections
In-Reply-To: <aRiFFJKz5wyHFDi2dXcGbNEHZD2nIwDRk7gaXIte-N1BoOEOQ-ySYRnk0P70S5igANSr2iqF2ZKV1dWvipaQHK4fJSv9A61-uH7w4pzxKRE=@protonmail.com>
References: <202103152148.15477.luke@dashjr.org>
 <20210316002401.zlfbc3y2s7vbrh35@ganymede>
 <CAH5Bsr20n2T7KRTYqycSUx0iEuEApC8NGtPCfN8rYhRyHLE4gA@mail.gmail.com>
 <aRiFFJKz5wyHFDi2dXcGbNEHZD2nIwDRk7gaXIte-N1BoOEOQ-ySYRnk0P70S5igANSr2iqF2ZKV1dWvipaQHK4fJSv9A61-uH7w4pzxKRE=@protonmail.com>
Message-ID: <CAH5Bsr39kw08ki76aezJ1EM9e7mdLFLUmtKwJJNYcyuMpR_Cuw@mail.gmail.com>

On Fri, 16 Apr 2021 at 13:47, ZmnSCPxj <ZmnSCPxj at protonmail.com> wrote:

> Good morning LL,
>
> > On Tue, 16 Mar 2021 at 11:25, David A. Harding via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
> >
> > > I curious about whether anyone informed about ECC and QC
> > > knows how to create output scripts with lower difficulty that could be
> > > used to measure the progress of QC-based EC key cracking.  E.g.,
> > > NUMS-based ECDSA- or taproot-compatible scripts with a security
> strength
> > > equivalent to 80, 96, and 112 bit security.
> >
> > Hi Dave,
> >
> > This is actually relatively easy if you are willing to use a trusted
> setup. The trusted party takes a secp256k1 secret key and verifiably
> encrypt it under a NUMS public key from the weaker group. Therefore if you
> can crack the weaker group's public key you get the secp256k1 secret key.
> Camenisch-Damgard[1] cut-and-choose verifiable encryption works here.
> > People then pay the secp256k1 public key funds to create the bounty. As
> long as the trusted party deletes the secret key afterwards the scheme is
> secure.
> >
> > Splitting the trusted setup among several parties where only one of them
> needs to be honest looks doable but would take some engineering and
> analysis work.
>
> To simplify this, perhaps `OP_CHECKMULTISIG` is sufficient?
> Simply have the N parties generate individual private keys, encrypt each
> of them with the NUMS pubkey from the weaker group, then pay out to an
> N-of-N `OP_CHECKMULTISIG` address of all the participants.
> Then a single honest participant is enough to ensure security of the
> bounty.
>
> Knowing the privkey from the weaker groups would then be enough to extract
> all of the SECP256K1 privkeys that would unlock the funds in Bitcoin.


Yes! Nice idea.

Another idea that came to mind is that you could also just prove equality
between the weak group's key and the secp256k1 key. e.g. generate a 160-bit
key and use it both as a secp256k1 and a 160-bit curve key and prove
equality between them and give funds to the secp256k1 key. I implemented a
proof between ed25519 and secp256k1 a little while ago for example:
https://docs.rs/sigma_fun/0.3.0/sigma_fun/ext/dl_secp256k1_ed25519_eq/index.html

This would come with the extra assumption that it's easier to break the
160-bit key on the 160-bit curve as opposed to just breaking the 160-bit
key on the 256-bit curve. Intuitively I think this is the case but I would
want to study that further before taking this approach.

LL
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/dc5ad2f2/attachment.html>

From christopher.gilliard at gmail.com  Fri Apr 16 07:45:15 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Fri, 16 Apr 2021 07:45:15 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
Message-ID: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>

I have created a BIP which can be found here:
https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki

I'm sending this email to start the discussion regarding this proposal. If
there are any comments/suggestions, please let me know.

Regards,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/deb99d49/attachment.html>

From michaelfolkson at gmail.com  Fri Apr 16 12:16:58 2021
From: michaelfolkson at gmail.com (Michael Folkson)
Date: Fri, 16 Apr 2021 13:16:58 +0100
Subject: [bitcoin-dev] Update on Taproot activation releases
Message-ID: <CAFvNmHQf2TVVOp+rELUN2KtcshC9SSqUUMsTnkgcW-tsfYYu4g@mail.gmail.com>

I discussed in the last Taproot activation meeting notes the plans for
an alternative release to Bitcoin Core with the Speedy Trial
activation mechanism (BIP 8, consistent use of block height) followed
by a BIP 8(1 year, LOT=true). This has now been released (version 0.1)
under the name "Bitcoin Core 0.21.0-based Taproot Client".

The build is available from https://bitcointaproot.cc/ and the GitHub
repo is here: https://github.com/BitcoinActivation/bitcoin

Luke Dashjr (Bitcoin Core contributor, Bitcoin Knots, UASF) is
contributing to this release but there are a number of other
pseudonymous individuals contributing to it too. In my attempted
neutral stance I would say that it is not as thoroughly reviewed as an
upcoming Bitcoin Core release will be but if you support a consistent
use of block height (BIP 8 Speedy Trial) followed by a BIP 8 (1 year,
LOT=true) I would encourage you to review and test it. Of course there
may well be future version releases of "Bitcoin Core 0.21.0-based
Taproot Client". If you are unable to review the code yourself but you
support this effort it may be worth waiting for a future version
before running it or ensuring you update to the latest version when it
is released.

Moving onto Bitcoin Core and other alternative Bitcoin
implementations. As expected Bitcoin Core is proceeding with Speedy
Trial (mix of MTP and block height, BIP to be decided). If Speedy
Trial fails to activate on this Core release there is no follow up
activation mechanism. That is not to say there will never be one in a
Core release later in the year but as it stands there is no follow up.
Bitcoin Core PR 21377 has been merged and the activation parameters
(Bitcoin Core PR 21686) have also been merged. As discussed in my
previous email you would expect Speedy Trial to activate (or not
activate) on both Bitcoin Core and Bitcoin Core 0.21.0-based Taproot
Client. However, there is a small possibility it activates on one but
not the other. This is due to Bitcoin Core going with a mix of MTP and
block height and Bitcoin Core 0.21.0-based Taproot Client going with
consistent block height. Assuming they both activate due to Speedy
Trial they share the same activation block height of 709632
(approximately November 12th 2021). If Speedy Trial fails to activate
Bitcoin Core 0.21.0-based Taproot Client will attempt to enforce miner
signaling in November 2022 (approximately, it is defined by block
height). To be clear that is November **2022**.

There are of course alternative Bitcoin implementations to Bitcoin
Core. Jeremy Rubin has attempted to inform the maintainers of some
alternative Bitcoin implementations of the finalized activation
parameters in Core:
https://github.com/bitcoin/bips/pull/1104#issuecomment-820011540

At the time of writing Laolu Osuntokun (roasbeef, maintainer of btcd)
has ACKed the parameters and stated "I think we'll be able to get
everything reviewed+tested (likely adding signet support along the
way) by November." Piotr Narewski (maintainer of Gocoin) has also
notified that he's seen the parameters.

In terms of future meetings on the ##taproot-activation Freenode
channel there is only one meeting currently booked. That is on Tuesday
April 20th at 19:00 UTC and the meeting host will be Jeremy Rubin. The
mailing list has yet to receive an agenda but I suspect it will be
sent at some point in advance of the meeting.

As always if there are any errors or perceived bias in my attempts to
inform please respond. Ideally I would like all users to be informed
of the facts so they can make up their mind on what to run and what
they spend time reviewing and testing. Of course tensions are running
higher than normal but that is not an excuse to spread factual
inaccuracies.

-- 
Michael Folkson
Email: michaelfolkson at gmail.com
Keybase: michaelfolkson
PGP: 43ED C999 9F85 1D40 EAF4 9835 92D6 0159 214C FEE3

From roconnor at blockstream.com  Fri Apr 16 13:56:11 2021
From: roconnor at blockstream.com (Russell O'Connor)
Date: Fri, 16 Apr 2021 09:56:11 -0400
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
Message-ID: <CAMZUoKmR6ZU6mAgEhKDD5cTMuja_OC0_Sz3x4UND=E-g1PkgsQ@mail.gmail.com>

Firstly, a minor point is that your proposal is a soft-fork, not a
hard-fork.

But more importantly, adding limitations on OP_RETURN transactions is not
helpful.  Users who want to embed arbitrary data in their transactions can
always do so by encoding their data inside the values of legacy
multi-signature scriptpubkeys (pubkeys can be generated without knowing the
private key in order to encode non-key related data).  Not only can users
do this, users have done this in the past.  However, this behaviour is
problematic because such multi-signature "data" scriptpubkeys are
indistinguishable from "real" multisignature scriptpubkeys, and thus must
be kept in the UTXO set.  This differs from outputs using OP_RETURN which
are provably unspendable, and therefore can be safely omitted from the UTXO
set.

Thus, given that it is otherwise impossible to stop people from putting
arbitrary data values into their transactions, then we rather encourage
people who are going to encode their arbitrary data in transaction to use
the OP_RETURN outputs in order to avoid UTXO bloat.

Also, as it stands, fees already nudge various participants to consolidate
their data in the way that you suggest they do.

On Fri, Apr 16, 2021 at 9:32 AM Christopher Gilliard via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> I have created a BIP which can be found here:
> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>
> I'm sending this email to start the discussion regarding this proposal. If
> there are any comments/suggestions, please let me know.
>
> Regards,
> Chris
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/d620ca08/attachment-0001.html>

From clark at clarkmoody.com  Fri Apr 16 13:59:01 2021
From: clark at clarkmoody.com (Clark Moody)
Date: Fri, 16 Apr 2021 08:59:01 -0500
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
Message-ID: <CAHGSxGuKcf4j7wzzq50pknJU1jW+FtSuPhyJNqniRmaTic6k+w@mail.gmail.com>

Maybe I missed something, but why does this change require a hard fork?

You don't seem to provide any data as part of your rationale, so I'll
provide some context. As it stands, the chain size sits around 386 GB, with
OP_RETURN data accounting for 2.5 GB of that.

I'm also concerned about the coordination required to get into The One
OP_RETURN Per Block, as this certainly requires some measure of
centralization of that Merkle Tree construction.

Some of those OP_RETURN outputs have non-zero value. As such, those outputs
are provably unspendable, and they are essentially paying the rest of the
coin holders via supply deflation.

Finally, Bitcoin nodes may safely discard OP_RETURN outputs at any time,
since they are unspendable. Thus, nodes can clear a few GB of disk space
whenever they need it, but that data is less than 1% of the total chain
size at the time of writing.


-Clark


On Fri, Apr 16, 2021 at 8:32 AM Christopher Gilliard via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> I have created a BIP which can be found here:
> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>
> I'm sending this email to start the discussion regarding this proposal. If
> there are any comments/suggestions, please let me know.
>
> Regards,
> Chris
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/7954d8e1/attachment.html>

From ZmnSCPxj at protonmail.com  Fri Apr 16 14:35:31 2021
From: ZmnSCPxj at protonmail.com (ZmnSCPxj)
Date: Fri, 16 Apr 2021 14:35:31 +0000
Subject: [bitcoin-dev] Designing Bitcoin Smart Contracts with Sapio
	(available on Mainnet today)
In-Reply-To: <CAD5xwhiwYLe8-0Ya2msJY5+XrTERCS20epALpqUPXz-0FEKZTg@mail.gmail.com>
References: <CAD5xwhiwYLe8-0Ya2msJY5+XrTERCS20epALpqUPXz-0FEKZTg@mail.gmail.com>
Message-ID: <9jIB9EQTV4UY5OieVmn5P791NA3Oq3WJ2EXaG0fqscLxQx913zD6ds46YHXAie9JvKuZ0CpiRUUiXjHuosfyuzFdlQhgOUeiolZaca8_zQA=@protonmail.com>

Good morning Jeremy, et al.,


> Bitcoin Developers,
>
> I'm very excited to introduce Sapio[0] formally to you all.

This seems quite interesting to me as well!

I broadly agree with the rant on monetary units.
In C-Lightning we always (except for some legacy fields that will eventually be removed) output values as strings with an explicit `msat` unit, even for onchain values (the smallest of which are satoshi, but for consistency we always print as millisatoshi), and accept explicit `btc`, `sat`, and `msat` units.

--

Personally I would have used a non-embedded DSL.

In practice an embedded DSL requires a user to learn two languages --- the hosting language and the embedded language.
Whereas if you designed a non-embedded DSL, a new user would have to learn only one language.
For instance, if an error is emitted, then the user has to know whether the error comes from the hosting language compiler, or the embedded language implementation.

In a past career embedded DSLs for hardware description languages were being pushed, and we found that one of the drawbacks was the need to learn as well the hosting language --- at some point Haskell-embedded DSLs became so unpopular that anything that was even Haskell-related had a negative reaction in some hardware design shops.
For example BlueSpec originally was a Haskell-embedded DSL, and eventually implemented a Verilog-like syntax that was not embedded in Haskell, becoming BlueSpecSystemVerilog.

Further, as per coding theory, the hosting language is often quite generic and can talk about anything, including other embedded languages, thus we expect (all other things being equal) that in general, an utterance in an embedded DSL will be longer than an utterance in a non-embedded DSL (as there is more things to talk about, more symbols are necessary, and thus we expect things to be longer in the generic hosting language).
Whereas a non-embedded DSL can cut away most of the extra verbage needed to introduce to the hosting language implementation, in order to indicate the "entry" into the domain-specific language.

--

If my understanding is correct, I seem, that the hosting language is a full, general, Turing-complete language, that "builds up" a total (non-Turing-complete) contract description.

I have had (private) speculations before that it would be possible to design a language with two layers:

* A non-Turing-complete total "base language".
* A syntax meta-language similar to Scheme `syntax-rules`, which constructs ASTs for the "base language".

Note that Scheme `syntax-rules` is indeed Turing-complete, as a macro can expand to a form with two lists that form two "ends" of a tape, and act as a Turing machine on that tape, thus Turing-equivalent.
It is not a general language as it lacks many basic practicalities, but as pure computation, indeed it is possible to compute anything in that language.

The advantage of this scheme is that the meta-language is executed at language compile time, and the developer can see (by observing the compilation process) whether the meta-program halts or not.
However, the end-user executing the program is assured that the program, delivered as a compiled binary, will indeed terminate, as the base language is total and non-Turing-complete (i.e. the halting problem is trivial for the base language --- all programs halt).

I even have started designing a syntax scheme that adds in infix notation and indent-sensitivity to a Lisp-like syntax, at the cost of disallowing typical Lisp-like names like `pair?`, e.g.

    foo x = value (bar x)
      where
        bar x = x

is equivalent to:

    (`=` (foo x)
         (value (bar x)
                (where
                  (`=` (bar x) x))))

I can provide more details if interested.

Note that the base language is not embedded in the meta-language, as the meta-language is effectively only capable of talking about how the utterance in the base language is constructed --- the meta-language is not quite general enough (i.e. the meta-language cannot implement "Hello World").
Thus coding theory should imply that this should lead to more succinct utterances (in general).
>From this point of view, language design is about striking a balance between the low input bandwidth of neurotypical human brains (thus compression is needed, i.e. the language encourages succinct programs) and the limited processing power of neurotypical human brains (thus decompression speed is needed, i.e. it should be obvious what something expands to).


Regards,
ZmnSCPxj

From christopher.gilliard at gmail.com  Fri Apr 16 15:33:40 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Fri, 16 Apr 2021 15:33:40 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAHGSxGuKcf4j7wzzq50pknJU1jW+FtSuPhyJNqniRmaTic6k+w@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAHGSxGuKcf4j7wzzq50pknJU1jW+FtSuPhyJNqniRmaTic6k+w@mail.gmail.com>
Message-ID: <CAK=nyAwLVZEj_=hg2owFPSTgxcBakq7viWshjj_Zdj8ph2w1VA@mail.gmail.com>

>>Maybe I missed something, but why does this change require a hard fork?

I guess you are right that it doesn't technically require a hard fork, but
I see this proposal as more likely being merged with other hard fork or
soft fork features. It depends on which upgrades are happening at the time.
If there's a specific soft fork being proposed to merge this proposal with,
I can update it.

>> I'm also concerned about the coordination required to get into The One
OP_RETURN Per Block, as this certainly requires some measure of
centralization of that Merkle Tree construction.

This will be discussed further in a future BIP, but the basic idea is that
each miner can run an additional piece of software that builds the tree
structure. It's much like submitting a transaction to the network today, if
one of the miners does not accept it, another likely will.

>> Some of those OP_RETURN outputs have non-zero value. As such, those
outputs are provably unspendable, and they are essentially paying the rest
of the coin holders via supply deflation.

Good point, there are other ways to do proof of burn.

>> Finally, Bitcoin nodes may safely discard OP_RETURN outputs at any time,
since they are unspendable. Thus, nodes can clear a few GB of disk space
whenever they need it, but that data is less than 1% of the total chain
size at the time of writing.

Yes, but that doesn't affect IBD.

On Fri, Apr 16, 2021 at 1:59 PM Clark Moody <clark at clarkmoody.com> wrote:

> Maybe I missed something, but why does this change require a hard fork?
>
> You don't seem to provide any data as part of your rationale, so I'll
> provide some context. As it stands, the chain size sits around 386 GB, with
> OP_RETURN data accounting for 2.5 GB of that.
>
> I'm also concerned about the coordination required to get into The One
> OP_RETURN Per Block, as this certainly requires some measure of
> centralization of that Merkle Tree construction.
>
> Some of those OP_RETURN outputs have non-zero value. As such, those
> outputs are provably unspendable, and they are essentially paying the rest
> of the coin holders via supply deflation.
>
> Finally, Bitcoin nodes may safely discard OP_RETURN outputs at any time,
> since they are unspendable. Thus, nodes can clear a few GB of disk space
> whenever they need it, but that data is less than 1% of the total chain
> size at the time of writing.
>
>
> -Clark
>
>
> On Fri, Apr 16, 2021 at 8:32 AM Christopher Gilliard via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> I have created a BIP which can be found here:
>> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>>
>> I'm sending this email to start the discussion regarding this proposal.
>> If there are any comments/suggestions, please let me know.
>>
>> Regards,
>> Chris
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/0bb514ec/attachment-0001.html>

From christopher.gilliard at gmail.com  Fri Apr 16 15:34:33 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Fri, 16 Apr 2021 15:34:33 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAMZUoKmR6ZU6mAgEhKDD5cTMuja_OC0_Sz3x4UND=E-g1PkgsQ@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAMZUoKmR6ZU6mAgEhKDD5cTMuja_OC0_Sz3x4UND=E-g1PkgsQ@mail.gmail.com>
Message-ID: <CAK=nyAz5+yMUA=XDcunA1eeachSisaJoYE2_yzTLj=B0r4=w5A@mail.gmail.com>

>> But more importantly, adding limitations on OP_RETURN transactions is
not helpful.  Users who want to embed arbitrary data in their transactions
can always do so by encoding their data inside the values of legacy
multi-signature scriptpubkeys (pubkeys can be generated without knowing the
private key in order to encode non-key related data).  Not only can users
do this, users have done this in the past.  However, this behaviour is
problematic because such multi-signature "data" scriptpubkeys are
indistinguishable from "real" multisignature scriptpubkeys, and thus must
be kept in the UTXO set.  This differs from outputs using OP_RETURN which
are provably unspendable, and therefore can be safely omitted from the UTXO
set.

This sounds like a good justification to remove the legacy multi-signature
capabilities as well.

>> Thus, given that it is otherwise impossible to stop people from putting
arbitrary data values into their transactions, then we rather encourage
people who are going to encode their arbitrary data in transaction to use
the OP_RETURN outputs in order to avoid UTXO bloat.

You can't make it completely impossible to do that, but you can make it
harder and at the same time you can provide a solution for doing what they
want to do.

On Fri, Apr 16, 2021 at 1:56 PM Russell O'Connor <roconnor at blockstream.com>
wrote:

> Firstly, a minor point is that your proposal is a soft-fork, not a
> hard-fork.
>
> But more importantly, adding limitations on OP_RETURN transactions is not
> helpful.  Users who want to embed arbitrary data in their transactions can
> always do so by encoding their data inside the values of legacy
> multi-signature scriptpubkeys (pubkeys can be generated without knowing the
> private key in order to encode non-key related data).  Not only can users
> do this, users have done this in the past.  However, this behaviour is
> problematic because such multi-signature "data" scriptpubkeys are
> indistinguishable from "real" multisignature scriptpubkeys, and thus must
> be kept in the UTXO set.  This differs from outputs using OP_RETURN which
> are provably unspendable, and therefore can be safely omitted from the UTXO
> set.
>
> Thus, given that it is otherwise impossible to stop people from putting
> arbitrary data values into their transactions, then we rather encourage
> people who are going to encode their arbitrary data in transaction to use
> the OP_RETURN outputs in order to avoid UTXO bloat.
>
> Also, as it stands, fees already nudge various participants to consolidate
> their data in the way that you suggest they do.
>
> On Fri, Apr 16, 2021 at 9:32 AM Christopher Gilliard via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> I have created a BIP which can be found here:
>> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>>
>> I'm sending this email to start the discussion regarding this proposal.
>> If there are any comments/suggestions, please let me know.
>>
>> Regards,
>> Chris
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/ac1b035a/attachment.html>

From apoelstra at wpsoftware.net  Fri Apr 16 15:55:47 2021
From: apoelstra at wpsoftware.net (Andrew Poelstra)
Date: Fri, 16 Apr 2021 15:55:47 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAz5+yMUA=XDcunA1eeachSisaJoYE2_yzTLj=B0r4=w5A@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAMZUoKmR6ZU6mAgEhKDD5cTMuja_OC0_Sz3x4UND=E-g1PkgsQ@mail.gmail.com>
 <CAK=nyAz5+yMUA=XDcunA1eeachSisaJoYE2_yzTLj=B0r4=w5A@mail.gmail.com>
Message-ID: <YHmzg15MAzHLRC5p@camus>

On Fri, Apr 16, 2021 at 03:34:33PM +0000, Christopher Gilliard via bitcoin-dev wrote:
> This sounds like a good justification to remove the legacy multi-signature
> capabilities as well.
>

Doing so would confiscate coins, and also it is impossible to remove
legacy multisignatures in general without gutting almost all of Script.
 
> >> Thus, given that it is otherwise impossible to stop people from putting
> arbitrary data values into their transactions, then we rather encourage
> people who are going to encode their arbitrary data in transaction to use
> the OP_RETURN outputs in order to avoid UTXO bloat.
> 
> You can't make it completely impossible to do that, but you can make it
> harder and at the same time you can provide a solution for doing what they
> want to do.
>

I don't think you can even make it harder in a meaningful sense. There is
too much flexibility in transaction data.
 
-- 
Andrew Poelstra
Director of Research, Blockstream
Email: apoelstra at wpsoftware.net
Web:   https://www.wpsoftware.net/andrew

The sun is always shining in space
    -Justin Lewis-Webster


From jlrubin at mit.edu  Fri Apr 16 16:32:13 2021
From: jlrubin at mit.edu (Jeremy)
Date: Fri, 16 Apr 2021 09:32:13 -0700
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
Message-ID: <CAD5xwhiAPkxRxvgJNU3uG7LLToa-+9j7CdXYWvOYOpZKz-p7Hw@mail.gmail.com>

NACK -- I happen to have a vault where I made emergency backup pre-signed
transactions containing two OP_RETURN outputs and have subsequently lost
the private key in an unfortunate boating incident.

This proposed rule change would serve to confiscate my funds.
--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>


On Fri, Apr 16, 2021 at 6:32 AM Christopher Gilliard via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> I have created a BIP which can be found here:
> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>
> I'm sending this email to start the discussion regarding this proposal. If
> there are any comments/suggestions, please let me know.
>
> Regards,
> Chris
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/c25d7fb1/attachment.html>

From christopher.gilliard at gmail.com  Fri Apr 16 17:05:12 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Fri, 16 Apr 2021 17:05:12 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAD5xwhiAPkxRxvgJNU3uG7LLToa-+9j7CdXYWvOYOpZKz-p7Hw@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAD5xwhiAPkxRxvgJNU3uG7LLToa-+9j7CdXYWvOYOpZKz-p7Hw@mail.gmail.com>
Message-ID: <CAK=nyAwbWbEkL29J-teW-NJ+28pgrCVEvP5csH65uzCWfP=9KA@mail.gmail.com>

Hah! Very funny! ? I am certain that this proposal can be implemented in a
way that doesn't confiscate your "long lost" stash and I may even be
willing to fund a bounty for a deep sea diving expedition to find those
keys for a unit test.

On Fri, Apr 16, 2021 at 4:32 PM Jeremy <jlrubin at mit.edu> wrote:

> NACK -- I happen to have a vault where I made emergency backup pre-signed
> transactions containing two OP_RETURN outputs and have subsequently lost
> the private key in an unfortunate boating incident.
>
> This proposed rule change would serve to confiscate my funds.
> --
> @JeremyRubin <https://twitter.com/JeremyRubin>
> <https://twitter.com/JeremyRubin>
>
>
> On Fri, Apr 16, 2021 at 6:32 AM Christopher Gilliard via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> I have created a BIP which can be found here:
>> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>>
>> I'm sending this email to start the discussion regarding this proposal.
>> If there are any comments/suggestions, please let me know.
>>
>> Regards,
>> Chris
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/2a3f793d/attachment-0001.html>

From jlrubin at mit.edu  Fri Apr 16 18:00:29 2021
From: jlrubin at mit.edu (Jeremy)
Date: Fri, 16 Apr 2021 11:00:29 -0700
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAwbWbEkL29J-teW-NJ+28pgrCVEvP5csH65uzCWfP=9KA@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAD5xwhiAPkxRxvgJNU3uG7LLToa-+9j7CdXYWvOYOpZKz-p7Hw@mail.gmail.com>
 <CAK=nyAwbWbEkL29J-teW-NJ+28pgrCVEvP5csH65uzCWfP=9KA@mail.gmail.com>
Message-ID: <CAD5xwhgFduuvJ22PhPat-RFYJ3swAhJyJxRufAGOJcQBe2+Y2A@mail.gmail.com>

For every workaround, someone may have a long lost stash that you'd be
confiscating :)

https://bitcoin.stackexchange.com/questions/90127/why-does-this-coinbase-transaction-have-two-op-return-outputs
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/cb1a5535/attachment.html>

From jlrubin at mit.edu  Fri Apr 16 18:12:10 2021
From: jlrubin at mit.edu (Jeremy)
Date: Fri, 16 Apr 2021 11:12:10 -0700
Subject: [bitcoin-dev] Designing Bitcoin Smart Contracts with Sapio
 (available on Mainnet today)
In-Reply-To: <9jIB9EQTV4UY5OieVmn5P791NA3Oq3WJ2EXaG0fqscLxQx913zD6ds46YHXAie9JvKuZ0CpiRUUiXjHuosfyuzFdlQhgOUeiolZaca8_zQA=@protonmail.com>
References: <CAD5xwhiwYLe8-0Ya2msJY5+XrTERCS20epALpqUPXz-0FEKZTg@mail.gmail.com>
 <9jIB9EQTV4UY5OieVmn5P791NA3Oq3WJ2EXaG0fqscLxQx913zD6ds46YHXAie9JvKuZ0CpiRUUiXjHuosfyuzFdlQhgOUeiolZaca8_zQA=@protonmail.com>
Message-ID: <CAD5xwhgObtgYvynO6xRCF1pJGA7VN78ZnytxSkmoJipkO31YzA@mail.gmail.com>

Hi ZmnSCPxj,

Funny you mention BlueSpec -- I actually took 6.175[1] in my undergraduate
studies with Arvind, BlueSpec's creator, and have often cited it as an
inspiration for Sapio given that the target of program compilation is
essentially a transaction circuit and I have a decent amount of experience
working in BlueSpec.

It's entirely the point that Sapio program expansion is Turing complete
whereas the resultant program is "fixed". Via updatable finish clauses
(which require some signature) it's also possible to track the logic for
what states should be generated upon cooperation of parties, making Sapio
turing complete description language for federated operators. I've
previously described it as follows:

*But how is Sapio different from Miniscript? From Solidity? A metaphor that
I like is that tools like Miniscript operate at the physical-key level
(house keys, car keys, train pass, office key). Sapio operates at the
commute level. Miniscript answers, "how do I unlock my car? How do I pay
for the train? How do I get in my office?"*. *Sapio lets you specify that,
"my morning commute is to leave my house, go to my car, start it and drive
to the office, and park in the lot; OR go to the train station, use the
train pass to pay fare, take the train for an hour, then* *walk 3 blocks
north to my  office; and in either case unlock the office door, and enter".
Sapio has plans to integrate Miniscript as it stabilizes *[currently
integrated]* as the backend key description language. Solidity and Sapio
are more similar. Sapio's metaprogramming language is Turing Complete and
allows you to specify a rich set of constraints for the contract you're
building, but can only ever produce a finite deterministic "binary" of
transactions. Solidity on the other hand compiles deterministically, but
the executed binary is Turing Complete. Further, Sapio contracts are
"stateless", whereas Solidity has mutable state. Lastly, Solidity contracts
are non-isolated from one another in the EVM. In Sapio, contracts execute
only with the components you specify in scope. In sum, Sapio has a rich
descriptive power for smart contract programming flows but a limited and
safe execution semantics.*


The DSL v.s. e-DSL is a great question, and while there are surely benefits
to being a full-fledged standalone DSL, here's why the e-DSL approach is
superior for everything Sapio cares about.

Sapio is built as a shallow e-DSL in Rust. Everything in Sapio can be
expressed (macro free -- they're relatively light conveniences) as pure
rust. There's also a more "API Like" interface where Sapio objects can be
built out dynamically by other rust code easily. This means that if you
wanted to come up with a custom DSL for a subset of Sapio programs, you
could still very easily target Sapio (at runtime) as the AST processor.
Said "SapioScript" can be an entirely separate crate targeting this base.

This is also nice because it keeps the Sapio core codebase relatively tight
compared to what would be required were Sapio to be a "full language", and
have tens of thousands of lines of custom lexing, parsing, type systems,
etc etc.

Yes, you have to learn Rust, but Rust is one of the most popular languages
for systems programming. It means that there's a library for almost any
functionality you could want. There's tooling for building for any platform
-- Sapio targets WASM happily, which helps with compile-once run sandboxed
anywhere (this really helps for using Sapio as a replicated state machine
for channels).

I agree with you that Haskell was previously a limiting factor for
BlueSpec, but Rust is not Haskell. Rust is incredibly popular, and easier
to learn (author's opinion) than Haskell, C++, or even Python (perhaps
biased, but I always struggled with python for more than simple scripts
knowing when objects were copied or referenced -- an initial version of
Sapio was in python, but that codebase collapsed under its own
complexity... and I had *great* MyPy coverage). It's certainly easier to
learn Rust than to learn Sapio as a DSL -- Sapio requires learning an
entirely novel way of thinking about structuring programs already, a DSL
would require learning both the "Sapio Programming Model" and "The Sapio
DSL". With embedded Rust, you can transfer all existing knowledge on Rust
programming and add a veneer of Sapio.

Further Sapio is designed to not just compile to smart contracts as Bitcoin
addresses, but be able to be deeply integrated inside of an application.
For example, suppose you wanted to fetch keys for a contract from a
database, query a network oracle for a state resolution, or something else.
A DSL would scope creep infinitely or require numerous hacks, and at that
point we're largely better off benefitting from the larger Rust community's
efforts at providing excellent APIs for any task.

Therefore to make Sapio functional for building and deploying real bitcoin
smart contract applications, a rust eDSL was not just the natural, it was
the only choice.

W.r.t. to succinctness and "extra concepts" I'll admit that there is some
disadvantage to Rust. There's a borrow checker -- which can be mostly
defeated if you don't care about performance with Arc / Clone. You have to
manually impl some traits -- but the trait system ends up not being bloat,
but central to making contract state machines
https://learn.sapio-lang.org/ch08-01-state-machines.html. And if you do
actually look at the Sapio programs themselves, they are still quite
succinct comparatively. I can imagine them being a bit shorter, but I think
optimizing for the shortest possible utterance is an anti-goal for safety
-- I aim for clarity. And that's where I don't exactly hate the borrow
checker, since it makes it easier to tell when sub-contracts are using the
same or modified data.

Best,

Jeremy

[1] http://csg.csail.mit.edu/6.175/archive/2014/index.html
--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>


On Fri, Apr 16, 2021 at 7:36 AM ZmnSCPxj <ZmnSCPxj at protonmail.com> wrote:

> Good morning Jeremy, et al.,
>
>
> > Bitcoin Developers,
> >
> > I'm very excited to introduce Sapio[0] formally to you all.
>
> This seems quite interesting to me as well!
>
> I broadly agree with the rant on monetary units.
> In C-Lightning we always (except for some legacy fields that will
> eventually be removed) output values as strings with an explicit `msat`
> unit, even for onchain values (the smallest of which are satoshi, but for
> consistency we always print as millisatoshi), and accept explicit `btc`,
> `sat`, and `msat` units.
>
> --
>
> Personally I would have used a non-embedded DSL.
>
> In practice an embedded DSL requires a user to learn two languages --- the
> hosting language and the embedded language.
> Whereas if you designed a non-embedded DSL, a new user would have to learn
> only one language.
> For instance, if an error is emitted, then the user has to know whether
> the error comes from the hosting language compiler, or the embedded
> language implementation.
>
> In a past career embedded DSLs for hardware description languages were
> being pushed, and we found that one of the drawbacks was the need to learn
> as well the hosting language --- at some point Haskell-embedded DSLs became
> so unpopular that anything that was even Haskell-related had a negative
> reaction in some hardware design shops.
> For example BlueSpec originally was a Haskell-embedded DSL, and eventually
> implemented a Verilog-like syntax that was not embedded in Haskell,
> becoming BlueSpecSystemVerilog.
>
> Further, as per coding theory, the hosting language is often quite generic
> and can talk about anything, including other embedded languages, thus we
> expect (all other things being equal) that in general, an utterance in an
> embedded DSL will be longer than an utterance in a non-embedded DSL (as
> there is more things to talk about, more symbols are necessary, and thus we
> expect things to be longer in the generic hosting language).
> Whereas a non-embedded DSL can cut away most of the extra verbage needed
> to introduce to the hosting language implementation, in order to indicate
> the "entry" into the domain-specific language.
>
> --
>
> If my understanding is correct, I seem, that the hosting language is a
> full, general, Turing-complete language, that "builds up" a total
> (non-Turing-complete) contract description.
>
> I have had (private) speculations before that it would be possible to
> design a language with two layers:
>
> * A non-Turing-complete total "base language".
> * A syntax meta-language similar to Scheme `syntax-rules`, which
> constructs ASTs for the "base language".
>
> Note that Scheme `syntax-rules` is indeed Turing-complete, as a macro can
> expand to a form with two lists that form two "ends" of a tape, and act as
> a Turing machine on that tape, thus Turing-equivalent.
> It is not a general language as it lacks many basic practicalities, but as
> pure computation, indeed it is possible to compute anything in that
> language.
>
> The advantage of this scheme is that the meta-language is executed at
> language compile time, and the developer can see (by observing the
> compilation process) whether the meta-program halts or not.
> However, the end-user executing the program is assured that the program,
> delivered as a compiled binary, will indeed terminate, as the base language
> is total and non-Turing-complete (i.e. the halting problem is trivial for
> the base language --- all programs halt).
>
> I even have started designing a syntax scheme that adds in infix notation
> and indent-sensitivity to a Lisp-like syntax, at the cost of disallowing
> typical Lisp-like names like `pair?`, e.g.
>
>     foo x = value (bar x)
>       where
>         bar x = x
>
> is equivalent to:
>
>     (`=` (foo x)
>          (value (bar x)
>                 (where
>                   (`=` (bar x) x))))
>
> I can provide more details if interested.
>
> Note that the base language is not embedded in the meta-language, as the
> meta-language is effectively only capable of talking about how the
> utterance in the base language is constructed --- the meta-language is not
> quite general enough (i.e. the meta-language cannot implement "Hello
> World").
> Thus coding theory should imply that this should lead to more succinct
> utterances (in general).
> From this point of view, language design is about striking a balance
> between the low input bandwidth of neurotypical human brains (thus
> compression is needed, i.e. the language encourages succinct programs) and
> the limited processing power of neurotypical human brains (thus
> decompression speed is needed, i.e. it should be obvious what something
> expands to).
>
>
> Regards,
> ZmnSCPxj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/50e42fbb/attachment-0001.html>

From kkarasavvas at gmail.com  Fri Apr 16 19:15:28 2021
From: kkarasavvas at gmail.com (Kostas Karasavvas)
Date: Fri, 16 Apr 2021 22:15:28 +0300
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
Message-ID: <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>

Hi Christopher,

Some feedback:

"OP_RETURN is limited to 40 bytes of data."
It is 80 bytes.

"A future BIP proposing such a layer two protocol will be forthcoming."
So what is this BIP about? Just saying that it would be a nice idea? This
BIP should be the one that would go through this L2 suggestion. If one root
OP_RETURN substitutes all the rest it should say how that would be done...
where would the merkle proofs be stored, what are the trust
assumptions that we need to make, etc.

"Objections to this proposal" section
I agree with others re hard-fork, which would be a good thing of course.
My main objection with this proposal is that I don't see a proposal. It
seems like wishful thinking... if only we could substitute all the
OP_RETURNs with one :-)

We have to make sure that a proposal like this (L2, etc.) would make sure
that there are incentives that justify the added complexity for the users.
Multisig is not the only way data could be stored the wrong way; P2PK,
P2PKH, P2SH, P2WPKH, P2WSH can also be used. If the incentives are not good
enough people would start using these UTXO-bloat-heavy alternatives.

There are a multitude of L2's (kind-of) that do this 'aggregation' of data
hashes using merkle trees. Factom is adding a single merkle root per
bitcoin block for the millions upon millions of records (of thousand of
users) that they keep in their network. Opentimestamps, tierion,
blockstacks and others do a similar thing. I have investigated several of
those in the past, for one of my projects, but I ended up using plain old
OP_RETURN because the overhead of their (L2-like) solution and trust
assumptions where not to my liking; at least for my use case. They were
pretty solid/useful for other use cases.

Unless the proposed L2 is flexible/generic enough it would really prohibit
this L2 innovation that OP_RETURN allowed (see above).



On Fri, Apr 16, 2021 at 4:32 PM Christopher Gilliard via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> I have created a BIP which can be found here:
> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>
> I'm sending this email to start the discussion regarding this proposal. If
> there are any comments/suggestions, please let me know.
>
> Regards,
> Chris
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>


-- 
Konstantinos A. Karasavvas
Software Architect, Blockchain Engineer, Researcher, Educator
https://twitter.com/kkarasavvas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/7a11fc7d/attachment.html>

From christopher.gilliard at gmail.com  Fri Apr 16 20:12:07 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Fri, 16 Apr 2021 20:12:07 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
Message-ID: <CAK=nyAxfAY7Ob64XR+5E6uSv+0BcUsuVZUzNbNZBcUnRf1XY9Q@mail.gmail.com>

Thanks for the feedback. Will update the 40 bytes to 80 bytes (40 bytes was
the previous value, but it has since been updated to 80 so that's correct).
Regarding the L2 proposal. I think the BIPs I am working on will address
your questions and I'm hoping to have two more out early next week so
please stay tuned. I'm open to merging those BIPs into this BIP or
vice-versa, but for the sake of making things more readable I broke them
down into several BIPs for the time being.

On Fri, Apr 16, 2021 at 7:15 PM Kostas Karasavvas <kkarasavvas at gmail.com>
wrote:

> Hi Christopher,
>
> Some feedback:
>
> "OP_RETURN is limited to 40 bytes of data."
> It is 80 bytes.
>
> "A future BIP proposing such a layer two protocol will be forthcoming."
> So what is this BIP about? Just saying that it would be a nice idea? This
> BIP should be the one that would go through this L2 suggestion. If one root
> OP_RETURN substitutes all the rest it should say how that would be done...
> where would the merkle proofs be stored, what are the trust
> assumptions that we need to make, etc.
>
> "Objections to this proposal" section
> I agree with others re hard-fork, which would be a good thing of course.
> My main objection with this proposal is that I don't see a proposal. It
> seems like wishful thinking... if only we could substitute all the
> OP_RETURNs with one :-)
>
> We have to make sure that a proposal like this (L2, etc.) would make sure
> that there are incentives that justify the added complexity for the users.
> Multisig is not the only way data could be stored the wrong way; P2PK,
> P2PKH, P2SH, P2WPKH, P2WSH can also be used. If the incentives are not good
> enough people would start using these UTXO-bloat-heavy alternatives.
>
> There are a multitude of L2's (kind-of) that do this 'aggregation' of data
> hashes using merkle trees. Factom is adding a single merkle root per
> bitcoin block for the millions upon millions of records (of thousand of
> users) that they keep in their network. Opentimestamps, tierion,
> blockstacks and others do a similar thing. I have investigated several of
> those in the past, for one of my projects, but I ended up using plain old
> OP_RETURN because the overhead of their (L2-like) solution and trust
> assumptions where not to my liking; at least for my use case. They were
> pretty solid/useful for other use cases.
>
> Unless the proposed L2 is flexible/generic enough it would really prohibit
> this L2 innovation that OP_RETURN allowed (see above).
>
>
>
> On Fri, Apr 16, 2021 at 4:32 PM Christopher Gilliard via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> I have created a BIP which can be found here:
>> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>>
>> I'm sending this email to start the discussion regarding this proposal.
>> If there are any comments/suggestions, please let me know.
>>
>> Regards,
>> Chris
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
>
>
> --
> Konstantinos A. Karasavvas
> Software Architect, Blockchain Engineer, Researcher, Educator
> https://twitter.com/kkarasavvas
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/33566e5b/attachment-0001.html>

From rsomsen at gmail.com  Fri Apr 16 20:30:06 2021
From: rsomsen at gmail.com (Ruben Somsen)
Date: Fri, 16 Apr 2021 22:30:06 +0200
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
Message-ID: <CAPv7Tja=4ZFm5+gHw+wMcZyPEqeQiVx-AjyXsRn0T8a+tXHb1A@mail.gmail.com>

Hi Chris,

I agree with all the points that were made by others. You should also be
aware that layer two ideas like yours have already been explored, both by
myself and others. Allowing one hash per block allows for what I call
"fee-bidding Blind Merged-Mining" (BMM), which as far as I know was first
proposed by Paul Storc for Drivechains.[0]

If only one hash is allowed per block, then those who wish to utilize the
hash will have to out-bid each other ("fee-bidding"). This hash can then be
used to create another chain ("merged-mining"), while the Bitcoin miners do
not have to be aware of this other chain ("blind"). There are also non
fee-bidding variants that function e.g. by burning or locking up bitcoins
in order to create consensus.

As it turns out, fee-bidding BMM can be achieved using only a covenant
structure for transactions.[1] You'd have to create a sequence of
transactions (one per block), to which a hash can be attached. These can
simply be pre-signed transactions (requires forgetting a key, but the worst
that can happen is that the chain halts), or an actual covenant using
either sighash_anyprevout or op_ctv (we don't have these yet) ? no
specialized soft fork (or hard fork) is required.

You might think any decentralized alternative chain requires an altcoin,
but this can also be avoided with a perpetual one-way peg.[2] For more
details, I recommend watching this video of the full concept, which I call
"spacechains": https://youtu.be/N2ow4Q34Jeg

-- Ruben Somsen



[0] Blind Merged-Mining for Drivechains:
https://github.com/bitcoin/bips/blob/master/bip-0301.mediawiki

[1] Fee-bidding Blind Merged-Mining with covenants:
https://gist.github.com/RubenSomsen/5e4be6d18e5fa526b17d8b34906b16a5

[2] Perpetual one-way peg:
https://medium.com/@RubenSomsen/21-million-bitcoins-to-rule-all-sidechains-the-perpetual-one-way-peg-96cb2f8ac302

On Fri, Apr 16, 2021 at 9:33 PM Kostas Karasavvas via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Hi Christopher,
>
> Some feedback:
>
> "OP_RETURN is limited to 40 bytes of data."
> It is 80 bytes.
>
> "A future BIP proposing such a layer two protocol will be forthcoming."
> So what is this BIP about? Just saying that it would be a nice idea? This
> BIP should be the one that would go through this L2 suggestion. If one root
> OP_RETURN substitutes all the rest it should say how that would be done...
> where would the merkle proofs be stored, what are the trust
> assumptions that we need to make, etc.
>
> "Objections to this proposal" section
> I agree with others re hard-fork, which would be a good thing of course.
> My main objection with this proposal is that I don't see a proposal. It
> seems like wishful thinking... if only we could substitute all the
> OP_RETURNs with one :-)
>
> We have to make sure that a proposal like this (L2, etc.) would make sure
> that there are incentives that justify the added complexity for the users.
> Multisig is not the only way data could be stored the wrong way; P2PK,
> P2PKH, P2SH, P2WPKH, P2WSH can also be used. If the incentives are not good
> enough people would start using these UTXO-bloat-heavy alternatives.
>
> There are a multitude of L2's (kind-of) that do this 'aggregation' of data
> hashes using merkle trees. Factom is adding a single merkle root per
> bitcoin block for the millions upon millions of records (of thousand of
> users) that they keep in their network. Opentimestamps, tierion,
> blockstacks and others do a similar thing. I have investigated several of
> those in the past, for one of my projects, but I ended up using plain old
> OP_RETURN because the overhead of their (L2-like) solution and trust
> assumptions where not to my liking; at least for my use case. They were
> pretty solid/useful for other use cases.
>
> Unless the proposed L2 is flexible/generic enough it would really prohibit
> this L2 innovation that OP_RETURN allowed (see above).
>
>
>
> On Fri, Apr 16, 2021 at 4:32 PM Christopher Gilliard via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> I have created a BIP which can be found here:
>> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>>
>> I'm sending this email to start the discussion regarding this proposal.
>> If there are any comments/suggestions, please let me know.
>>
>> Regards,
>> Chris
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
>
>
> --
> Konstantinos A. Karasavvas
> Software Architect, Blockchain Engineer, Researcher, Educator
> https://twitter.com/kkarasavvas
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/1f3a90a5/attachment-0001.html>

From erik at q32.com  Fri Apr 16 20:48:35 2021
From: erik at q32.com (Erik Aronesty)
Date: Fri, 16 Apr 2021 16:48:35 -0400
Subject: [bitcoin-dev] Gradual transition to an alternate proof without a
	hard fork.
Message-ID: <CAJowKgJNefXZTCJk_EK4JC7uPKsTrGv=yUROpjL_7GGbfNrrvA@mail.gmail.com>

Not sure of the best place to workshop ideas, so please take this with
a grain of salt.

Starting with 3 assumptions:

- assume that there exists a proof-of-burn that, for Bitcoin's
purposes, accurately-enough models the investment in and development
of ASICs to maintain miner incentive.
- assume the resulting timing problem "how much burn is enough to keep
blocks 10 minutes apart and what does that even mean"  is also...
perfectly solvable
- assume "everyone unanimously loves this idea"

The transition *could* look like this:

 - validating nodes begin to require proof-of-burn, in addition to
proof-of-work (soft fork)
 - the extra expense makes it more expensive for miners, so POW slowly drops
 - on a predefined schedule, POB required is increased to 100% of the
"required work" to mine

Given all of that, am I correct in thinking that a hard fork would not
be necessary?

IE: We could transition to another "required proof" - such as a
quantum POW or a POB (above) or something else ....  in a back-compat
way (existing nodes not aware of the rules would continue to
validate).

From jlrubin at mit.edu  Fri Apr 16 21:24:30 2021
From: jlrubin at mit.edu (Jeremy)
Date: Fri, 16 Apr 2021 14:24:30 -0700
Subject: [bitcoin-dev] Gradual transition to an alternate proof without
 a hard fork.
In-Reply-To: <CAJowKgJNefXZTCJk_EK4JC7uPKsTrGv=yUROpjL_7GGbfNrrvA@mail.gmail.com>
References: <CAJowKgJNefXZTCJk_EK4JC7uPKsTrGv=yUROpjL_7GGbfNrrvA@mail.gmail.com>
Message-ID: <CAD5xwhjWHsEZjTKJA3e+mwKZxuXf043jKvqDG4_hYRhd1jR07g@mail.gmail.com>

I think you need to hard deprecate the PoW for this to work, otherwise all
old miners are like "toxic waste".

Imagine one miner turns on a S9 and then ramps up difficulty for everyone
else.

On Fri, Apr 16, 2021, 2:08 PM Erik Aronesty via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Not sure of the best place to workshop ideas, so please take this with
> a grain of salt.
>
> Starting with 3 assumptions:
>
> - assume that there exists a proof-of-burn that, for Bitcoin's
> purposes, accurately-enough models the investment in and development
> of ASICs to maintain miner incentive.
> - assume the resulting timing problem "how much burn is enough to keep
> blocks 10 minutes apart and what does that even mean"  is also...
> perfectly solvable
> - assume "everyone unanimously loves this idea"
>
> The transition *could* look like this:
>
>  - validating nodes begin to require proof-of-burn, in addition to
> proof-of-work (soft fork)
>  - the extra expense makes it more expensive for miners, so POW slowly
> drops
>  - on a predefined schedule, POB required is increased to 100% of the
> "required work" to mine
>
> Given all of that, am I correct in thinking that a hard fork would not
> be necessary?
>
> IE: We could transition to another "required proof" - such as a
> quantum POW or a POB (above) or something else ....  in a back-compat
> way (existing nodes not aware of the rules would continue to
> validate).
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/1d9aee05/attachment.html>

From christopher.gilliard at gmail.com  Fri Apr 16 21:09:25 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Fri, 16 Apr 2021 21:09:25 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAPv7Tja=4ZFm5+gHw+wMcZyPEqeQiVx-AjyXsRn0T8a+tXHb1A@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
 <CAPv7Tja=4ZFm5+gHw+wMcZyPEqeQiVx-AjyXsRn0T8a+tXHb1A@mail.gmail.com>
Message-ID: <CAK=nyAynHnv_WmgkZecCXBGdJCbZ1s3jJf66g0gTSf8oJnH7ZA@mail.gmail.com>

Thanks for the feedback. I will take at the links and the video and see if
there's anything that I can incorporate to the BIPs.

On Fri, Apr 16, 2021 at 8:30 PM Ruben Somsen <rsomsen at gmail.com> wrote:

> Hi Chris,
>
> I agree with all the points that were made by others. You should also be
> aware that layer two ideas like yours have already been explored, both by
> myself and others. Allowing one hash per block allows for what I call
> "fee-bidding Blind Merged-Mining" (BMM), which as far as I know was first
> proposed by Paul Storc for Drivechains.[0]
>
> If only one hash is allowed per block, then those who wish to utilize the
> hash will have to out-bid each other ("fee-bidding"). This hash can then be
> used to create another chain ("merged-mining"), while the Bitcoin miners do
> not have to be aware of this other chain ("blind"). There are also non
> fee-bidding variants that function e.g. by burning or locking up bitcoins
> in order to create consensus.
>
> As it turns out, fee-bidding BMM can be achieved using only a covenant
> structure for transactions.[1] You'd have to create a sequence of
> transactions (one per block), to which a hash can be attached. These can
> simply be pre-signed transactions (requires forgetting a key, but the worst
> that can happen is that the chain halts), or an actual covenant using
> either sighash_anyprevout or op_ctv (we don't have these yet) ? no
> specialized soft fork (or hard fork) is required.
>
> You might think any decentralized alternative chain requires an altcoin,
> but this can also be avoided with a perpetual one-way peg.[2] For more
> details, I recommend watching this video of the full concept, which I call
> "spacechains": https://youtu.be/N2ow4Q34Jeg
>
> -- Ruben Somsen
>
>
>
> [0] Blind Merged-Mining for Drivechains:
> https://github.com/bitcoin/bips/blob/master/bip-0301.mediawiki
>
> [1] Fee-bidding Blind Merged-Mining with covenants:
> https://gist.github.com/RubenSomsen/5e4be6d18e5fa526b17d8b34906b16a5
>
> [2] Perpetual one-way peg:
> https://medium.com/@RubenSomsen/21-million-bitcoins-to-rule-all-sidechains-the-perpetual-one-way-peg-96cb2f8ac302
>
> On Fri, Apr 16, 2021 at 9:33 PM Kostas Karasavvas via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> Hi Christopher,
>>
>> Some feedback:
>>
>> "OP_RETURN is limited to 40 bytes of data."
>> It is 80 bytes.
>>
>> "A future BIP proposing such a layer two protocol will be forthcoming."
>> So what is this BIP about? Just saying that it would be a nice idea? This
>> BIP should be the one that would go through this L2 suggestion. If one root
>> OP_RETURN substitutes all the rest it should say how that would be done...
>> where would the merkle proofs be stored, what are the trust
>> assumptions that we need to make, etc.
>>
>> "Objections to this proposal" section
>> I agree with others re hard-fork, which would be a good thing of course.
>> My main objection with this proposal is that I don't see a proposal. It
>> seems like wishful thinking... if only we could substitute all the
>> OP_RETURNs with one :-)
>>
>> We have to make sure that a proposal like this (L2, etc.) would make sure
>> that there are incentives that justify the added complexity for the users.
>> Multisig is not the only way data could be stored the wrong way; P2PK,
>> P2PKH, P2SH, P2WPKH, P2WSH can also be used. If the incentives are not good
>> enough people would start using these UTXO-bloat-heavy alternatives.
>>
>> There are a multitude of L2's (kind-of) that do this 'aggregation' of
>> data hashes using merkle trees. Factom is adding a single merkle root per
>> bitcoin block for the millions upon millions of records (of thousand of
>> users) that they keep in their network. Opentimestamps, tierion,
>> blockstacks and others do a similar thing. I have investigated several of
>> those in the past, for one of my projects, but I ended up using plain old
>> OP_RETURN because the overhead of their (L2-like) solution and trust
>> assumptions where not to my liking; at least for my use case. They were
>> pretty solid/useful for other use cases.
>>
>> Unless the proposed L2 is flexible/generic enough it would really
>> prohibit this L2 innovation that OP_RETURN allowed (see above).
>>
>>
>>
>> On Fri, Apr 16, 2021 at 4:32 PM Christopher Gilliard via bitcoin-dev <
>> bitcoin-dev at lists.linuxfoundation.org> wrote:
>>
>>> I have created a BIP which can be found here:
>>> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>>>
>>> I'm sending this email to start the discussion regarding this proposal.
>>> If there are any comments/suggestions, please let me know.
>>>
>>> Regards,
>>> Chris
>>> _______________________________________________
>>> bitcoin-dev mailing list
>>> bitcoin-dev at lists.linuxfoundation.org
>>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>>
>>
>>
>> --
>> Konstantinos A. Karasavvas
>> Software Architect, Blockchain Engineer, Researcher, Educator
>> https://twitter.com/kkarasavvas
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210416/ea140bb4/attachment-0001.html>

From erik at q32.com  Fri Apr 16 21:47:44 2021
From: erik at q32.com (Erik Aronesty)
Date: Fri, 16 Apr 2021 17:47:44 -0400
Subject: [bitcoin-dev] Gradual transition to an alternate proof without
 a hard fork.
In-Reply-To: <CAD5xwhjWHsEZjTKJA3e+mwKZxuXf043jKvqDG4_hYRhd1jR07g@mail.gmail.com>
References: <CAJowKgJNefXZTCJk_EK4JC7uPKsTrGv=yUROpjL_7GGbfNrrvA@mail.gmail.com>
 <CAD5xwhjWHsEZjTKJA3e+mwKZxuXf043jKvqDG4_hYRhd1jR07g@mail.gmail.com>
Message-ID: <CAJowKgLNubeU0nVHqx+c8Jz+qMtOgmqwrCRdzCmaLvU67Jo6zw@mail.gmail.com>

> I think you need to hard deprecate the PoW for this to work, otherwise all old miners are like "toxic waste".

what would be the incentive?   a POB would be required on every block
(and would be lost if not used).   so any miner doing this would just
be doing "extra work" and strictly losing money over a miner that
doesn't.   a 99% reduction would be more than enough tho.

On Fri, Apr 16, 2021 at 5:24 PM Jeremy <jlrubin at mit.edu> wrote:
>
> I think you need to hard deprecate the PoW for this to work, otherwise all old miners are like "toxic waste".
>
> Imagine one miner turns on a S9 and then ramps up difficulty for everyone else.
>
> On Fri, Apr 16, 2021, 2:08 PM Erik Aronesty via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
>>
>> Not sure of the best place to workshop ideas, so please take this with
>> a grain of salt.
>>
>> Starting with 3 assumptions:
>>
>> - assume that there exists a proof-of-burn that, for Bitcoin's
>> purposes, accurately-enough models the investment in and development
>> of ASICs to maintain miner incentive.
>> - assume the resulting timing problem "how much burn is enough to keep
>> blocks 10 minutes apart and what does that even mean"  is also...
>> perfectly solvable
>> - assume "everyone unanimously loves this idea"
>>
>> The transition *could* look like this:
>>
>>  - validating nodes begin to require proof-of-burn, in addition to
>> proof-of-work (soft fork)
>>  - the extra expense makes it more expensive for miners, so POW slowly drops
>>  - on a predefined schedule, POB required is increased to 100% of the
>> "required work" to mine
>>
>> Given all of that, am I correct in thinking that a hard fork would not
>> be necessary?
>>
>> IE: We could transition to another "required proof" - such as a
>> quantum POW or a POB (above) or something else ....  in a back-compat
>> way (existing nodes not aware of the rules would continue to
>> validate).
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

From ZmnSCPxj at protonmail.com  Fri Apr 16 23:52:48 2021
From: ZmnSCPxj at protonmail.com (ZmnSCPxj)
Date: Fri, 16 Apr 2021 23:52:48 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAz5+yMUA=XDcunA1eeachSisaJoYE2_yzTLj=B0r4=w5A@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAMZUoKmR6ZU6mAgEhKDD5cTMuja_OC0_Sz3x4UND=E-g1PkgsQ@mail.gmail.com>
 <CAK=nyAz5+yMUA=XDcunA1eeachSisaJoYE2_yzTLj=B0r4=w5A@mail.gmail.com>
Message-ID: <iU2J5dWMIgqAf312ZCNmx38_hcYsKrcuqx84kniWeEdb0wP8jPZPvwHK3P-q1yvmQ5OtdMCwMFqPgwmsL7BUfE8PGUlrxW4rOM3slwHun3E=@protonmail.com>

Good morning Christopher,

> >> But more importantly, adding limitations on OP_RETURN transactions is not helpful.? Users who want to embed arbitrary data in their transactions can always do so by encoding their data inside the values of legacy multi-signature scriptpubkeys (pubkeys can be generated without knowing the private key in order to encode non-key related data).? Not only can users do this, users have done this in the past.? However, this behaviour is problematic because such multi-signature "data" scriptpubkeys are indistinguishable from "real" multisignature scriptpubkeys, and thus must be kept in the UTXO set.? This differs from outputs using OP_RETURN which are provably unspendable, and therefore can be safely omitted from the UTXO set.
>
> This sounds like a good justification to remove the legacy multi-signature capabilities as well.

The same technique can be used on P2PKH as well --- the "pubkey hash" need not be a hash of a public key, it can be a 20-byte commitment, or even an ASCII message like "ZmnSCPxj is the best" (20 characters, I counted).
There is nothing that *can* check if the hash of a public key is indeed the hash of a public key unless you actually reveal the public key.

If you need a 32-byte commitment, a P2WSH would work --- again the "script hash" need not be a hash of a script, it can be any 32-byte commitment.

In all these cases you have to waste 547 satoshi, but that tends to be small compared to tx fees currently.

Regards,
ZmnSCPxj

From christopher.gilliard at gmail.com  Sat Apr 17 03:57:55 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Sat, 17 Apr 2021 03:57:55 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <iU2J5dWMIgqAf312ZCNmx38_hcYsKrcuqx84kniWeEdb0wP8jPZPvwHK3P-q1yvmQ5OtdMCwMFqPgwmsL7BUfE8PGUlrxW4rOM3slwHun3E=@protonmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAMZUoKmR6ZU6mAgEhKDD5cTMuja_OC0_Sz3x4UND=E-g1PkgsQ@mail.gmail.com>
 <CAK=nyAz5+yMUA=XDcunA1eeachSisaJoYE2_yzTLj=B0r4=w5A@mail.gmail.com>
 <iU2J5dWMIgqAf312ZCNmx38_hcYsKrcuqx84kniWeEdb0wP8jPZPvwHK3P-q1yvmQ5OtdMCwMFqPgwmsL7BUfE8PGUlrxW4rOM3slwHun3E=@protonmail.com>
Message-ID: <CAK=nyAxJ_XYDhTE6pNHqWOQ-cLgqc_f-fbQ+EHTkxyiYOhOPUQ@mail.gmail.com>

Thanks ZmnSCPxj. Yes, I agree there are many ways to embed arbitrary data
in the blockchain and it's not feasible to block all of them. That is why
it's important to, at the same time as limiting the OP_RETURN to one per
block, also propose and implement a layer 2 solution for timestamping
so people have a clear and simple upgrade path. That is what I will be
discussing in one of the BIPs I intend to release early next week.

On Fri, Apr 16, 2021 at 11:52 PM ZmnSCPxj <ZmnSCPxj at protonmail.com> wrote:

> Good morning Christopher,
>
> > >> But more importantly, adding limitations on OP_RETURN transactions is
> not helpful.  Users who want to embed arbitrary data in their transactions
> can always do so by encoding their data inside the values of legacy
> multi-signature scriptpubkeys (pubkeys can be generated without knowing the
> private key in order to encode non-key related data).  Not only can users
> do this, users have done this in the past.  However, this behaviour is
> problematic because such multi-signature "data" scriptpubkeys are
> indistinguishable from "real" multisignature scriptpubkeys, and thus must
> be kept in the UTXO set.  This differs from outputs using OP_RETURN which
> are provably unspendable, and therefore can be safely omitted from the UTXO
> set.
> >
> > This sounds like a good justification to remove the legacy
> multi-signature capabilities as well.
>
> The same technique can be used on P2PKH as well --- the "pubkey hash" need
> not be a hash of a public key, it can be a 20-byte commitment, or even an
> ASCII message like "ZmnSCPxj is the best" (20 characters, I counted).
> There is nothing that *can* check if the hash of a public key is indeed
> the hash of a public key unless you actually reveal the public key.
>
> If you need a 32-byte commitment, a P2WSH would work --- again the "script
> hash" need not be a hash of a script, it can be any 32-byte commitment.
>
> In all these cases you have to waste 547 satoshi, but that tends to be
> small compared to tx fees currently.
>
> Regards,
> ZmnSCPxj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210417/3299b183/attachment-0001.html>

From kkarasavvas at gmail.com  Sat Apr 17 07:41:39 2021
From: kkarasavvas at gmail.com (Kostas Karasavvas)
Date: Sat, 17 Apr 2021 10:41:39 +0300
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAxfAY7Ob64XR+5E6uSv+0BcUsuVZUzNbNZBcUnRf1XY9Q@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
 <CAK=nyAxfAY7Ob64XR+5E6uSv+0BcUsuVZUzNbNZBcUnRf1XY9Q@mail.gmail.com>
Message-ID: <CABE6yHu5tz+B0LXU8PN1QBzsK7RZfLpkNUNkWsuwe7OyESSkSQ@mail.gmail.com>

Indeed, it was 40 then 80 then 40 again and then 80 at the end (or
something like this.. not sure about the exact history!).

Looking forward to the proposal(s).

On Fri, Apr 16, 2021 at 11:12 PM Christopher Gilliard <
christopher.gilliard at gmail.com> wrote:

> Thanks for the feedback. Will update the 40 bytes to 80 bytes (40 bytes
> was the previous value, but it has since been updated to 80 so that's
> correct). Regarding the L2 proposal. I think the BIPs I am working on will
> address your questions and I'm hoping to have two more out early next week
> so please stay tuned. I'm open to merging those BIPs into this BIP or
> vice-versa, but for the sake of making things more readable I broke them
> down into several BIPs for the time being.
>
> On Fri, Apr 16, 2021 at 7:15 PM Kostas Karasavvas <kkarasavvas at gmail.com>
> wrote:
>
>> Hi Christopher,
>>
>> Some feedback:
>>
>> "OP_RETURN is limited to 40 bytes of data."
>> It is 80 bytes.
>>
>> "A future BIP proposing such a layer two protocol will be forthcoming."
>> So what is this BIP about? Just saying that it would be a nice idea? This
>> BIP should be the one that would go through this L2 suggestion. If one root
>> OP_RETURN substitutes all the rest it should say how that would be done...
>> where would the merkle proofs be stored, what are the trust
>> assumptions that we need to make, etc.
>>
>> "Objections to this proposal" section
>> I agree with others re hard-fork, which would be a good thing of course.
>> My main objection with this proposal is that I don't see a proposal. It
>> seems like wishful thinking... if only we could substitute all the
>> OP_RETURNs with one :-)
>>
>> We have to make sure that a proposal like this (L2, etc.) would make sure
>> that there are incentives that justify the added complexity for the users.
>> Multisig is not the only way data could be stored the wrong way; P2PK,
>> P2PKH, P2SH, P2WPKH, P2WSH can also be used. If the incentives are not good
>> enough people would start using these UTXO-bloat-heavy alternatives.
>>
>> There are a multitude of L2's (kind-of) that do this 'aggregation' of
>> data hashes using merkle trees. Factom is adding a single merkle root per
>> bitcoin block for the millions upon millions of records (of thousand of
>> users) that they keep in their network. Opentimestamps, tierion,
>> blockstacks and others do a similar thing. I have investigated several of
>> those in the past, for one of my projects, but I ended up using plain old
>> OP_RETURN because the overhead of their (L2-like) solution and trust
>> assumptions where not to my liking; at least for my use case. They were
>> pretty solid/useful for other use cases.
>>
>> Unless the proposed L2 is flexible/generic enough it would really
>> prohibit this L2 innovation that OP_RETURN allowed (see above).
>>
>>
>>
>> On Fri, Apr 16, 2021 at 4:32 PM Christopher Gilliard via bitcoin-dev <
>> bitcoin-dev at lists.linuxfoundation.org> wrote:
>>
>>> I have created a BIP which can be found here:
>>> https://github.com/cgilliard/bips/blob/notarization/bip-XXXX.mediawiki
>>>
>>> I'm sending this email to start the discussion regarding this proposal.
>>> If there are any comments/suggestions, please let me know.
>>>
>>> Regards,
>>> Chris
>>> _______________________________________________
>>> bitcoin-dev mailing list
>>> bitcoin-dev at lists.linuxfoundation.org
>>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>>
>>
>>
>> --
>> Konstantinos A. Karasavvas
>> Software Architect, Blockchain Engineer, Researcher, Educator
>> https://twitter.com/kkarasavvas
>>
>

-- 
Konstantinos A. Karasavvas
Software Architect, Blockchain Engineer, Researcher, Educator
https://twitter.com/kkarasavvas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210417/6f3da8fa/attachment-0001.html>

From vjudeu at gazeta.pl  Sat Apr 17 09:41:44 2021
From: vjudeu at gazeta.pl (vjudeu)
Date: Sat, 17 Apr 2021 11:41:44 +0200
Subject: [bitcoin-dev] Gradual transition to an alternate proof without
 a hard fork.
Message-ID: <128966745-bb0a93fd2653dc12305b953184cbcd13@pmq5v.m5r2.onet>

Yes, transition from Proof of Work to Proof of Something Else is possible in a soft-fork way. All that is needed is getting miners and users support. Then, Proof of Work difficulty should drop to one, and the rest would be solved by Proof of Something Else. Old miners still could use ASIC miners to produce blocks with higher Proof of Work, but then their blocks would be rejected. Currently, you can also make a block with enormously low hash, but if this block would contain two transactions sending the same coins to two different places, it would be rejected, no matter how low that hash would be. As long as miners would produce enough Proof of Something Else and as long as most nodes would use upgraded software, it should be resistant to such attacks.

So, technically speaking, it is possible. The most difficult part is getting miners and users supporting it.

On 2021-04-16 23:47:44 user Erik Aronesty via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
> > I think you need to hard deprecate the PoW for this to work, otherwise all old miners are like "toxic waste".
> 
> what would be the incentive?   a POB would be required on every block
> (and would be lost if not used).   so any miner doing this would just
> be doing "extra work" and strictly losing money over a miner that
> doesn't.   a 99% reduction would be more than enough tho.
> 
> On Fri, Apr 16, 2021 at 5:24 PM Jeremy <jlrubin at mit.edu> wrote:
> >
> > I think you need to hard deprecate the PoW for this to work, otherwise all old miners are like "toxic waste".
> >
> > Imagine one miner turns on a S9 and then ramps up difficulty for everyone else.
> >
> > On Fri, Apr 16, 2021, 2:08 PM Erik Aronesty via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
> >>
> >> Not sure of the best place to workshop ideas, so please take this with
> >> a grain of salt.
> >>
> >> Starting with 3 assumptions:
> >>
> >> - assume that there exists a proof-of-burn that, for Bitcoin's
> >> purposes, accurately-enough models the investment in and development
> >> of ASICs to maintain miner incentive.
> >> - assume the resulting timing problem "how much burn is enough to keep
> >> blocks 10 minutes apart and what does that even mean"  is also...
> >> perfectly solvable
> >> - assume "everyone unanimously loves this idea"
> >>
> >> The transition *could* look like this:
> >>
> >>  - validating nodes begin to require proof-of-burn, in addition to
> >> proof-of-work (soft fork)
> >>  - the extra expense makes it more expensive for miners, so POW slowly drops
> >>  - on a predefined schedule, POB required is increased to 100% of the
> >> "required work" to mine
> >>
> >> Given all of that, am I correct in thinking that a hard fork would not
> >> be necessary?
> >>
> >> IE: We could transition to another "required proof" - such as a
> >> quantum POW or a POB (above) or something else ....  in a back-compat
> >> way (existing nodes not aware of the rules would continue to
> >> validate).
> >> _______________________________________________
> >> bitcoin-dev mailing list
> >> bitcoin-dev at lists.linuxfoundation.org
> >> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> 




From c1.bitcoin at niftybox.net  Sat Apr 17 11:19:46 2021
From: c1.bitcoin at niftybox.net (Devrandom)
Date: Sat, 17 Apr 2021 13:19:46 +0200
Subject: [bitcoin-dev] Gradual transition to an alternate proof without
 a hard fork.
In-Reply-To: <CAJowKgJNefXZTCJk_EK4JC7uPKsTrGv=yUROpjL_7GGbfNrrvA@mail.gmail.com>
References: <CAJowKgJNefXZTCJk_EK4JC7uPKsTrGv=yUROpjL_7GGbfNrrvA@mail.gmail.com>
Message-ID: <CAB0O3SXT7k42Q=DH_PxVzV4W3HCEajfFqHuNW-YyEfP6W=zhfg@mail.gmail.com>

Hi Erik,

Here's a scheme I posted here a few years ago, which smoothly transitions
using geometric mean chain weight / difficulty:

https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-November/015236.html

On Fri, Apr 16, 2021 at 11:08 PM Erik Aronesty via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Not sure of the best place to workshop ideas, so please take this with
> a grain of salt.
>
> Starting with 3 assumptions:
>
> - assume that there exists a proof-of-burn that, for Bitcoin's
> purposes, accurately-enough models the investment in and development
> of ASICs to maintain miner incentive.
> - assume the resulting timing problem "how much burn is enough to keep
> blocks 10 minutes apart and what does that even mean"  is also...
> perfectly solvable
> - assume "everyone unanimously loves this idea"
>
> The transition *could* look like this:
>
>  - validating nodes begin to require proof-of-burn, in addition to
> proof-of-work (soft fork)
>  - the extra expense makes it more expensive for miners, so POW slowly
> drops
>  - on a predefined schedule, POB required is increased to 100% of the
> "required work" to mine
>
> Given all of that, am I correct in thinking that a hard fork would not
> be necessary?
>
> IE: We could transition to another "required proof" - such as a
> quantum POW or a POB (above) or something else ....  in a back-compat
> way (existing nodes not aware of the rules would continue to
> validate).
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210417/1d1d8922/attachment.html>

From aj at erisian.com.au  Sat Apr 17 11:47:17 2021
From: aj at erisian.com.au (Anthony Towns)
Date: Sat, 17 Apr 2021 21:47:17 +1000
Subject: [bitcoin-dev] Gradual transition to an alternate proof without
 a hard fork.
In-Reply-To: <CAJowKgJNefXZTCJk_EK4JC7uPKsTrGv=yUROpjL_7GGbfNrrvA@mail.gmail.com>
References: <CAJowKgJNefXZTCJk_EK4JC7uPKsTrGv=yUROpjL_7GGbfNrrvA@mail.gmail.com>
Message-ID: <20210417114717.GA8079@erisian.com.au>

On Fri, Apr 16, 2021 at 04:48:35PM -0400, Erik Aronesty via bitcoin-dev wrote:
> The transition *could* look like this:
>  - validating nodes begin to require proof-of-burn, in addition to
> proof-of-work (soft fork)
>  - the extra expense makes it more expensive for miners, so POW slowly drops
>  - on a predefined schedule, POB required is increased to 100% of the
> "required work" to mine
> Given all of that, am I correct in thinking that a hard fork would not
> be necessary?

It depends what you mean by a "hard fork". By the definition that
"the old software will consider the chain followed by new versions of
the software as valid" it's a soft fork. But it doesn't maintain the
property "old software continues to follow the same chain as new software,
provided the economic majority has adopted the new software" -- because
after the PoW part has dropped its difficulty substantitally, people can
easily/cheaply make a new chain that doesn't include proof-of-burn, and
has weak proof-of-work that's nevertheless higher than the proof-of-burn
chain, so old nodes will switch to it, while new nodes will continue to
follow the proof-of-burn chain.

So I think that means it needs to be treated as a hard fork: everyone
needs to be running the new software by some date to ensure they follow
the same chain.

(The same argument applies to trying to switch to a different PoW
algorithm via a soft fork; I forget who explained this to me)

Jeremy wrote:
> I think you need to hard deprecate the PoW for this to work, otherwise
> all old miners are like "toxic waste".
>
> Imagine one miner turns on a S9 and then ramps up difficulty for
> everyone else.

If it's a soft-fork, you could only ramp up the PoW difficulty by mining
more than one block every ten minutes, but presumably the proof-of-burn
scheme would have its own way of preventing burners from mining blocks
too fast (it was assumption 2).

Cheers,
aj


From pete at petertodd.org  Sat Apr 17 15:50:08 2021
From: pete at petertodd.org (Peter Todd)
Date: Sat, 17 Apr 2021 11:50:08 -0400
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAxJ_XYDhTE6pNHqWOQ-cLgqc_f-fbQ+EHTkxyiYOhOPUQ@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAMZUoKmR6ZU6mAgEhKDD5cTMuja_OC0_Sz3x4UND=E-g1PkgsQ@mail.gmail.com>
 <CAK=nyAz5+yMUA=XDcunA1eeachSisaJoYE2_yzTLj=B0r4=w5A@mail.gmail.com>
 <iU2J5dWMIgqAf312ZCNmx38_hcYsKrcuqx84kniWeEdb0wP8jPZPvwHK3P-q1yvmQ5OtdMCwMFqPgwmsL7BUfE8PGUlrxW4rOM3slwHun3E=@protonmail.com>
 <CAK=nyAxJ_XYDhTE6pNHqWOQ-cLgqc_f-fbQ+EHTkxyiYOhOPUQ@mail.gmail.com>
Message-ID: <20210417155008.GA3373@petertodd.org>

On Sat, Apr 17, 2021 at 03:57:55AM +0000, Christopher Gilliard via bitcoin-dev wrote:
> Thanks ZmnSCPxj. Yes, I agree there are many ways to embed arbitrary data
> in the blockchain and it's not feasible to block all of them. That is why
> it's important to, at the same time as limiting the OP_RETURN to one per
> block, also propose and implement a layer 2 solution for timestamping
> so people have a clear and simple upgrade path. That is what I will be
> discussing in one of the BIPs I intend to release early next week.

Note that an aggregated timestamping service already exists:

https://petertodd.org/2016/opentimestamps-announcement

But timestamping is useless for most things people want to do, as it can't
commit to a unique history. It merely proves something existed in the past. For
uniqueness, you need something like:

https://petertodd.org/2017/scalable-single-use-seal-asset-transfer


Anyway, at current fees being what they are there's no compelling reason to try
to prevent people from embedding data in the Bitcoin block chain with consensus
changes. Economics is preventing that just fine.

-- 
https://petertodd.org 'peter'[:-1]@petertodd.org
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 488 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210417/8f8b5a12/attachment.sig>

From christopher.gilliard at gmail.com  Sat Apr 17 16:57:34 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Sat, 17 Apr 2021 16:57:34 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <20210417155008.GA3373@petertodd.org>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CAMZUoKmR6ZU6mAgEhKDD5cTMuja_OC0_Sz3x4UND=E-g1PkgsQ@mail.gmail.com>
 <CAK=nyAz5+yMUA=XDcunA1eeachSisaJoYE2_yzTLj=B0r4=w5A@mail.gmail.com>
 <iU2J5dWMIgqAf312ZCNmx38_hcYsKrcuqx84kniWeEdb0wP8jPZPvwHK3P-q1yvmQ5OtdMCwMFqPgwmsL7BUfE8PGUlrxW4rOM3slwHun3E=@protonmail.com>
 <CAK=nyAxJ_XYDhTE6pNHqWOQ-cLgqc_f-fbQ+EHTkxyiYOhOPUQ@mail.gmail.com>
 <20210417155008.GA3373@petertodd.org>
Message-ID: <CAK=nyAzZ5zXt3e68coXMYBhLri4FcCr=kAAo05oiGPVoGH4Ujg@mail.gmail.com>

Peter, thanks for the links. I'm aware that there are other timestamping
aggregation services that already exist, but I had some different ideas
that integrate into some other services. Also thanks for sending the link
to the single use seal asset transfer. I will take a look at that.

On Sat, Apr 17, 2021 at 3:50 PM Peter Todd <pete at petertodd.org> wrote:

> On Sat, Apr 17, 2021 at 03:57:55AM +0000, Christopher Gilliard via
> bitcoin-dev wrote:
> > Thanks ZmnSCPxj. Yes, I agree there are many ways to embed arbitrary data
> > in the blockchain and it's not feasible to block all of them. That is why
> > it's important to, at the same time as limiting the OP_RETURN to one per
> > block, also propose and implement a layer 2 solution for timestamping
> > so people have a clear and simple upgrade path. That is what I will be
> > discussing in one of the BIPs I intend to release early next week.
>
> Note that an aggregated timestamping service already exists:
>
> https://petertodd.org/2016/opentimestamps-announcement
>
> But timestamping is useless for most things people want to do, as it can't
> commit to a unique history. It merely proves something existed in the
> past. For
> uniqueness, you need something like:
>
> https://petertodd.org/2017/scalable-single-use-seal-asset-transfer
>
>
> Anyway, at current fees being what they are there's no compelling reason
> to try
> to prevent people from embedding data in the Bitcoin block chain with
> consensus
> changes. Economics is preventing that just fine.
>
> --
> https://petertodd.org 'peter'[:-1]@petertodd.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210417/618da7c6/attachment.html>

From jlrubin at mit.edu  Sat Apr 17 18:45:31 2021
From: jlrubin at mit.edu (Jeremy)
Date: Sat, 17 Apr 2021 11:45:31 -0700
Subject: [bitcoin-dev] Taproot Activation Meeting 4/20 Cancelled
Message-ID: <CAD5xwhi_ymtyu_A9Whm-8i8XPB=ZWZZZrm79PN+vfhsnUPPSkg@mail.gmail.com>

Dear Bitcoin Developers,

There are no current agenda items or technical issues to weed out,
everything has been through the grinder, and Bitcoin Core seems to be on a
roll with getting Release Candidate 1 with Speedy Trial MTP in the pipe.

If anyone is hazy on the details -- it has been a little bit of a blaze --
I'd refer you to https://github.com/bitcoin/bips/pull/1104 (changes to BIP
341) which details what was hashed out by joint agreement of many community
members.

Not to be blunt, but given the high tensions, I recommend that everyone
take the opportunity to thoroughly enjoy the holiday :)

Best,

Jeremy

--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210417/f03e4dc8/attachment.html>

From email at yancy.lol  Sat Apr 17 20:10:39 2021
From: email at yancy.lol (yancy)
Date: Sat, 17 Apr 2021 20:10:39 +0000 (UTC)
Subject: [bitcoin-dev]  Taproot Activation Meeting 4/20 Cancelled
In-Reply-To: <CAD5xwhi_ymtyu_A9Whm-8i8XPB=ZWZZZrm79PN+vfhsnUPPSkg@mail.gmail.com>
References: <CAD5xwhi_ymtyu_A9Whm-8i8XPB=ZWZZZrm79PN+vfhsnUPPSkg@mail.gmail.com>
Message-ID: <bbba02b6-a041-4d7c-b58c-4f7f0f4100ca@yancy.lol>

I appreciate the bluntness, Jeremy, and agree it's high time folks enjoy the holiday.

Cheers,
-Yancy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210417/4af5440b/attachment.html>

From yanmaani at cock.li  Tue Apr 20 01:22:34 2021
From: yanmaani at cock.li (yanmaani at cock.li)
Date: Tue, 20 Apr 2021 01:22:34 +0000
Subject: [bitcoin-dev] Block weight penalty for UTXO set growth
Message-ID: <42775695100e48eb5884d38e60b70957@cock.li>

Bitcoin presently suffers from unconstrained UTXO set growth. It would 
be possible to disincentivize this and incentivize consolidating UTXOs 
by adding a block weight penalty for UTXO creation, and bonus for UTXO 
destruction:

* For each block, calculate the net change in UTXOs. If all the 
transactions in a block consume 6,256 inputs and create 6,512 outputs, 
the net change is +256.
* For each block, change the weight limit by -penalty * delta
* For example, if the penalty is 10 vB/UTXO, that block would be 10*256 
= 2560 vB smaller. At a fee of 150 sat/vB, this would reduce the 
potential transaction fees by 0.00384000 BTC ($230 at current prices)

(Alternatively, it would also be possible to make the penalty in coin, 
which would require miners to fail to claim/burn an equivalent amount of 
subsidy.)

A problem is that it is not possible to increase the weight limit (or 
the block reward). I can see three possible solutions to this:

1) Let any excess be wasted. Miners can only use consolidated UTXOs to 
offset new ones.
2) Decrease the weight limit slightly (i.e. by 1%), so that miners have 
an incentive to consolidate UTXOs at least up to that limit.
3) Increase the weight limit, but only if miners consolidate enough 
UTXOs.

Aside from the obvious issues with the third option (it would be a 
hardfork), another problem is that this would make it harder for low-fee 
transactions to get confirmed; on blocks with bad fees, miners might 
instead opt to create a load of dust UTXOs, so they can destroy them on 
blocks with very high fees to free up capacity. On the other hand, this 
might be seen as a feature rather than a bug, since it would allow block 
sizes to vary by demand, a bit like VBR vs. CBR in audio compression.

Thoughts? Has this been discussed before?

From yanmaani at cock.li  Tue Apr 20 01:22:51 2021
From: yanmaani at cock.li (yanmaani at cock.li)
Date: Tue, 20 Apr 2021 01:22:51 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
Message-ID: <bfea86cbe0d63df5219b77ca2409cea1@cock.li>

This has already been discussed and proposed in various papers and 
articles, typically to replace SHA-256d with something else. It 
basically works, but there's a some tiny issues:

1) Who goes first?

If you first calculate the expensive PoW and then do a cheap SHA-256d 
around it, anyone can malleate it by changing the outer PoW.

If you first calculate the cheap SHA-256d and then do an expensive PoW 
around it, it would work, but then you would have to retool the P2P 
protocol.

2) What's the incentive for miners?

In a "normal" soft-fork, miners have the incentive to upgrade because 
their blocks will be orphaned if they don't, and even the old clients 
won't accept them.

Here, miners will be able to produce an alternate chain that will appear 
valid to old clients, and that the new miners won't be able to orphan 
(since their hash power is much weaker).

From yanmaani at cock.li  Tue Apr 20 01:23:12 2021
From: yanmaani at cock.li (yanmaani at cock.li)
Date: Tue, 20 Apr 2021 01:23:12 +0000
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAPv7Tja=4ZFm5+gHw+wMcZyPEqeQiVx-AjyXsRn0T8a+tXHb1A@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
 <CAPv7Tja=4ZFm5+gHw+wMcZyPEqeQiVx-AjyXsRn0T8a+tXHb1A@mail.gmail.com>
Message-ID: <050674b8bc51cff11e0a6e105880b647@cock.li>

> If only one hash is allowed per block, then those who wish to utilize 
> the hash will have to out-bid each other ("fee-bidding"). This hash can 
> then be used to create another chain ("merged-mining")

Merged mining at present only needs one hash for a merkle root, and 
that's stored in the coinbase. It would be even simpler to add the 
following rules:

1) No OP_RETURN transactions allowed at all
2) If you want to commit data, do so in that one transaction in the 
coinbase

Also curious about how you'd handle the payment - do I need to put in a 
transaction that burns bitcoins for the tx fee? That isn't free in terms 
of storage either.

From zachgrw at gmail.com  Tue Apr 20 08:45:31 2021
From: zachgrw at gmail.com (Zach Greenwood)
Date: Tue, 20 Apr 2021 10:45:31 +0200
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <050674b8bc51cff11e0a6e105880b647@cock.li>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
 <CAPv7Tja=4ZFm5+gHw+wMcZyPEqeQiVx-AjyXsRn0T8a+tXHb1A@mail.gmail.com>
 <050674b8bc51cff11e0a6e105880b647@cock.li>
Message-ID: <CAJ4-pEDEsQCqT9Yiz6WiWahPV5kkxc89XbsDydgEPuoZRU8MvQ@mail.gmail.com>

[Note: this is my first post to the list]

Businesses storing data on-chain is undesirable but sadly unavoidable.
Therefore one might as well *facilitate* data storage beyond just OP_RETURN
by offering a more efficient way to store data on-chain, while still being
almost as expensive in use per byte of payload (i.e., data) compared to
using OP_RETURN.

Storing data using OP_RETURN is still inefficient per byte of payload so a
more efficient dedicated data storing facility might be created that stores
more payload data per on-chain byte. Such a facility should be (marginally)
cheaper to use per payload byte compared to using a hack such as OP_RETURN.
This would encourage the use of this facility in favor of OP_RETURN or
other hacks, while at the same time dramatically reducing the footprint of
storing data on-chain.

Zac

On Tue, Apr 20, 2021 at 4:29 AM yanmaani--- via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> > If only one hash is allowed per block, then those who wish to utilize
> > the hash will have to out-bid each other ("fee-bidding"). This hash can
> > then be used to create another chain ("merged-mining")
>
> Merged mining at present only needs one hash for a merkle root, and
> that's stored in the coinbase. It would be even simpler to add the
> following rules:
>
> 1) No OP_RETURN transactions allowed at all
> 2) If you want to commit data, do so in that one transaction in the
> coinbase
>
> Also curious about how you'd handle the payment - do I need to put in a
> transaction that burns bitcoins for the tx fee? That isn't free in terms
> of storage either.
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210420/3f57baae/attachment.html>

From jlrubin at mit.edu  Tue Apr 20 15:46:07 2021
From: jlrubin at mit.edu (Jeremy)
Date: Tue, 20 Apr 2021 08:46:07 -0700
Subject: [bitcoin-dev] [Pre-BIP] Motivating Address type for OP_RETURN
Message-ID: <CAD5xwhj7jXSrdbfFJTYw-UzGgZTF0kz-Vr61juF0gJGLf2EKqQ@mail.gmail.com>

Hi All,

Introducing the notion that we might want to have an address type defined
for OP_RETURN.

I came across this when writing some code that wanted to handle common
classes of user transactions generically, it's kind of annoying that you
have to write code that's effectively:

```
try {
   print(script.address());
} catch {
   try {
       print(script.op_return());
   } catch {
      print("unknown thing");
   }
}
```

I think that OP_RETURN, being relatively well defined, could have an
address type.

This would aid in simplifying types for programs. E.g., in Rust I want to
have:

```
struct Coin(Address, Amount)
impl Coin {
  fn get_coin(o: Outpoint) -> Result<Coin, Error>{/**/}
}
enum Error {
  UnknownType,
  CoinDoesNotExist,
}
```

and without Address defining OP_RETURN I can't read a Coin containing an
OP_RETURN. It would be possible to define Coin to store script, but then
everywhere I want an address I would have to perform a conversion and
Script is technically "too wide" a type as what I really want is to only
return coins with known output types.

More concretely this is a challenge for me as I'm building the Sapio
compiler and I want to make it so that all contract compilations result in
an Address, but I need to support OP_RETURN for various reasons, so I
cannot make Sapio only output addresses.

As far as I understand the counterargument against this, it is (thanks to
Luke Jr):

1) We should only have addresses or descriptors for things we know exactly
what they are, and also for things that represent something that is not
only payable but also potentially spendable.
2) OP_RETURN, being unspendable and usually proprietary in purpose, should
not have an address.
3) Further, most uses of OP_RETURN are proprietary (e.g., we don't know
what it represents) so therefore it would be lying to the user to pretend
we know how to interpret it.


My counterargument is that:

1) Addresses should represent things that people commonly create outputs
for -- perhaps regrettably, OP_RETURN is such a thing so software (e.g.,
https://citp.github.io/BlockSci/reference/addresses/address.html) already
does treat OP_RETURN as an address type, just without a standard
representation.
2) Many things are unspendable. E.g., a 0 value payment to an address, a
payment to P2SH(OP_RETURN <data>), etc. We can't know spendability based on
address type.
3) All scripts can have proprietary interpretations, the job of the address
is to do our best job of interpreting standard types to the best of our
ability. An example where this has been (ab)used previously is P2SH wrapped
SegWit, where one cannot distinguish if the underlying is to be evaluated
as P2SH or SegWit. Further, future OP_RETURN address types could take
precedence if they are well specified.


Do folks agree with the motivations for defining an address type? Are there
any design constraints?

Some starter thoughts
1) Should it be human readable & checksummed or encoded?
2) Should it have a fixed length of max 40-80 bytes or should we support
arbitrary length strings?
3) Should it be possible (i.e., from core) to pay into such an OP_RETURN or
should we categorize OP_RETURNS as a non-payable address type (and just use
it for parsing blockdata)

(my answers are 1. human readable + checksum, 2. arbitrary to support
nonstandard ones which miners create 3. non payable in standard software)

Cheers,

Jeremy



Best,

Jeremy

--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210420/1e9b21d5/attachment.html>

From christopher.gilliard at gmail.com  Tue Apr 20 17:07:35 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Tue, 20 Apr 2021 10:07:35 -0700
Subject: [bitcoin-dev] BIPs - notarization protocol and decentralized
	storage protocol
Message-ID: <CAK=nyAwPbnB2trRUtKwc1L4+iP5TvPTap7sFK+pfgPJhx8n4xg@mail.gmail.com>

I have created two additional BIPs that are associated with the BIP that I
sent to the mailing list last week. They can be found here:

1.) storage:
https://github.com/cgilliard/bips/blob/storage/bip-XXXX.mediawiki

2.) notarization:
https://github.com/cgilliard/bips/blob/notarization-l2/bip-XXXX.mediawiki

Let me know if there is any feedback or comments.

Regards,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210420/345369fd/attachment-0001.html>

From christopher.gilliard at gmail.com  Tue Apr 20 17:12:35 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Tue, 20 Apr 2021 10:12:35 -0700
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <CAJ4-pEDEsQCqT9Yiz6WiWahPV5kkxc89XbsDydgEPuoZRU8MvQ@mail.gmail.com>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
 <CAPv7Tja=4ZFm5+gHw+wMcZyPEqeQiVx-AjyXsRn0T8a+tXHb1A@mail.gmail.com>
 <050674b8bc51cff11e0a6e105880b647@cock.li>
 <CAJ4-pEDEsQCqT9Yiz6WiWahPV5kkxc89XbsDydgEPuoZRU8MvQ@mail.gmail.com>
Message-ID: <CAK=nyAxmNc087YPwxr-3i9J1zm+1+VWMy_u1a=Rcc1spdZBHKw@mail.gmail.com>

Zach,

Thanks for the comments. I just sent out another email to the dev alias
with the other two BIPs that I mentioned last week. It is pending approval
now. I think it will talk about some of the things you mentioned. To avoid
having a lot of comments about those BIPs on this thread, let's use the new
thread for discussing those BIPs.

--Chris

On Tue, Apr 20, 2021 at 1:45 AM Zach Greenwood <zachgrw at gmail.com> wrote:

> [Note: this is my first post to the list]
>
> Businesses storing data on-chain is undesirable but sadly unavoidable.
> Therefore one might as well *facilitate* data storage beyond just OP_RETURN
> by offering a more efficient way to store data on-chain, while still being
> almost as expensive in use per byte of payload (i.e., data) compared to
> using OP_RETURN.
>
> Storing data using OP_RETURN is still inefficient per byte of payload so a
> more efficient dedicated data storing facility might be created that stores
> more payload data per on-chain byte. Such a facility should be (marginally)
> cheaper to use per payload byte compared to using a hack such as OP_RETURN.
> This would encourage the use of this facility in favor of OP_RETURN or
> other hacks, while at the same time dramatically reducing the footprint of
> storing data on-chain.
>
> Zac
>
> On Tue, Apr 20, 2021 at 4:29 AM yanmaani--- via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> > If only one hash is allowed per block, then those who wish to utilize
>> > the hash will have to out-bid each other ("fee-bidding"). This hash can
>> > then be used to create another chain ("merged-mining")
>>
>> Merged mining at present only needs one hash for a merkle root, and
>> that's stored in the coinbase. It would be even simpler to add the
>> following rules:
>>
>> 1) No OP_RETURN transactions allowed at all
>> 2) If you want to commit data, do so in that one transaction in the
>> coinbase
>>
>> Also curious about how you'd handle the payment - do I need to put in a
>> transaction that burns bitcoins for the tx fee? That isn't free in terms
>> of storage either.
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210420/4995536f/attachment-0001.html>

From rsomsen at gmail.com  Tue Apr 20 19:07:00 2021
From: rsomsen at gmail.com (Ruben Somsen)
Date: Tue, 20 Apr 2021 21:07:00 +0200
Subject: [bitcoin-dev] BIP - limiting OP_RETURN / HF
In-Reply-To: <050674b8bc51cff11e0a6e105880b647@cock.li>
References: <CAK=nyAxOa8fsVfxucH7WTTMn25BCzgQ28h_sNsunedpCoRXjjQ@mail.gmail.com>
 <CABE6yHscUPAcyK58DvqhOnxSOoPMBAy9aMUmReJYSkBit-Mekg@mail.gmail.com>
 <CAPv7Tja=4ZFm5+gHw+wMcZyPEqeQiVx-AjyXsRn0T8a+tXHb1A@mail.gmail.com>
 <050674b8bc51cff11e0a6e105880b647@cock.li>
Message-ID: <CAPv7TjaLF-LeEvyfHXs6-4E2cqwDK6qvEQHzwyRy9SUpFA5G=g@mail.gmail.com>

Hi Yanmaani,

>Merged mining at present only needs one hash for a merkle root, and that's
stored in the coinbase.

Yes, but that method is not "blind", meaning BTC miners have to
validate the merged-mined chain, which is a significant downside.

>It would be even simpler to add the following rules

That would require a specific soft fork, whereas the method described in my
post avoids doing that.

>do I need to put in a transaction that burns bitcoins for the tx fee

The blind merged-mined chain (which I call a "spacechain") needs its own
native token in order to pay for fees. The mechanism I proposed for that is
the perpetual one-way peg, which allows fair "spacecoin" creation by
burning BTC, and circumvents creating bad speculative altcoin incentives.
Anyone can create a spacechain block and take the fees, and then try to get
BTC miners to include it by paying a higher fee than others (via RBF).

>That isn't free in terms of storage

It's not necessary for everyone to burn individually. My preferred design
is to only let BMM block creators burn BTC, then others will have to buy
spacecoins from them. This limits the potential burn outputs to one per
block (likely much less, because BTC will logically only get burned when
spacecoin demand increases). It's also possible to create more spacechains
inside the initial spacechain, at no additional storage cost to Bitcoin.

I highly recommend checking out the links in my prior post
<https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-April/018803.html>
if you wish to learn more, particularly the video
<https://youtu.be/N2ow4Q34Jeg>.

Cheers,
Ruben

On Tue, Apr 20, 2021 at 3:23 AM <yanmaani at cock.li> wrote:

> > If only one hash is allowed per block, then those who wish to utilize
> > the hash will have to out-bid each other ("fee-bidding"). This hash can
> > then be used to create another chain ("merged-mining")
>
> Merged mining at present only needs one hash for a merkle root, and
> that's stored in the coinbase. It would be even simpler to add the
> following rules:
>
> 1) No OP_RETURN transactions allowed at all
> 2) If you want to commit data, do so in that one transaction in the
> coinbase
>
> Also curious about how you'd handle the payment - do I need to put in a
> transaction that burns bitcoins for the tx fee? That isn't free in terms
> of storage either.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210420/1b718ee7/attachment.html>

From RobertSpigler at protonmail.ch  Tue Apr 20 22:44:45 2021
From: RobertSpigler at protonmail.ch (Robert Spigler)
Date: Tue, 20 Apr 2021 22:44:45 +0000
Subject: [bitcoin-dev] BIPs - notarization protocol and decentralized
	storage protocol
In-Reply-To: <CAK=nyAwPbnB2trRUtKwc1L4+iP5TvPTap7sFK+pfgPJhx8n4xg@mail.gmail.com>
References: <CAK=nyAwPbnB2trRUtKwc1L4+iP5TvPTap7sFK+pfgPJhx8n4xg@mail.gmail.com>
Message-ID: <olDSOjTm3xnWDJWj5FPq3fwXOntsWqOGq7qu6w-4E-CbFUIwwTd4kgz73VEz7rYO-YUfJn7l7PZf7yedfTebkguznI8O7TuNzcDGC_Y7u5M=@protonmail.ch>

Hi Chris,

Very interested in this!

Never understood why a Storj/Sia couldn't just use Bitcoin/LN instead of an alt.

Robert Spigler

Personal Fingerprint: BF0D 3C08 A439 5AC6 11C1 5395 B70B 4A77 F850 548F

??????? Original Message ???????
On Tuesday, April 20, 2021 1:07 PM, Christopher Gilliard via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:

> I have created two additional BIPs that are associated with the BIP that I sent to the mailing list last week. They can be found here:
>
> 1.) storage: https://github.com/cgilliard/bips/blob/storage/bip-XXXX.mediawiki
>
> 2.) notarization: https://github.com/cgilliard/bips/blob/notarization-l2/bip-XXXX.mediawiki
>
> Let me know if there is any feedback or comments.
>
> Regards,
> Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210420/1f9cf2f0/attachment.html>

From prayank at tutanota.de  Wed Apr 21 04:26:26 2021
From: prayank at tutanota.de (Prayank)
Date: Wed, 21 Apr 2021 06:26:26 +0200 (CEST)
Subject: [bitcoin-dev] BIPs - notarization protocol and decentralized
 storage
Message-ID: <MYmfT1n--3-2@tutanota.de>

Hello Christopher,

Decentralized storage as an idea looks interesting. I am researching about similar things for one of my Bitcoin project. Although an implementation or proof of concept code in the BIP would have been better. Also since this involves LN, maybe it can just be a LN project instead of BIP? Not the best person to comment on what can be a BIP.

Few links that you may find interesting:

https://github.com/bkiac/tarnhelm

https://github.com/ElementsProject/filebazaar

The kind of decentralized storage that I think can be helpful for Bitcoin projects:

1.Uses torrents for files and communication required (with Tor)

2.Easy to use API to save, read, edit etc. something in a Bitcoin project using torrents. Only involve lightning network and payments when spamming can be an issue. For example: If a developer wants users to pay for every P2P offer they create using a DEX protocol.

Projects that are exploring such options:?https://github.com/JoinMarket-Org/joinmarket-clientserver/issues/415

-- 
Prayank
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210421/986bd0ae/attachment.html>

From prayank at tutanota.de  Wed Apr 21 04:59:56 2021
From: prayank at tutanota.de (Prayank)
Date: Wed, 21 Apr 2021 06:59:56 +0200 (CEST)
Subject: [bitcoin-dev] Block weight penalty for UTXO set growth
Message-ID: <MYmn7jG--7-2@tutanota.de>

Hello Yanmaani,

Incentives for UTXO consolidation already exists IMO.

1.If UTXO consolidation is done when fee rates are low (less congestion in mempool), it helps in saving money in lot of cases. Example:?https://bitcoin.stackexchange.com/a/100811/
2.If running full node for Bitcoin, it will help in a smaller UTXO set.

In few cases it affects privacy though like post coinjoin.

TBH I couldn't understand everything you mentioned including the part in which fees decrease is mentioned because of smaller block. Fees should increase if such blocks are regularly mined and are predictable IMO. Not sure if everyone will agree to the other things mentioned in the proposal.
-- 
Prayank
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210421/1fb43144/attachment.html>

From christopher.gilliard at gmail.com  Wed Apr 21 10:14:20 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Wed, 21 Apr 2021 03:14:20 -0700
Subject: [bitcoin-dev] BIPs - notarization protocol and decentralized
	storage
In-Reply-To: <MYmfT1n--3-2@tutanota.de>
References: <MYmfT1n--3-2@tutanota.de>
Message-ID: <CAK=nyAwPryUxknAsxhEXCXzn_CRr0AMTUOKNcO17wnr1huXJWA@mail.gmail.com>

Thanks Prayank. I think the next step for both of these proposals is to
define an API. I thought about including that in the BIPs and decided it
wasn't necessary yet to get the ideas across initially. Maybe when the APIs
are defined they could go into the BIP, but it's probably better to have in
a different document. I also agree with you on Tor.

As far as whether this should be a BIP or not, I wondered that same
question. I think the BIP format is well defined and understood so I used
it for this and the other BIPs that I'm currently working on like the
incentivized moderation protocol which is mentioned in this BIP. There are
a number of "Application" BIPs, which is why I decided it made sense.
However, if it's decided there's a better format for these BIPs I'm open to
it.

Regards,
Chris



On Tue, Apr 20, 2021 at 9:26 PM Prayank <prayank at tutanota.de> wrote:

> Hello Christopher,
>
> Decentralized storage as an idea looks interesting. I am researching about
> similar things for one of my Bitcoin project. Although an implementation or
> proof of concept code in the BIP would have been better. Also since this
> involves LN, maybe it can just be a LN project instead of BIP? Not the best
> person to comment on what can be a BIP.
>
> Few links that you may find interesting:
>
> https://github.com/bkiac/tarnhelm
>
> https://github.com/ElementsProject/filebazaar
>
> The kind of decentralized storage that I think can be helpful for Bitcoin
> projects:
>
> 1.Uses torrents for files and communication required (with Tor)
>
> 2.Easy to use API to save, read, edit etc. something in a Bitcoin project
> using torrents. Only involve lightning network and payments when spamming
> can be an issue. For example: If a developer wants users to pay for every
> P2P offer they create using a DEX protocol.
>
> Projects that are exploring such options:
> https://github.com/JoinMarket-Org/joinmarket-clientserver/issues/415
>
> --
> Prayank
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210421/3bf15d90/attachment-0001.html>

From christopher.gilliard at gmail.com  Wed Apr 21 20:28:15 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Wed, 21 Apr 2021 13:28:15 -0700
Subject: [bitcoin-dev] Decentralized Naming Protocol BIP
Message-ID: <CAK=nyAy=crLBSLjtOHNLQd0THN9+S7hBCqjfsik=Nh7iiyeT1A@mail.gmail.com>

I have created an additional BIP that is associated with the recent BIPs
that I have sent to the mailing list. This one defines a decentralized
naming protocol. The BIP can be found here:
https://github.com/cgilliard/bips/blob/naming/bip-XXXX.mediawiki

Please reply with any feedback, questions, or comments.

Regards,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210421/e6f00665/attachment.html>

From yanmaani at cock.li  Thu Apr 22 20:55:22 2021
From: yanmaani at cock.li (yanmaani at cock.li)
Date: Thu, 22 Apr 2021 20:55:22 +0000
Subject: [bitcoin-dev] Decentralized Naming Protocol BIP
In-Reply-To: <CAK=nyAy=crLBSLjtOHNLQd0THN9+S7hBCqjfsik=Nh7iiyeT1A@mail.gmail.com>
References: <CAK=nyAy=crLBSLjtOHNLQd0THN9+S7hBCqjfsik=Nh7iiyeT1A@mail.gmail.com>
Message-ID: <7745d0c91c7e63bfe6095c250d7fcaf4@cock.li>

You appear to have reinvented Namecoin ;)

On 2021-04-21 20:28, Christopher Gilliard via bitcoin-dev wrote:
> I have created an additional BIP that is associated with the recent
> BIPs that I have sent to the mailing list. This one defines a
> decentralized naming protocol. The BIP can be found
> here:https://github.com/cgilliard/bips/blob/naming/bip-XXXX.mediawiki
> 
> Please reply with any feedback, questions, or comments.
> 
> Regards,
> Chris
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

From christopher.gilliard at gmail.com  Thu Apr 22 21:32:19 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Thu, 22 Apr 2021 14:32:19 -0700
Subject: [bitcoin-dev] Decentralized Naming Protocol BIP
In-Reply-To: <7745d0c91c7e63bfe6095c250d7fcaf4@cock.li>
References: <CAK=nyAy=crLBSLjtOHNLQd0THN9+S7hBCqjfsik=Nh7iiyeT1A@mail.gmail.com>
 <7745d0c91c7e63bfe6095c250d7fcaf4@cock.li>
Message-ID: <CAK=nyAztjLQV0tEaFdGCBMD5KcXag8qk_-nYapQZgWR+z8akXw@mail.gmail.com>

Yeah, kinda, but without the alt and integrated into the other systems that
I've proposed and it maps names to onion addresses instead of ips. It's
needed for some of the applications I've been thinking about.

On Thu, Apr 22, 2021 at 1:55 PM <yanmaani at cock.li> wrote:

> You appear to have reinvented Namecoin ;)
>
> On 2021-04-21 20:28, Christopher Gilliard via bitcoin-dev wrote:
> > I have created an additional BIP that is associated with the recent
> > BIPs that I have sent to the mailing list. This one defines a
> > decentralized naming protocol. The BIP can be found
> > here:https://github.com/cgilliard/bips/blob/naming/bip-XXXX.mediawiki
> >
> > Please reply with any feedback, questions, or comments.
> >
> > Regards,
> > Chris
> > _______________________________________________
> > bitcoin-dev mailing list
> > bitcoin-dev at lists.linuxfoundation.org
> > https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210422/e13ae27a/attachment-0001.html>

From jlrubin at mit.edu  Thu Apr 22 22:41:56 2021
From: jlrubin at mit.edu (Jeremy)
Date: Thu, 22 Apr 2021 15:41:56 -0700
Subject: [bitcoin-dev] And Then What? Defining a Complete Process for
	Upgrades
Message-ID: <CAD5xwhg+tzjsz9fSoSxKV4oqgemr5p2ETaf-7vzQW+rg6Q_GFg@mail.gmail.com>

This letter is particularly aimed at addressing Rusty Russell's quest for a
development process that respects all groups in a balance of powers.
However, in the spirit of open discussion, I'm sending it directly to the
list.

This proposal is aimed to be compatible with Taproot's ST, and I hope will
help us form some rough consensus around what we try next. Some of the
concepts here are synthesized from what I've seen discussed, but I haven't
included citations of anyone's specific ideas as I'm not sure of the exact
provenance -- I won't claim to have invented this per se, I'm trying to
capture the zeitgeist of what anyone might think to be the process if
pressed to draw it out. Lemme know how I did.

The specific parameters are up for debate, but I'm trying to make sure I've
captured the relevant state transitions.

In this diagram time flows left-to-right, and transitions happen at the
beginning, end, or middle of a block of time. It should be relatively clear
when things happen, but if not, please ask to clarify.

[image: Activation.png]

Clarifications:
- ST: Speedy trial, whereby > T% signals on a block activate the rule
- neg-ST: Speedy Trial, whereby >X% signals on a block Reject the rule
- neg-ST and ST at the same time on different bits: 11 or 00 are "abstain"
votes and are discarded. only 10 or 01 are counted. The purpose of
simultaneous bits is to allow both earlier lock in and to permit early
failure, rather than just one or the other.
- PoW Fork: If a new rule is active, but there is insufficient hashrate,
the rule must be abandoned or PoW must be changed to minimize disruption.
In order to minimize disruption, a node will consider an alternative PoW
chain if < 1/4 of the typical hash rate is seen for a day. Alternative PoW
is defined as SHA-256 10,000 layers, and starts at low difficulty. This is
selected to be maximally similar to Bitcoin's existing PoW, but
sufficiently different to obviate extant ASICS. A node will consider the
new PoW to be equal in value to the old PoW, and will select between the
two based on most-work. Work can be either within a single chain. The new
PoW should have a difficulty adjustment every day for the first month, at
which point, it will relax to every 2 weeks. The details of this should be
described in a separate BIP.
- PoW Fork Lockin: PoW fork is only *required* once the new rule is active.
Thus it's not required in the case of mandatory signalling to force the
signalling contemporaneously, but it can be used to commit to forking the
PoW at some time in the future. It may make sense to not activate the new
rule till the new PoW is active. The game theory of this should be studied
carefully, it is my opinion that the safest option is to PoW fork during
signalling as otherwise miners may protest progress at all.
- Changes: Any time the underlying activation proposal is changed, the
process is restarted. E.g., suppose taproot is rejected because Quantum
Scaries, and we hash the key. The process restarts from the beginning.
Restarts can only occur during quieting periods.
- Quieting Period 1: In the first quieting period, if reached, the "Bitcoin
Core Community" can release the next step, or change the BIP. I left out
failing in this period as a change or a redeployment should always be
attempted.
- Quieting Period 2: In the second quieting period, the outcome is either
to reject the change entirely or to agree to force it. The "Bitcoin Core
Community" may also prepare the release at this stage, and sign, but should
re-label the client as "Bitcoin Community's <Feature> Forcing Client".  A
release labeled "Bitcoin Core" may also be made without mandatory
signalling and without forced activation can also be made, such a client
should have (depending on if the flag day is to use signalling) either
ability to activate in response to signalling or a hidden
<feature>activeathash parameter to allow clients to enable the feature
post-hoc of the activating block.
- Forced Signalling: It's unclear to me the merit of forced signalling
being 90% of 2016 blocks v.s. 90% of 100 blocks. A shorter forced signaling
assuages certain concerns around lost hashrate -- 1 day of disruption is a
lot better than 2 weeks.
- Timeline: As spec'd above, this whole process takes about 2 years worst
case. ST1 0 months; Quieting 1 at 3 months; ST2 at 6 months; Quieting 2 at
9 months, final attempt at 1 year. The Forcing client period should
probably be 1 yr till active. This is *a bit* slower than the "BIP8
LOT=True UASF Client", but I think not so much slower that it's unworkable.

The most contentious part of this I intuit to be the PoW Fork -- please,
let's avoid discussing the mechanic of how to most safely accomplish this.
The main point of including it in this diagram is to emphasize that if you
commit to being on a minority chain with because of a rule activation with,
say, 5% hashrate, you would experience very tangible disruption. In theory,
every fork upgrade (even signalled) entails such a risk, but we assume some
level of miner honesty (unfortunately!) that they never signal falsely.
This may be a bad assumption with mandatory signalling. The alternative is
to permit hard forks in our diagram, and allow users to downgrade their
client and deactivate this rule. Since this can lead to loss of funds, we
do not consider this a safe option, and it is a hardfork as well so is
technically compatible with the "PoW fork" branch.


Questions I have:

1) What state transitions are missing from this diagram? Are there other
paths that should be included?
2) Is it ever feasible to make a change to the upgrade and not restart the
whole process?
3) How long should all of the periods be? Can the 1st 2 ST's be 3 month?
Should we make the second one 6 month? Does it depend on previous signalled
hashrate?
4) Do we ever adjust signalling thresholds?
5) Does forced signalling need to be 2016 blocks?
6) In the second ST should the min active height be allowed to be within
signalling time if > 3 mo?
7) Under what circumstances would we *want* to skip the second ST period
and directly signal? What would we lose by committing to not skipping it,
ever (6 months?).
8) I purposefully left the purple edge from ST2 bit 2 to Quieting 2: in
theory, this edge is not there because it is overruled by the neg-ST
failing to fail. Under what circumstances might we give this precedence
over neg-ST? E.g., signalling activate < 50%?
9) How much parameter flexibility do we have during Quieting periods?
Should we be fixed beforehand?
10) who wants to write the software for any of this... *noses*
11) do we need to hard-code the PoW fork ahead of time? Or can it just be
"prepared" as an alt binary in case of emergency?



Best,

Jeremy



--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210422/f50fe48c/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Activation.png
Type: image/png
Size: 81125 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210422/f50fe48c/attachment-0001.png>

From keagan.mcclelland at gmail.com  Fri Apr 23 00:06:02 2021
From: keagan.mcclelland at gmail.com (Keagan McClelland)
Date: Thu, 22 Apr 2021 18:06:02 -0600
Subject: [bitcoin-dev] And Then What? Defining a Complete Process for
	Upgrades
In-Reply-To: <CAD5xwhg+tzjsz9fSoSxKV4oqgemr5p2ETaf-7vzQW+rg6Q_GFg@mail.gmail.com>
References: <CAD5xwhg+tzjsz9fSoSxKV4oqgemr5p2ETaf-7vzQW+rg6Q_GFg@mail.gmail.com>
Message-ID: <CALeFGL0BxuM6_QL-ujhPhU5=HpYnTaBZfPsA9HXSLp7wuJCt7A@mail.gmail.com>

Hi Jeremy,

First off, thank you for putting this together and trying to organize
discussion around a repeatable process for soft-fork upgrades. As I read
this I am struggling to identify the complete set of problems that this
process is attempting to solve for. My best understanding of the gridlock
that happened around the LOT parameter of BIP 8 is the fact that a flag day
finale of the deployment had the *optics* of being developer controlled,
despite the fact that upgrades are voluntary and opt in since there is no
automatic upgrade mechanism within Bitcoin Core. So I am generally
unconvinced by that argument. The alternative (the advancement of various
LOT=false proposals including ST) is that we are letting the miners
*actually* exert a level of control over the protocol by imbuing them with
the power to veto these proposals. At a 10% signalling threshold needed to
block the upgrade, in addition to the fact that mining is an enterprise
engaged in by a comparatively small portion of the user base, the
constituency required to block proposals under this model is remarkably
small. I don't think anyone is satisfied with the idea of indefinitely
letting miners have veto power over proposals. So the question is, "what
then?".

The particular gripe I have with the situation is that I generally believe
that *any* LOT=false deployment that is ultimately upheld (not reattempted)
is a ceding of control of the protocol to the miners, at the very least in
that instance if not more generally due to the possible emboldening of more
non-cooperative actors for personal gain at the expense of other network
participants. On the other hand, any LOT=false deployment that is
immediately followed up with something approximating a LOT=true/flag
day/UASF deployment is ultimately a charade and can be handily replaced
with LOT=true with an extended timeline. The common rebuttal I hear from
this is that a LOT=false deployment "helps us learn something" and is
usually an appeal to the difference between stated and revealed preference.
However, I have not been able to get past the idea of exactly what we plan
to learn from this? If we do not trust stated preferences for protocol
changes, and we *only* trust revealed preference, then it seems like the
only thing we can learn is that "miners will not voluntarily make this
upgrade" and any arguments about why are ultimately as speculative as the
stated preferences prior to any Soft Fork deployment at all. As such, I
don't think we learn basically anything useful.

Against the above backdrop, it is hard for me to think that a LOT=false
policy is *ever* sensible. In this case, I have advocated for ST because I
think it will either activate quickly, or prove out in general that a
LOT=false policy just doesn't work (quickly). In all of the discussions I
have been party to, I have not once witnessed someone who would accept the
final upholding of a miner veto on Taproot in particular, yet in the same
session, many of those participants are advocating for LOT=false anyway.
This seems incoherent to me.

So what are we actually solving for?

The idea as I understand it is to distribute power among Bitcoin's
different constituencies in such a way that we A. block "bad upgrades"
always, and B. do our best to activate "good upgrades". However, I feel it
necessary to caution against the fetishization of triumvirate governance
for its own sake. In my mind, anything that doesn't generally respect the
notion that the users are in control of the protocol is not too dissimilar
from the decentralization theater that some Bitcoiners criticize various
altcoins for.

So why not just UASF from the getgo?

This I have started to understand more clearly but still get hung up on
certain details. I think the only universal claim about this is "avoid deep
chain splits at all costs" where "deep" is anything that is going to ruin
upper layers of Bitcoin including institutional operations practices. For
as long as I've been developing applications on top of Bitcoin the
"generally accepted default" seems to be that 6 block reorgs are the
"untouchable limit". However, this is where the details become really
important. By definition, blocks conforming to soft-fork rules are accepted
by the pre-fork implementations. In the other direction, there exists a
subset of blocks that can be produced by pre-fork miners that will not be
accepted by the soft-fork rules. So, in this case, the risk incurred by the
SF clients is that the chain halts. The risk incurred by the pre-fork
implementations is that there are reorgs that result in economic losses.
However, in order for the reorgs to actually occur, miners have to
persistently mine invalid blocks. The reason I make the distinction about
"persistently" is that pre-fork implementations *will accept* soft-fork
compliant blocks. This means that the same incentive structures that cause
miners to switch to mining atop new blocks instead of continuing to mine
atop older ones, apply just as much in this case. Chain convergence is
*guaranteed* with as little as 51% (though this is eventual, and may not be
an acceptable threshold if you're trying to keep the probability of deep
reorgs to some astronomically low threshold). Furthermore, chain
convergence is probable with far less than that threshold, though I'm less
sure of this claim and am open to a rebuttal on this.

The only wrench in the above line of reasoning is the issue of forced
signaling. I've never been a fan of forced signaling. The only thing it
guards against is apathy, which I think is solved with even the threat of
having your mined blocks being reorged out by including invalid
transactions in them.

So to summarize my understanding of what's going on here: we don't want
MASF due to concentration of power, we don't want UASF because of the risk
of chain split. The only way to reconcile this is to show miners that users
more strongly value work done on a chain enforcing the soft fork rules than
one that doesn't, ideally with costly signaling. This is the only way users
can effectively exercise an override on miner preference in a backwards
compatible way and substantially reduces or eliminates chain split risk. I
don't think the proposal above does anything to alleviate this issue. In
fact, if I read it correctly, it rules out the possibility of any UASF
altogether by making it such that a failed MASF forces the users to
hard-fork the protocol. I think that this would be rather tragic since
avoidance of hard forks is one of the biggest victories that came out of
2017. I apologize for not addressing the proposal in a more direct way and
engaging with the details, however, I don't think that discussing the
process makes any sense until we can agree what is being solved, and what
risks are flat out unacceptable. Perhaps laying those out in a
followup response can make it easier for me to engage with the actual
process.

In my mind any proposal that doesn't include a mechanism for gathering
reliable information about user-preference in a way that is sybil resistant
doesn't make any meaningful progress on a consensus change process. I have
only two ideas in this area and both of them don't seem fantastic. The
first one, fork futures, has been discussed at length by people more
experienced than I. The second, is a mechanism that makes mining
transactions that express fork preference (in an as-yet undefined way)
contingent upon the block signaling for it. The details of how to pull that
off may make it such that it is DOA, but it would at least give users a way
to broadcast a costly signal of their preference.

Keagan

On Thu, Apr 22, 2021 at 4:57 PM Jeremy via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> This letter is particularly aimed at addressing Rusty Russell's quest for
> a development process that respects all groups in a balance of powers.
> However, in the spirit of open discussion, I'm sending it directly to the
> list.
>
> This proposal is aimed to be compatible with Taproot's ST, and I hope will
> help us form some rough consensus around what we try next. Some of the
> concepts here are synthesized from what I've seen discussed, but I haven't
> included citations of anyone's specific ideas as I'm not sure of the exact
> provenance -- I won't claim to have invented this per se, I'm trying to
> capture the zeitgeist of what anyone might think to be the process if
> pressed to draw it out. Lemme know how I did.
>
> The specific parameters are up for debate, but I'm trying to make sure
> I've captured the relevant state transitions.
>
> In this diagram time flows left-to-right, and transitions happen at the
> beginning, end, or middle of a block of time. It should be relatively clear
> when things happen, but if not, please ask to clarify.
>
> [image: Activation.png]
>
> Clarifications:
> - ST: Speedy trial, whereby > T% signals on a block activate the rule
> - neg-ST: Speedy Trial, whereby >X% signals on a block Reject the rule
> - neg-ST and ST at the same time on different bits: 11 or 00 are "abstain"
> votes and are discarded. only 10 or 01 are counted. The purpose of
> simultaneous bits is to allow both earlier lock in and to permit early
> failure, rather than just one or the other.
> - PoW Fork: If a new rule is active, but there is insufficient hashrate,
> the rule must be abandoned or PoW must be changed to minimize disruption.
> In order to minimize disruption, a node will consider an alternative PoW
> chain if < 1/4 of the typical hash rate is seen for a day. Alternative PoW
> is defined as SHA-256 10,000 layers, and starts at low difficulty. This is
> selected to be maximally similar to Bitcoin's existing PoW, but
> sufficiently different to obviate extant ASICS. A node will consider the
> new PoW to be equal in value to the old PoW, and will select between the
> two based on most-work. Work can be either within a single chain. The new
> PoW should have a difficulty adjustment every day for the first month, at
> which point, it will relax to every 2 weeks. The details of this should be
> described in a separate BIP.
> - PoW Fork Lockin: PoW fork is only *required* once the new rule is
> active. Thus it's not required in the case of mandatory signalling to force
> the signalling contemporaneously, but it can be used to commit to forking
> the PoW at some time in the future. It may make sense to not activate the
> new rule till the new PoW is active. The game theory of this should be
> studied carefully, it is my opinion that the safest option is to PoW fork
> during signalling as otherwise miners may protest progress at all.
> - Changes: Any time the underlying activation proposal is changed, the
> process is restarted. E.g., suppose taproot is rejected because Quantum
> Scaries, and we hash the key. The process restarts from the beginning.
> Restarts can only occur during quieting periods.
> - Quieting Period 1: In the first quieting period, if reached, the
> "Bitcoin Core Community" can release the next step, or change the BIP. I
> left out failing in this period as a change or a redeployment should always
> be attempted.
> - Quieting Period 2: In the second quieting period, the outcome is either
> to reject the change entirely or to agree to force it. The "Bitcoin Core
> Community" may also prepare the release at this stage, and sign, but should
> re-label the client as "Bitcoin Community's <Feature> Forcing Client".  A
> release labeled "Bitcoin Core" may also be made without mandatory
> signalling and without forced activation can also be made, such a client
> should have (depending on if the flag day is to use signalling) either
> ability to activate in response to signalling or a hidden
> <feature>activeathash parameter to allow clients to enable the feature
> post-hoc of the activating block.
> - Forced Signalling: It's unclear to me the merit of forced signalling
> being 90% of 2016 blocks v.s. 90% of 100 blocks. A shorter forced signaling
> assuages certain concerns around lost hashrate -- 1 day of disruption is a
> lot better than 2 weeks.
> - Timeline: As spec'd above, this whole process takes about 2 years worst
> case. ST1 0 months; Quieting 1 at 3 months; ST2 at 6 months; Quieting 2 at
> 9 months, final attempt at 1 year. The Forcing client period should
> probably be 1 yr till active. This is *a bit* slower than the "BIP8
> LOT=True UASF Client", but I think not so much slower that it's unworkable.
>
> The most contentious part of this I intuit to be the PoW Fork -- please,
> let's avoid discussing the mechanic of how to most safely accomplish this.
> The main point of including it in this diagram is to emphasize that if you
> commit to being on a minority chain with because of a rule activation with,
> say, 5% hashrate, you would experience very tangible disruption. In theory,
> every fork upgrade (even signalled) entails such a risk, but we assume some
> level of miner honesty (unfortunately!) that they never signal falsely.
> This may be a bad assumption with mandatory signalling. The alternative is
> to permit hard forks in our diagram, and allow users to downgrade their
> client and deactivate this rule. Since this can lead to loss of funds, we
> do not consider this a safe option, and it is a hardfork as well so is
> technically compatible with the "PoW fork" branch.
>
>
> Questions I have:
>
> 1) What state transitions are missing from this diagram? Are there other
> paths that should be included?
> 2) Is it ever feasible to make a change to the upgrade and not restart the
> whole process?
> 3) How long should all of the periods be? Can the 1st 2 ST's be 3 month?
> Should we make the second one 6 month? Does it depend on previous signalled
> hashrate?
> 4) Do we ever adjust signalling thresholds?
> 5) Does forced signalling need to be 2016 blocks?
> 6) In the second ST should the min active height be allowed to be within
> signalling time if > 3 mo?
> 7) Under what circumstances would we *want* to skip the second ST period
> and directly signal? What would we lose by committing to not skipping it,
> ever (6 months?).
> 8) I purposefully left the purple edge from ST2 bit 2 to Quieting 2: in
> theory, this edge is not there because it is overruled by the neg-ST
> failing to fail. Under what circumstances might we give this precedence
> over neg-ST? E.g., signalling activate < 50%?
> 9) How much parameter flexibility do we have during Quieting periods?
> Should we be fixed beforehand?
> 10) who wants to write the software for any of this... *noses*
> 11) do we need to hard-code the PoW fork ahead of time? Or can it just be
> "prepared" as an alt binary in case of emergency?
>
>
>
> Best,
>
> Jeremy
>
>
>
> --
> @JeremyRubin <https://twitter.com/JeremyRubin>
> <https://twitter.com/JeremyRubin>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210422/36f791a8/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Activation.png
Type: image/png
Size: 81125 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210422/36f791a8/attachment-0001.png>

From luke at dashjr.org  Fri Apr 23 02:09:05 2021
From: luke at dashjr.org (Luke Dashjr)
Date: Fri, 23 Apr 2021 02:09:05 +0000
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
Message-ID: <202104230209.05373.luke@dashjr.org>

Unless there are objections, I intend to add Kalle Alm as a BIP editor to 
assist in merging PRs into the bips git repo.

Since there is no explicit process to adding BIP editors, IMO it should be 
fine to use BIP 2's Process BIP progression:

> A process BIP may change status from Draft to Active when it achieves
> rough consensus on the mailing list. Such a proposal is said to have
> rough consensus if it has been open to discussion on the development
> mailing list for at least one month, and no person maintains any
> unaddressed substantiated objections to it.

A Process BIP could be opened for each new editor, but IMO that is 
unnecessary. If anyone feels there is a need for a new Process BIP, we can go 
that route, but there is prior precedent for BIP editors appointing new BIP 
editors, so I think this should be fine.

Please speak up soon if you disagree.

Luke

From jlrubin at mit.edu  Fri Apr 23 03:36:16 2021
From: jlrubin at mit.edu (Jeremy)
Date: Thu, 22 Apr 2021 20:36:16 -0700
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <202104230209.05373.luke@dashjr.org>
References: <202104230209.05373.luke@dashjr.org>
Message-ID: <CAD5xwhgy1dkKqbWY=n1_p5MfbNwJweCHZotkD6hj7K4kv+wg3Q@mail.gmail.com>

ACK adding Kalle.

Kalle is a qualified reviewer / editor and well suited for this role.
--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>


On Thu, Apr 22, 2021 at 7:09 PM Luke Dashjr via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Unless there are objections, I intend to add Kalle Alm as a BIP editor to
> assist in merging PRs into the bips git repo.
>
> Since there is no explicit process to adding BIP editors, IMO it should be
> fine to use BIP 2's Process BIP progression:
>
> > A process BIP may change status from Draft to Active when it achieves
> > rough consensus on the mailing list. Such a proposal is said to have
> > rough consensus if it has been open to discussion on the development
> > mailing list for at least one month, and no person maintains any
> > unaddressed substantiated objections to it.
>
> A Process BIP could be opened for each new editor, but IMO that is
> unnecessary. If anyone feels there is a need for a new Process BIP, we can
> go
> that route, but there is prior precedent for BIP editors appointing new
> BIP
> editors, so I think this should be fine.
>
> Please speak up soon if you disagree.
>
> Luke
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210422/322af051/attachment.html>

From pindar.wong at gmail.com  Fri Apr 23 07:50:53 2021
From: pindar.wong at gmail.com (Pindar Wong)
Date: Fri, 23 Apr 2021 15:50:53 +0800
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <202104230209.05373.luke@dashjr.org>
References: <202104230209.05373.luke@dashjr.org>
Message-ID: <CAM7BtUq=TSo18di_i=cQLm3G3as4B6=hvfREKi8DOEEDyvmF7A@mail.gmail.com>

ACK.

p.


On Fri, Apr 23, 2021 at 10:09 AM Luke Dashjr via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Unless there are objections, I intend to add Kalle Alm as a BIP editor to
> assist in merging PRs into the bips git repo.
>
> Since there is no explicit process to adding BIP editors, IMO it should be
> fine to use BIP 2's Process BIP progression:
>
> > A process BIP may change status from Draft to Active when it achieves
> > rough consensus on the mailing list. Such a proposal is said to have
> > rough consensus if it has been open to discussion on the development
> > mailing list for at least one month, and no person maintains any
> > unaddressed substantiated objections to it.
>
> A Process BIP could be opened for each new editor, but IMO that is
> unnecessary. If anyone feels there is a need for a new Process BIP, we can
> go
> that route, but there is prior precedent for BIP editors appointing new
> BIP
> editors, so I think this should be fine.
>
> Please speak up soon if you disagree.
>
> Luke
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/0849a63a/attachment.html>

From john at johnnewbery.com  Fri Apr 23 07:49:39 2021
From: john at johnnewbery.com (John Newbery)
Date: Fri, 23 Apr 2021 08:49:39 +0100
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <CAD5xwhgy1dkKqbWY=n1_p5MfbNwJweCHZotkD6hj7K4kv+wg3Q@mail.gmail.com>
References: <202104230209.05373.luke@dashjr.org>
 <CAD5xwhgy1dkKqbWY=n1_p5MfbNwJweCHZotkD6hj7K4kv+wg3Q@mail.gmail.com>
Message-ID: <CAFmfg2viPZ+_be0jPD_JQ=S1Mo6qc4E4zc26sEiudVFKcL6qCQ@mail.gmail.com>

ACK adding Kalle.

On Fri, Apr 23, 2021 at 4:36 AM Jeremy via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> ACK adding Kalle.
>
> Kalle is a qualified reviewer / editor and well suited for this role.
> --
> @JeremyRubin <https://twitter.com/JeremyRubin>
> <https://twitter.com/JeremyRubin>
>
>
> On Thu, Apr 22, 2021 at 7:09 PM Luke Dashjr via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> Unless there are objections, I intend to add Kalle Alm as a BIP editor to
>> assist in merging PRs into the bips git repo.
>>
>> Since there is no explicit process to adding BIP editors, IMO it should
>> be
>> fine to use BIP 2's Process BIP progression:
>>
>> > A process BIP may change status from Draft to Active when it achieves
>> > rough consensus on the mailing list. Such a proposal is said to have
>> > rough consensus if it has been open to discussion on the development
>> > mailing list for at least one month, and no person maintains any
>> > unaddressed substantiated objections to it.
>>
>> A Process BIP could be opened for each new editor, but IMO that is
>> unnecessary. If anyone feels there is a need for a new Process BIP, we
>> can go
>> that route, but there is prior precedent for BIP editors appointing new
>> BIP
>> editors, so I think this should be fine.
>>
>> Please speak up soon if you disagree.
>>
>> Luke
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/8b232111/attachment.html>

From eric at ericmartindale.com  Fri Apr 23 09:11:41 2021
From: eric at ericmartindale.com (Eric Martindale)
Date: Fri, 23 Apr 2021 05:11:41 -0400
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <CAM7BtUq=TSo18di_i=cQLm3G3as4B6=hvfREKi8DOEEDyvmF7A@mail.gmail.com>
References: <202104230209.05373.luke@dashjr.org>
 <CAM7BtUq=TSo18di_i=cQLm3G3as4B6=hvfREKi8DOEEDyvmF7A@mail.gmail.com>
Message-ID: <CAAf19WpOBvWwk71uP6+b8swZZ3YsEvLd++bOxwf0xyhmPcvqAg@mail.gmail.com>

ACK.  Kalle has been exceptional throughout his contributions ? especially
thankful for btcdeb ?

On Fri, Apr 23, 2021, 3:51 AM Pindar Wong via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> ACK.
>
> p.
>
>
> On Fri, Apr 23, 2021 at 10:09 AM Luke Dashjr via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> Unless there are objections, I intend to add Kalle Alm as a BIP editor to
>> assist in merging PRs into the bips git repo.
>>
>> Since there is no explicit process to adding BIP editors, IMO it should
>> be
>> fine to use BIP 2's Process BIP progression:
>>
>> > A process BIP may change status from Draft to Active when it achieves
>> > rough consensus on the mailing list. Such a proposal is said to have
>> > rough consensus if it has been open to discussion on the development
>> > mailing list for at least one month, and no person maintains any
>> > unaddressed substantiated objections to it.
>>
>> A Process BIP could be opened for each new editor, but IMO that is
>> unnecessary. If anyone feels there is a need for a new Process BIP, we
>> can go
>> that route, but there is prior precedent for BIP editors appointing new
>> BIP
>> editors, so I think this should be fine.
>>
>> Please speak up soon if you disagree.
>>
>> Luke
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/40b1cafb/attachment-0001.html>

From jlrubin at mit.edu  Fri Apr 23 15:25:19 2021
From: jlrubin at mit.edu (Jeremy)
Date: Fri, 23 Apr 2021 08:25:19 -0700
Subject: [bitcoin-dev] [Lightning-dev] L2s Onchain Support IRC Workshop
In-Reply-To: <CALZpt+E_e=0rjq5_XazV_qH2h=uQrpTLbMRe2K7jVterSAr05w@mail.gmail.com>
References: <CALZpt+E_e=0rjq5_XazV_qH2h=uQrpTLbMRe2K7jVterSAr05w@mail.gmail.com>
Message-ID: <CAD5xwhjUP+=TWtJWSjwFLit7finoVOwpF8bMydOxxVeV8M9oOA@mail.gmail.com>

I'd be excited to join. Recommend bumping the date  to mid June, if that's
ok, as many Americans will be at Bitcoin 2021.

I was thinking about reviving the sponsors proposal with a 100 block lock
on spending a sponsoring tx which would hopefully make less controversial,
this would be a great place to discuss those tradeoffs.

On Fri, Apr 23, 2021, 8:17 AM Antoine Riard <antoine.riard at gmail.com> wrote:

> Hi,
>
> During the lastest years, tx-relay and mempool acceptances rules of the
> base layer have been sources of major security and operational concerns for
> Lightning and other Bitcoin second-layers [0]. I think those areas require
> significant improvements to ease design and deployment of higher Bitcoin
> layers and I believe this opinion is shared among the L2 dev community. In
> order to make advancements, it has been discussed a few times in the last
> months to organize in-person workshops to discuss those issues with the
> presence of both L1/L2 devs to make exchange fruitful.
>
> Unfortunately, I don't think we'll be able to organize such in-person
> workshops this year (because you know travel is hard those days...) As a
> substitution, I'm proposing a series of one or more irc meetings. That
> said, this substitution has the happy benefit to gather far more folks
> interested by those issues that you can fit in a room.
>
> # Scope
>
> I would like to propose the following 4 items as topics of discussion.
>
> 1) Package relay design or another generic L2 fee-bumping primitive like
> sponsorship [0]. IMHO, this primitive should at least solve mempools spikes
> making obsolete propagation of transactions with pre-signed feerate, solve
> pinning attacks compromising Lightning/multi-party contract protocol
> safety, offer an usable and stable API to L2 software stack, stay
> compatible with miner and full-node operators incentives and obviously
> minimize CPU/memory DoS vectors.
>
> 2) Deprecation of opt-in RBF toward full-rbf. Opt-in RBF makes it trivial
> for an attacker to partition network mempools in divergent subsets and from
> then launch advanced security or privacy attacks against a Lightning node.
> Note, it might also be a concern for bandwidth bleeding attacks against L1
> nodes.
>
> 3) Guidelines about coordinated cross-layers security disclosures.
> Mitigating a security issue around tx-relay or the mempool in Core might
> have harmful implications for downstream projects. Ideally, L2 projects
> maintainers should be ready to upgrade their protocols in emergency in
> coordination with base layers developers.
>
> 4) Guidelines about L2 protocols onchain security design. Currently
> deployed like Lightning are making a bunch of assumptions on tx-relay and
> mempool acceptances rules. Those rules are non-normative, non-reliable and
> lack documentation. Further, they're devoid of tooling to enforce them at
> runtime [2]. IMHO, it could be preferable to identify a subset of them on
> which second-layers protocols can do assumptions without encroaching too
> much on nodes's policy realm or making the base layer development in those
> areas too cumbersome.
>
> I'm aware that some folks are interested in other topics such as extension
> of Core's mempools package limits or better pricing of RBF replacement. So
> l propose a 2-week concertation period to submit other topics related to
> tx-relay or mempools improvements towards L2s before to propose a finalized
> scope and agenda.
>
> # Goals
>
> 1) Reaching technical consensus.
> 2) Reaching technical consensus, before seeking community consensus as it
> likely has ecosystem-wide implications.
> 3) Establishing a security incident response policy which can be applied
> by dev teams in the future.
> 4) Establishing a philosophy design and associated documentations (BIPs,
> best practices, ...)
>
> # Timeline
>
> 2021-04-23: Start of concertation period
> 2021-05-07: End of concertation period
> 2021-05-10: Proposition of workshop agenda and schedule
> late 2021-05/2021-06: IRC meetings
>
> As the problem space is savagely wide, I've started a collection of
> documents to assist this workshop : https://github.com/ariard/L2-zoology
> Still wip, but I'll have them in a good shape at agenda publication, with
> reading suggestions and open questions to structure discussions.
> Also working on transaction pinning and mempool partitions attacks
> simulations.
>
> If L2s security/p2p/mempool is your jam, feel free to get involved :)
>
> Cheers,
> Antoine
>
> [0] For e.g see optech section on transaction pinning attacks :
> https://bitcoinops.org/en/topics/transaction-pinning/
> [1]
> https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-September/018168.html
> [2] Lack of reference tooling make it easier to have bug slip in like
> https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html
> _______________________________________________
> Lightning-dev mailing list
> Lightning-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/4e8df87e/attachment.html>

From antoine.riard at gmail.com  Fri Apr 23 15:11:56 2021
From: antoine.riard at gmail.com (Antoine Riard)
Date: Fri, 23 Apr 2021 11:11:56 -0400
Subject: [bitcoin-dev] L2s Onchain Support IRC Workshop
Message-ID: <CALZpt+E_e=0rjq5_XazV_qH2h=uQrpTLbMRe2K7jVterSAr05w@mail.gmail.com>

Hi,

During the lastest years, tx-relay and mempool acceptances rules of the
base layer have been sources of major security and operational concerns for
Lightning and other Bitcoin second-layers [0]. I think those areas require
significant improvements to ease design and deployment of higher Bitcoin
layers and I believe this opinion is shared among the L2 dev community. In
order to make advancements, it has been discussed a few times in the last
months to organize in-person workshops to discuss those issues with the
presence of both L1/L2 devs to make exchange fruitful.

Unfortunately, I don't think we'll be able to organize such in-person
workshops this year (because you know travel is hard those days...) As a
substitution, I'm proposing a series of one or more irc meetings. That
said, this substitution has the happy benefit to gather far more folks
interested by those issues that you can fit in a room.

# Scope

I would like to propose the following 4 items as topics of discussion.

1) Package relay design or another generic L2 fee-bumping primitive like
sponsorship [0]. IMHO, this primitive should at least solve mempools spikes
making obsolete propagation of transactions with pre-signed feerate, solve
pinning attacks compromising Lightning/multi-party contract protocol
safety, offer an usable and stable API to L2 software stack, stay
compatible with miner and full-node operators incentives and obviously
minimize CPU/memory DoS vectors.

2) Deprecation of opt-in RBF toward full-rbf. Opt-in RBF makes it trivial
for an attacker to partition network mempools in divergent subsets and from
then launch advanced security or privacy attacks against a Lightning node.
Note, it might also be a concern for bandwidth bleeding attacks against L1
nodes.

3) Guidelines about coordinated cross-layers security disclosures.
Mitigating a security issue around tx-relay or the mempool in Core might
have harmful implications for downstream projects. Ideally, L2 projects
maintainers should be ready to upgrade their protocols in emergency in
coordination with base layers developers.

4) Guidelines about L2 protocols onchain security design. Currently
deployed like Lightning are making a bunch of assumptions on tx-relay and
mempool acceptances rules. Those rules are non-normative, non-reliable and
lack documentation. Further, they're devoid of tooling to enforce them at
runtime [2]. IMHO, it could be preferable to identify a subset of them on
which second-layers protocols can do assumptions without encroaching too
much on nodes's policy realm or making the base layer development in those
areas too cumbersome.

I'm aware that some folks are interested in other topics such as extension
of Core's mempools package limits or better pricing of RBF replacement. So
l propose a 2-week concertation period to submit other topics related to
tx-relay or mempools improvements towards L2s before to propose a finalized
scope and agenda.

# Goals

1) Reaching technical consensus.
2) Reaching technical consensus, before seeking community consensus as it
likely has ecosystem-wide implications.
3) Establishing a security incident response policy which can be applied by
dev teams in the future.
4) Establishing a philosophy design and associated documentations (BIPs,
best practices, ...)

# Timeline

2021-04-23: Start of concertation period
2021-05-07: End of concertation period
2021-05-10: Proposition of workshop agenda and schedule
late 2021-05/2021-06: IRC meetings

As the problem space is savagely wide, I've started a collection of
documents to assist this workshop : https://github.com/ariard/L2-zoology
Still wip, but I'll have them in a good shape at agenda publication, with
reading suggestions and open questions to structure discussions.
Also working on transaction pinning and mempool partitions attacks
simulations.

If L2s security/p2p/mempool is your jam, feel free to get involved :)

Cheers,
Antoine

[0] For e.g see optech section on transaction pinning attacks :
https://bitcoinops.org/en/topics/transaction-pinning/
[1]
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-September/018168.html
[2] Lack of reference tooling make it easier to have bug slip in like
https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/98e1f2cc/attachment-0001.html>

From antoine.riard at gmail.com  Fri Apr 23 15:34:53 2021
From: antoine.riard at gmail.com (Antoine Riard)
Date: Fri, 23 Apr 2021 11:34:53 -0400
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <202104230209.05373.luke@dashjr.org>
References: <202104230209.05373.luke@dashjr.org>
Message-ID: <CALZpt+Hz3jFnA8z1w6yictdHWnnKReMK+6eEHg_jUZ7==xNZzQ@mail.gmail.com>

Hi Luke,

For the records and the subscribers of this list not following
#bitcoin-core-dev, this mail follows a discussion which did happen during
yesterday irc meetings.
Logs here : http://gnusha.org/bitcoin-core-dev/2021-04-22.log

I'll reiterate my opinion expressed during the meeting. If this proposal to
extend the bip editorship membership doesn't satisfy parties involved or
anyone in the community, I'm strongly opposed to have the matter sliced by
admins of the Bitcoin github org. I believe that defect or uncertainty in
the BIP Process shouldn't be solved by GH janitorial roles and I think
their roles don't bestow to intervene in case of loopholes. Further, you
have far more contributors involved in the BIP Process rather than only
Bitcoin Core ones. FWIW, such precedent merits would be quite similar to
lobby directly GH staff...

Unless we harm Bitcoin users by not acting, I think we should always be
respectful of procedural forms. And in the lack of such forms, stay patient
until a solution satisfy everyone.

I would recommend the BIP editorship, once extended or not, to move in its
own repository in the future.

Cheers,
Antoine




Le jeu. 22 avr. 2021 ? 22:09, Luke Dashjr via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> a ?crit :

> Unless there are objections, I intend to add Kalle Alm as a BIP editor to
> assist in merging PRs into the bips git repo.
>
> Since there is no explicit process to adding BIP editors, IMO it should be
> fine to use BIP 2's Process BIP progression:
>
> > A process BIP may change status from Draft to Active when it achieves
> > rough consensus on the mailing list. Such a proposal is said to have
> > rough consensus if it has been open to discussion on the development
> > mailing list for at least one month, and no person maintains any
> > unaddressed substantiated objections to it.
>
> A Process BIP could be opened for each new editor, but IMO that is
> unnecessary. If anyone feels there is a need for a new Process BIP, we can
> go
> that route, but there is prior precedent for BIP editors appointing new
> BIP
> editors, so I think this should be fine.
>
> Please speak up soon if you disagree.
>
> Luke
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/fb5bccd8/attachment-0001.html>

From antoine.riard at gmail.com  Fri Apr 23 15:39:15 2021
From: antoine.riard at gmail.com (Antoine Riard)
Date: Fri, 23 Apr 2021 11:39:15 -0400
Subject: [bitcoin-dev] [Lightning-dev] L2s Onchain Support IRC Workshop
In-Reply-To: <CAD5xwhjUP+=TWtJWSjwFLit7finoVOwpF8bMydOxxVeV8M9oOA@mail.gmail.com>
References: <CALZpt+E_e=0rjq5_XazV_qH2h=uQrpTLbMRe2K7jVterSAr05w@mail.gmail.com>
 <CAD5xwhjUP+=TWtJWSjwFLit7finoVOwpF8bMydOxxVeV8M9oOA@mail.gmail.com>
Message-ID: <CALZpt+FOuN0HN607ri=nmoyPHaixVR810Qqo9xc41Q_Rq4h9mQ@mail.gmail.com>

Hi Jeremy,

Yes dates are floating for now. After Bitcoin 2021, sounds a good idea.

Awesome, I'll be really interested to review again an improved version of
sponsorship. And I'll try to sketch out the sighash_no-input fee-bumping
idea which was floating around last year during pinnings discussions. Yet
another set of trade-offs :)

Le ven. 23 avr. 2021 ? 11:25, Jeremy <jlrubin at mit.edu> a ?crit :

> I'd be excited to join. Recommend bumping the date  to mid June, if that's
> ok, as many Americans will be at Bitcoin 2021.
>
> I was thinking about reviving the sponsors proposal with a 100 block lock
> on spending a sponsoring tx which would hopefully make less controversial,
> this would be a great place to discuss those tradeoffs.
>
> On Fri, Apr 23, 2021, 8:17 AM Antoine Riard <antoine.riard at gmail.com>
> wrote:
>
>> Hi,
>>
>> During the lastest years, tx-relay and mempool acceptances rules of the
>> base layer have been sources of major security and operational concerns for
>> Lightning and other Bitcoin second-layers [0]. I think those areas require
>> significant improvements to ease design and deployment of higher Bitcoin
>> layers and I believe this opinion is shared among the L2 dev community. In
>> order to make advancements, it has been discussed a few times in the last
>> months to organize in-person workshops to discuss those issues with the
>> presence of both L1/L2 devs to make exchange fruitful.
>>
>> Unfortunately, I don't think we'll be able to organize such in-person
>> workshops this year (because you know travel is hard those days...) As a
>> substitution, I'm proposing a series of one or more irc meetings. That
>> said, this substitution has the happy benefit to gather far more folks
>> interested by those issues that you can fit in a room.
>>
>> # Scope
>>
>> I would like to propose the following 4 items as topics of discussion.
>>
>> 1) Package relay design or another generic L2 fee-bumping primitive like
>> sponsorship [0]. IMHO, this primitive should at least solve mempools spikes
>> making obsolete propagation of transactions with pre-signed feerate, solve
>> pinning attacks compromising Lightning/multi-party contract protocol
>> safety, offer an usable and stable API to L2 software stack, stay
>> compatible with miner and full-node operators incentives and obviously
>> minimize CPU/memory DoS vectors.
>>
>> 2) Deprecation of opt-in RBF toward full-rbf. Opt-in RBF makes it trivial
>> for an attacker to partition network mempools in divergent subsets and from
>> then launch advanced security or privacy attacks against a Lightning node.
>> Note, it might also be a concern for bandwidth bleeding attacks against L1
>> nodes.
>>
>> 3) Guidelines about coordinated cross-layers security disclosures.
>> Mitigating a security issue around tx-relay or the mempool in Core might
>> have harmful implications for downstream projects. Ideally, L2 projects
>> maintainers should be ready to upgrade their protocols in emergency in
>> coordination with base layers developers.
>>
>> 4) Guidelines about L2 protocols onchain security design. Currently
>> deployed like Lightning are making a bunch of assumptions on tx-relay and
>> mempool acceptances rules. Those rules are non-normative, non-reliable and
>> lack documentation. Further, they're devoid of tooling to enforce them at
>> runtime [2]. IMHO, it could be preferable to identify a subset of them on
>> which second-layers protocols can do assumptions without encroaching too
>> much on nodes's policy realm or making the base layer development in those
>> areas too cumbersome.
>>
>> I'm aware that some folks are interested in other topics such as
>> extension of Core's mempools package limits or better pricing of RBF
>> replacement. So l propose a 2-week concertation period to submit other
>> topics related to tx-relay or mempools improvements towards L2s before to
>> propose a finalized scope and agenda.
>>
>> # Goals
>>
>> 1) Reaching technical consensus.
>> 2) Reaching technical consensus, before seeking community consensus as it
>> likely has ecosystem-wide implications.
>> 3) Establishing a security incident response policy which can be applied
>> by dev teams in the future.
>> 4) Establishing a philosophy design and associated documentations (BIPs,
>> best practices, ...)
>>
>> # Timeline
>>
>> 2021-04-23: Start of concertation period
>> 2021-05-07: End of concertation period
>> 2021-05-10: Proposition of workshop agenda and schedule
>> late 2021-05/2021-06: IRC meetings
>>
>> As the problem space is savagely wide, I've started a collection of
>> documents to assist this workshop : https://github.com/ariard/L2-zoology
>> Still wip, but I'll have them in a good shape at agenda publication, with
>> reading suggestions and open questions to structure discussions.
>> Also working on transaction pinning and mempool partitions attacks
>> simulations.
>>
>> If L2s security/p2p/mempool is your jam, feel free to get involved :)
>>
>> Cheers,
>> Antoine
>>
>> [0] For e.g see optech section on transaction pinning attacks :
>> https://bitcoinops.org/en/topics/transaction-pinning/
>> [1]
>> https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-September/018168.html
>> [2] Lack of reference tooling make it easier to have bug slip in like
>> https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html
>> _______________________________________________
>> Lightning-dev mailing list
>> Lightning-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/b87b1ec8/attachment.html>

From bastien at acinq.fr  Fri Apr 23 16:17:36 2021
From: bastien at acinq.fr (Bastien TEINTURIER)
Date: Fri, 23 Apr 2021 18:17:36 +0200
Subject: [bitcoin-dev] [Lightning-dev] L2s Onchain Support IRC Workshop
In-Reply-To: <CALZpt+FOuN0HN607ri=nmoyPHaixVR810Qqo9xc41Q_Rq4h9mQ@mail.gmail.com>
References: <CALZpt+E_e=0rjq5_XazV_qH2h=uQrpTLbMRe2K7jVterSAr05w@mail.gmail.com>
 <CAD5xwhjUP+=TWtJWSjwFLit7finoVOwpF8bMydOxxVeV8M9oOA@mail.gmail.com>
 <CALZpt+FOuN0HN607ri=nmoyPHaixVR810Qqo9xc41Q_Rq4h9mQ@mail.gmail.com>
Message-ID: <CACdvm3Mnf7Xuts9z+WiyyK=Pm2iWy_VT9bGSAUsATtxjGUS4uw@mail.gmail.com>

Great idea, I'll join as well.
Thanks for setting this in motion.

Le ven. 23 avr. 2021 ? 17:39, Antoine Riard <antoine.riard at gmail.com> a
?crit :

> Hi Jeremy,
>
> Yes dates are floating for now. After Bitcoin 2021, sounds a good idea.
>
> Awesome, I'll be really interested to review again an improved version of
> sponsorship. And I'll try to sketch out the sighash_no-input fee-bumping
> idea which was floating around last year during pinnings discussions. Yet
> another set of trade-offs :)
>
> Le ven. 23 avr. 2021 ? 11:25, Jeremy <jlrubin at mit.edu> a ?crit :
>
>> I'd be excited to join. Recommend bumping the date  to mid June, if
>> that's ok, as many Americans will be at Bitcoin 2021.
>>
>> I was thinking about reviving the sponsors proposal with a 100 block lock
>> on spending a sponsoring tx which would hopefully make less controversial,
>> this would be a great place to discuss those tradeoffs.
>>
>> On Fri, Apr 23, 2021, 8:17 AM Antoine Riard <antoine.riard at gmail.com>
>> wrote:
>>
>>> Hi,
>>>
>>> During the lastest years, tx-relay and mempool acceptances rules of the
>>> base layer have been sources of major security and operational concerns for
>>> Lightning and other Bitcoin second-layers [0]. I think those areas require
>>> significant improvements to ease design and deployment of higher Bitcoin
>>> layers and I believe this opinion is shared among the L2 dev community. In
>>> order to make advancements, it has been discussed a few times in the last
>>> months to organize in-person workshops to discuss those issues with the
>>> presence of both L1/L2 devs to make exchange fruitful.
>>>
>>> Unfortunately, I don't think we'll be able to organize such in-person
>>> workshops this year (because you know travel is hard those days...) As a
>>> substitution, I'm proposing a series of one or more irc meetings. That
>>> said, this substitution has the happy benefit to gather far more folks
>>> interested by those issues that you can fit in a room.
>>>
>>> # Scope
>>>
>>> I would like to propose the following 4 items as topics of discussion.
>>>
>>> 1) Package relay design or another generic L2 fee-bumping primitive like
>>> sponsorship [0]. IMHO, this primitive should at least solve mempools spikes
>>> making obsolete propagation of transactions with pre-signed feerate, solve
>>> pinning attacks compromising Lightning/multi-party contract protocol
>>> safety, offer an usable and stable API to L2 software stack, stay
>>> compatible with miner and full-node operators incentives and obviously
>>> minimize CPU/memory DoS vectors.
>>>
>>> 2) Deprecation of opt-in RBF toward full-rbf. Opt-in RBF makes it
>>> trivial for an attacker to partition network mempools in divergent subsets
>>> and from then launch advanced security or privacy attacks against a
>>> Lightning node. Note, it might also be a concern for bandwidth bleeding
>>> attacks against L1 nodes.
>>>
>>> 3) Guidelines about coordinated cross-layers security disclosures.
>>> Mitigating a security issue around tx-relay or the mempool in Core might
>>> have harmful implications for downstream projects. Ideally, L2 projects
>>> maintainers should be ready to upgrade their protocols in emergency in
>>> coordination with base layers developers.
>>>
>>> 4) Guidelines about L2 protocols onchain security design. Currently
>>> deployed like Lightning are making a bunch of assumptions on tx-relay and
>>> mempool acceptances rules. Those rules are non-normative, non-reliable and
>>> lack documentation. Further, they're devoid of tooling to enforce them at
>>> runtime [2]. IMHO, it could be preferable to identify a subset of them on
>>> which second-layers protocols can do assumptions without encroaching too
>>> much on nodes's policy realm or making the base layer development in those
>>> areas too cumbersome.
>>>
>>> I'm aware that some folks are interested in other topics such as
>>> extension of Core's mempools package limits or better pricing of RBF
>>> replacement. So l propose a 2-week concertation period to submit other
>>> topics related to tx-relay or mempools improvements towards L2s before to
>>> propose a finalized scope and agenda.
>>>
>>> # Goals
>>>
>>> 1) Reaching technical consensus.
>>> 2) Reaching technical consensus, before seeking community consensus as
>>> it likely has ecosystem-wide implications.
>>> 3) Establishing a security incident response policy which can be applied
>>> by dev teams in the future.
>>> 4) Establishing a philosophy design and associated documentations (BIPs,
>>> best practices, ...)
>>>
>>> # Timeline
>>>
>>> 2021-04-23: Start of concertation period
>>> 2021-05-07: End of concertation period
>>> 2021-05-10: Proposition of workshop agenda and schedule
>>> late 2021-05/2021-06: IRC meetings
>>>
>>> As the problem space is savagely wide, I've started a collection of
>>> documents to assist this workshop : https://github.com/ariard/L2-zoology
>>> Still wip, but I'll have them in a good shape at agenda publication,
>>> with reading suggestions and open questions to structure discussions.
>>> Also working on transaction pinning and mempool partitions attacks
>>> simulations.
>>>
>>> If L2s security/p2p/mempool is your jam, feel free to get involved :)
>>>
>>> Cheers,
>>> Antoine
>>>
>>> [0] For e.g see optech section on transaction pinning attacks :
>>> https://bitcoinops.org/en/topics/transaction-pinning/
>>> [1]
>>> https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-September/018168.html
>>> [2] Lack of reference tooling make it easier to have bug slip in like
>>> https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html
>>> _______________________________________________
>>> Lightning-dev mailing list
>>> Lightning-dev at lists.linuxfoundation.org
>>> https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev
>>>
>> _______________________________________________
> Lightning-dev mailing list
> Lightning-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/09108adc/attachment-0001.html>

From dave at dtrt.org  Fri Apr 23 18:15:50 2021
From: dave at dtrt.org (David A. Harding)
Date: Fri, 23 Apr 2021 08:15:50 -1000
Subject: [bitcoin-dev] [Pre-BIP] Motivating Address type for OP_RETURN
In-Reply-To: <CAD5xwhj7jXSrdbfFJTYw-UzGgZTF0kz-Vr61juF0gJGLf2EKqQ@mail.gmail.com>
References: <CAD5xwhj7jXSrdbfFJTYw-UzGgZTF0kz-Vr61juF0gJGLf2EKqQ@mail.gmail.com>
Message-ID: <20210423181550.xri2ravlwfe3vpc6@ganymede>

On Tue, Apr 20, 2021 at 08:46:07AM -0700, Jeremy via bitcoin-dev wrote:
> Script is technically "too wide" a type as what I really want is to
> only return coins with known output types.

I don't understand this concern.  If script is too wide a type, then
OP_RETURN being a scriptPubKey of arbitrary length up to almost a
million bytes is also going to be too wide, right?

> 1) Should it be human readable & checksummed or encoded?

It should absolutely not be human readable in the sense of being
meaningful to humans.  We've seen in the past that tools and sites that
display OP_RETURN data as ASCII encourage people to put text in the
block chain that is offensive and illegal.  This puts people running
nodes at risk of social and legal intervention.  Bitcoin's
premissionless nature means we can't stop people from creating such
problems, but we can lower the risk by having our tools default to
meaningless representations of OP_RETURN data.

The best advice I've seen is to display OP_RETURN data in hex.  It's
still possible to say things like "dead beef" with that, but significant
abuse is hard.  This will, of course, make even 80 byte OP_RETURN
"addresses" very long.

> 2) Should it have a fixed length of max 40-80 bytes or should we support
> arbitrary length strings?

If it doesn't support the fell range, somebody's just going to complain
later and there will have to be a v2 address.

> 3) Should it be possible (i.e., from core) to pay into such an OP_RETURN or
> should we categorize OP_RETURNS as a non-payable address type (and just use
> it for parsing blockdata)

I don't think including arbitrary data in the block chain is something
that's currently useful for typical end users, and applications that
want to use OP_RETURN with Bitcoin Core can already call
create(psbt|rawtransaction) with the `data` field, so I'd be mildly
opposed in including such a feature in Bitcoin Core's wallet.  If at
least a few other wallets add the feature to pay OP_RETURN "addresses"
and it seems popular, then I'm wrong and so I would probably then change
my position.

Regarding "parsing block data", I don't think there's any need to change
Bitcoin Core's current representation of OP_RETURN outputs (which is
just showing the hex-encoded script in RPC output).  For any program
needing OP_RETURN output, hex format is going to be a the next best
thing to getting it in raw binary.  Any other address format is going to
be equal or more work.

Additionally, as mentioned in the other thread about OP_RETURN this
week, increasing transaction fees should increasingly push uses of
OP_RETURN off the network or into more efficient constructions, so it
doesn't seem warranted to me to spend a lot of time trying to optimize
how we use it when we'll be using it less and less over time.

-Dave
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/9b78956c/attachment.sig>

From gmaxwell at gmail.com  Sat Apr 24 04:42:12 2021
From: gmaxwell at gmail.com (Greg Maxwell)
Date: Sat, 24 Apr 2021 04:42:12 +0000
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
Message-ID: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>

I am opposed to the addition of Kalle Alm at this time.

Those who believe that adding him will resolve the situation with
Luke-jr's inappropriate behavior re: PR1104 are mistaken.



27e59ffd51ee5a95d0e0faff70e045faca10b00015e90abc1c8de48b1dfff40c

From christopher.gilliard at gmail.com  Sat Apr 24 02:05:53 2021
From: christopher.gilliard at gmail.com (Christopher Gilliard)
Date: Fri, 23 Apr 2021 19:05:53 -0700
Subject: [bitcoin-dev] Additional BIPs related to other proposals
Message-ID: <CAK=nyAxZ3ohoO4NSmHSiUh7+MHDCQcSvPBkOL2=G=VLNyzu07A@mail.gmail.com>

I have created three additional BIPs that are associated with my recent
proposals. They can be found here:

https://github.com/cgilliard/bips/blob/notification/bip-XXXX.mediawiki

and here:

https://github.com/cgilliard/bips/blob/moderation/bip-XXXX.mediawiki

and here:

https://github.com/cgilliard/bips/blob/wot/bip-XXXX.mediawiki

Please reply with any feedback, questions, or comments.

Regards,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210423/c0ef92eb/attachment.html>

From adam.ficsor73 at gmail.com  Sat Apr 24 10:16:15 2021
From: adam.ficsor73 at gmail.com (nopara73)
Date: Sat, 24 Apr 2021 12:16:15 +0200
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <CALZpt+Hz3jFnA8z1w6yictdHWnnKReMK+6eEHg_jUZ7==xNZzQ@mail.gmail.com>
References: <202104230209.05373.luke@dashjr.org>
 <CALZpt+Hz3jFnA8z1w6yictdHWnnKReMK+6eEHg_jUZ7==xNZzQ@mail.gmail.com>
Message-ID: <CAEPKjgfis_vKHVeEOtLWmEjcZs6ODJdf3w48cqqRMEKMbHFyUA@mail.gmail.com>

ACK adding Kalle

On Fri, Apr 23, 2021 at 5:51 PM Antoine Riard via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Hi Luke,
>
> For the records and the subscribers of this list not following
> #bitcoin-core-dev, this mail follows a discussion which did happen during
> yesterday irc meetings.
> Logs here : http://gnusha.org/bitcoin-core-dev/2021-04-22.log
>
> I'll reiterate my opinion expressed during the meeting. If this proposal
> to extend the bip editorship membership doesn't satisfy parties involved or
> anyone in the community, I'm strongly opposed to have the matter sliced by
> admins of the Bitcoin github org. I believe that defect or uncertainty in
> the BIP Process shouldn't be solved by GH janitorial roles and I think
> their roles don't bestow to intervene in case of loopholes. Further, you
> have far more contributors involved in the BIP Process rather than only
> Bitcoin Core ones. FWIW, such precedent merits would be quite similar to
> lobby directly GH staff...
>
> Unless we harm Bitcoin users by not acting, I think we should always be
> respectful of procedural forms. And in the lack of such forms, stay patient
> until a solution satisfy everyone.
>
> I would recommend the BIP editorship, once extended or not, to move in its
> own repository in the future.
>
> Cheers,
> Antoine
>
>
>
>
> Le jeu. 22 avr. 2021 ? 22:09, Luke Dashjr via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> a ?crit :
>
>> Unless there are objections, I intend to add Kalle Alm as a BIP editor to
>> assist in merging PRs into the bips git repo.
>>
>> Since there is no explicit process to adding BIP editors, IMO it should
>> be
>> fine to use BIP 2's Process BIP progression:
>>
>> > A process BIP may change status from Draft to Active when it achieves
>> > rough consensus on the mailing list. Such a proposal is said to have
>> > rough consensus if it has been open to discussion on the development
>> > mailing list for at least one month, and no person maintains any
>> > unaddressed substantiated objections to it.
>>
>> A Process BIP could be opened for each new editor, but IMO that is
>> unnecessary. If anyone feels there is a need for a new Process BIP, we
>> can go
>> that route, but there is prior precedent for BIP editors appointing new
>> BIP
>> editors, so I think this should be fine.
>>
>> Please speak up soon if you disagree.
>>
>> Luke
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>


-- 
Best,
?d?m
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210424/81998e30/attachment.html>

From lf-lists at mattcorallo.com  Sat Apr 24 14:45:46 2021
From: lf-lists at mattcorallo.com (Matt Corallo)
Date: Sat, 24 Apr 2021 10:45:46 -0400
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>
References: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>
Message-ID: <6764cc61-70cc-2033-43bc-347158dcfd62@mattcorallo.com>

What is preventing the BIP maintainership role from moving to a bot? It does seem like a bot should be able to do a fine 
job given the explicit criteria (though ignoring obvious spam is often nice, its by no means a requirement).

Given recent events where humans have....acted like humans, it seems a move to a bot may be warranted.

Matt

On 4/24/21 00:42, Greg Maxwell via bitcoin-dev wrote:
> I am opposed to the addition of Kalle Alm at this time.
> 
> Those who believe that adding him will resolve the situation with
> Luke-jr's inappropriate behavior re: PR1104 are mistaken.
> 
> 
> 
> 27e59ffd51ee5a95d0e0faff70e045faca10b00015e90abc1c8de48b1dfff40c
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> 

From NITSOPOULOS at mail.com  Sat Apr 24 11:02:31 2021
From: NITSOPOULOS at mail.com (NITSOPOULOS KONSTANTINOS)
Date: Sat, 24 Apr 2021 13:02:31 +0200
Subject: [bitcoin-dev] 7z block compression, 18%
Message-ID: <trinity-e57863c6-6327-47b5-b345-623b3f985200-1619262151558@3c-app-mailcom-lxa11>

An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210424/c6756228/attachment.html>

From stick at satoshilabs.com  Sat Apr 24 18:20:47 2021
From: stick at satoshilabs.com (Pavol Rusnak)
Date: Sat, 24 Apr 2021 20:20:47 +0200
Subject: [bitcoin-dev] 7z block compression, 18%
In-Reply-To: <trinity-e57863c6-6327-47b5-b345-623b3f985200-1619262151558@3c-app-mailcom-lxa11>
References: <trinity-e57863c6-6327-47b5-b345-623b3f985200-1619262151558@3c-app-mailcom-lxa11>
Message-ID: <CAF90Avn9beT-JNv8jVE-M6aUJ770N0hfU+rYrzFZAqrn+1wcAA@mail.gmail.com>

If block compression is going to be considered, zstd provides better
properties than the competition.
Especially for the decompression. [1]

[1] https://github.com/facebook/zstd

-- 
Best Regards / S pozdravom,

Pavol "stick" Rusnak
Co-founder and CTO, SatoshiLabs
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210424/ce2320a0/attachment.html>

From gmaxwell at gmail.com  Sat Apr 24 19:17:41 2021
From: gmaxwell at gmail.com (Greg Maxwell)
Date: Sat, 24 Apr 2021 19:17:41 +0000
Subject: [bitcoin-dev] 7z block compression, 18%
In-Reply-To: <trinity-e57863c6-6327-47b5-b345-623b3f985200-1619262151558@3c-app-mailcom-lxa11>
References: <trinity-e57863c6-6327-47b5-b345-623b3f985200-1619262151558@3c-app-mailcom-lxa11>
Message-ID: <CAAS2fgQvJv-r9JeL4LaH9bDBho6cgBStFtNC-mskhKcH9Y29AQ@mail.gmail.com>

https://bitcointalk.org/index.php?topic=5303978.msg55946632#msg55946632

Blockstream satellite codebase includes an alternative serialization
that works a single transaction at a time and saves ~20%.  This avoids
violating layering, preserves single txn access, is compatible with
transaction relay.   (and if you wanted could also be fed to a
multiple txn at a time compressor for additional savings).  This
format makes intelligent use of the entirety of the transaction
format, not just amount encodings but even optimizing predictable
hashes (e.g. for p2sh embedded segwit) -- achieving savings that *no*
generic compressor could ever achieve.

Most of the savings from generic compressors comes from repeated
pubkeys and addresses, so it's highly variable, depends on address
reuse, and will likely be diminished by taproot (due to shrinking
multisig) and very much reduced by signature aggregation in the
future.

If you're thinking about use across networks generic compression
interfaces like zlib have had a pretty disappointing security track
record.


If you search the list archive and bitcoin-core github you'll find
many prior discussions of using generic compressors.



On Sat, Apr 24, 2021 at 6:12 PM NITSOPOULOS KONSTANTINOS via
bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> Hi, I can compress new blocks by up to 18% using the 7z file type. I use wxHexEditor to dump a block's raw hex onto my disk, and then compress that with 7-Zip. I'd like to see 7z built into Bitcoin Core, for block compression (storage & propagation). The entire blockchain could be under 290GB if it's converted into a 7z archive-chain ("7z-chain"). I can compress some recent example blocks (hex -> less hex) if anyone wants. A future BIP could try increase the block Weight Units limit by up to 21% if 7z blocks are smaller & quick.
>
> Programming compression seems too difficult for me, so I'm hoping somebody else does it!
>
> Eventually I think transactions can be compressed by replacing addresses (& public keys) and coins, wherever possible, with just their own unique sequential index. TX amounts can also be compressed if they contain only a decimal digit or two, e.g. 00000000.10000000 XBT. A TX of 0.1 XBT between two existing addresses could be somehow compressed to half or maybe a quarter of its current size!
>
> -Tinos
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

From jlrubin at mit.edu  Sat Apr 24 20:05:25 2021
From: jlrubin at mit.edu (Jeremy)
Date: Sat, 24 Apr 2021 13:05:25 -0700
Subject: [bitcoin-dev] [Pre-BIP] Motivating Address type for OP_RETURN
In-Reply-To: <20210423181550.xri2ravlwfe3vpc6@ganymede>
References: <CAD5xwhj7jXSrdbfFJTYw-UzGgZTF0kz-Vr61juF0gJGLf2EKqQ@mail.gmail.com>
 <20210423181550.xri2ravlwfe3vpc6@ganymede>
Message-ID: <CAD5xwhgnL_u1hS99HPTMBfQbRohgmajzNX4XiGYnN9mZDqjC7g@mail.gmail.com>

Inline responses

On Fri, Apr 23, 2021, 11:18 AM David A. Harding <dave at dtrt.org> wrote:

> On Tue, Apr 20, 2021 at 08:46:07AM -0700, Jeremy via bitcoin-dev wrote:
>
>
>
>
>
> * > Script is technically "too wide" a type as what I really want is to >
> only return coins with known output types. I don't understand this
> concern.  If script is too wide a type, then OP_RETURN being a scriptPubKey
> of arbitrary length up to almost a million bytes is also going to be too
> wide, right?*
>


I meant the type itself is too wide, not the length of the value. As in
Script can represent things we know nothing about. There's a bit of leaky
abstraction since the values self describe the type they are. For addresses
it's just representations IMO for the standard output types one might
expect from standard software.

Btw: According to... Oh wait... You?
https://bitcoin.stackexchange.com/questions/35878/is-there-a-maximum-size-of-a-scriptsig-scriptpubkey
the max size is 10k bytes. Still probably too big for an address, but I'd
be ok with making op_return addresses only defined for a small size (e.g.
128 bytes?)



>
>
>
>
>
>
>
>
>
>
>
>
>
>
> * > 1) Should it be human readable & checksummed or encoded? It should
> absolutely not be human readable in the sense of being meaningful to
> humans.  We've seen in the past that tools and sites that display OP_RETURN
> data as ASCII encourage people to put text in the block chain that is
> offensive and illegal.  This puts people running nodes at risk of social
> and legal intervention.  Bitcoin's premissionless nature means we can't
> stop people from creating such problems, but we can lower the risk by
> having our tools default to meaningless representations of OP_RETURN data.
> The best advice I've seen is to display OP_RETURN data in hex.  It's still
> possible to say things like "dead beef" with that, but significant abuse is
> hard.  This will, of course, make even 80 byte OP_RETURN "addresses" very
> long.*
>

Is it possible/easy to, say, using bech32m make an inappropriate message in
the address? You'd have to write the message, then see what it decodes to
without checking, and then re encode? I guess this is worse than hex?

But it seems this is a general thing... If you wanted an inappropriate
message you could therefore just use bech32m addressed outputs.


> >
>
>
>
> * 2) Should it have a fixed length of max 40-80 bytes or should we support
> > arbitrary length strings? If it doesn't support the fell range,
> somebody's just going to complain later and there will have to be a v2
> address.*
>

So 10,000 bytes? Or do we care to represent outputs that would be consensus
invalid?



>
>
>
>
>
>
>
>
>
>
>
> * > 3) Should it be possible (i.e., from core) to pay into such an
> OP_RETURN or > should we categorize OP_RETURNS as a non-payable address
> type (and just use > it for parsing blockdata) I don't think including
> arbitrary data in the block chain is something that's currently useful for
> typical end users, and applications that want to use OP_RETURN with Bitcoin
> Core can already call create(psbt|rawtransaction) with the `data` field, so
> I'd be mildly opposed in including such a feature in Bitcoin Core's
> wallet.  If at least a few other wallets add the feature to pay OP_RETURN
> "addresses" and it seems popular, then I'm wrong and so I would probably
> then change my position.*
>

One of the nice things is that the current psbt interface uses a blind
union type whereby the entires in an array are either [address, amount] or
["data", hex]. Having an address type would allow more uniform handling,
which is convenient for strongly typed RPC bindings (e.g. rust bitcoin uses
a hashmap of address to amount so without a patch you can't create op
returns).


>
>
>
>
>
> * Regarding "parsing block data", I don't think there's any need to change
> Bitcoin Core's current representation of OP_RETURN outputs (which is just
> showing the hex-encoded script in RPC output).  For any program needing
> OP_RETURN output, hex format is going to be a the next best thing to
> getting it in raw binary.  Any other address format is going to be equal or
> more work*.
>

Thats a fair point. I'm mostly thinking about this in the context of
strongly typed languages/frameworks where you'll get an address object or
enum out, rather than something *stringly* typed. But yes in terms of
stringy languages I don't think any changes are needed.

*Additionally, as mentioned in the other thread about OP_RETURN this*
*week, increasing transaction fees should increasingly push uses of*
*OP_RETURN off the network or into more efficient constructions, so it*
*doesn't seem warranted to me to spend a lot of time trying to optimize*
*how we use it when we'll be using it less and less over time.*


Hmm. I agree it should get priced out over time. However there are some
uses for this kind of stuff. E.g. stealth addresses, or a single instance
of open time stamps.

The main reason I think they merit some sort of std address type is that
I'm writing software that can handle things that we might reasonably see on
the network. And it's relatively annoying (without a custom type) to
represent OP_RETURN as a not-exceptional type of thing.

In my code what I have done is added the following type:

pub enum ExtendedAddress {
/// A regular standard address type
Address(bitcoin::Address),
/// An OP_RETURN
OpReturn(OpReturn),
/// Unknown
Unknown(bitcoin::Script),
}
Which works more or less fine, but I would much prefer to not have to do
this in a custom way, as opposed to a way which is defined in a standard
manner across all software (after all, that's the point of standards).

Best,

Jeremy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210424/a12ae065/attachment-0001.html>

From dave at dtrt.org  Sat Apr 24 21:59:00 2021
From: dave at dtrt.org (David A. Harding)
Date: Sat, 24 Apr 2021 11:59:00 -1000
Subject: [bitcoin-dev] [Pre-BIP] Motivating Address type for OP_RETURN
In-Reply-To: <CAD5xwhgnL_u1hS99HPTMBfQbRohgmajzNX4XiGYnN9mZDqjC7g@mail.gmail.com>
References: <CAD5xwhj7jXSrdbfFJTYw-UzGgZTF0kz-Vr61juF0gJGLf2EKqQ@mail.gmail.com>
 <20210423181550.xri2ravlwfe3vpc6@ganymede>
 <CAD5xwhgnL_u1hS99HPTMBfQbRohgmajzNX4XiGYnN9mZDqjC7g@mail.gmail.com>
Message-ID: <20210424215900.nufcy6uzjzompdbs@ganymede>

On Sat, Apr 24, 2021 at 01:05:25PM -0700, Jeremy wrote:
> I meant the type itself is too wide, not the length of the value. As in
> Script can represent things we know nothing about. 

I guess I still don't understand your concern, then.  If script can
represent things we know nothing about, then script commitments such as
P2SH, P2WSH, and P2TR also represent things we know nothing about.  All
you know is what container format they used.  For P2PK, bare multisig,
OP_RETURN, and other direct uses of scriptPubKey, that container format
is "bare" (or whatever you want to call it).

> Btw: According to... Oh wait... You?
> https://bitcoin.stackexchange.com/questions/35878/is-there-a-maximum-size-of-a-scriptsig-scriptpubkey
> the max size is 10k bytes.

I'm not sure what I knew at the time I wrote that answer, but the 10,000
byte limit is only applied when EvalScript is run, which only happens
when the output is being spent.  I've appended to this email a
demonstration of creating a 11,000 byte OP_RETURN on regtest (I tried
999,000 bytes but ran into problems with bash's maximum command line
length limit).  I've updated the answer to hopefully make it more
correct.

> Is it possible/easy to, say, using bech32m make an inappropriate message in
> the address? You'd have to write the message, then see what it decodes to
> without checking, and then re encode? I guess this is worse than hex?

If someone wants to abuse bech32m, I suspect they'll do it the same way
people have abused base58check[1], by using the address format's
alphabet directly.  E.g., you compose your message using only
the characters qpzry9x8gf2tvdw0s3jn54khce6mua7l and then append
the appropriate checksum.

[1] https://en.bitcoin.it/wiki/P2SH%C2%B2#The_problem:_storing_data_in_hashes

> But it seems this is a general thing... If you wanted an inappropriate
> message you could therefore just use bech32m addressed outputs.

Yes, and people have done that with base58check.  IsStandard OP_RETURN
attempts to minimize that abuse by being cheaper in two ways:

1. More data allowed in scriptSig, e.g. 80 byte payload (81 actually, I
   think) for OP_RETURN versus 40 bytes for a BIP141 payload.
   Maximizing payload size better amortizes the overhead cost of the
   containing transaction and the output's nValue field.

2. Exemption from the dust limit.  If you use a currently defined
   address type, the nValue needs to pay at least a few thousand nBTC
   (few hundred satoshis), about $0.15 USD minimum at $50k USD/BTC.  For
   OP_RETURN, the nValue can be 0, so there's no additional cost beyond
   normal transaction relay fees.

Although someone creating an OP_RETURN up to ~1 MB with miner support
can bypass the dust limit, the efficiency advantage remains no matter
what.

> One of the nice things is that the current psbt interface uses a blind
> union type whereby the entires in an array are either [address, amount] or
> ["data", hex]. Having an address type would allow more uniform handling,
> which is convenient for strongly typed RPC bindings (e.g. rust bitcoin uses
> a hashmap of address to amount so without a patch you can't create op
> returns).

I don't particularly care how the data in PSBTs are structured.  My mild
opposition was to adding code to the wallet that exposes everyday users
to OP_RETURN addresses.

> I would much prefer to not have to do this in a custom way, as opposed
> to a way which is defined in a standard manner across all software
> (after all, that's the point of standards).

I'm currently +0.1 on the idea of an address format of OP_RETURN, but I
want to make sure this isn't underwhelmingly motivated or will lead to a
resurgence of block chain graffiti.

-Dave

## Creating an 11,000 byte OP_RETURN

$ bitcoind -daemon -regtest -acceptnonstdtxn
Bitcoin Core starting

$ bitcoin-cli -regtest -generate 101
{
  "address": "bcrt1qh9uka5z040vx2rc3ltz3tpwmq4y2mt0eufux9r",
  "blocks": [
[...]
}

$ bitcoin-cli -regtest send '[{"data": "'$( dd if=/dev/zero bs=1000 count=11 | xxd -g0 -p | tr -d '\n' )'"}]'
11+0 records in
11+0 records out
11000 bytes (11 kB, 11 KiB) copied, 0.000161428 s, 68.1 MB/s
{
  "txid": "ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51",
  "complete": true
}

$ bitcoin-cli -regtest getrawmempool
[
  "ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51"
]

$ bitcoin-cli -regtest -generate 1
{
  "address": "bcrt1qlzjd90tkfkr09m867zxhte9rqd3t03wc5py5zh",
  "blocks": [
    "2986e9588c5bd26a629020b1ce8014d1f4ac9ac19106d216d3abb3a314c5604b"
  ]
}

$bitcoin-cli -regtest getblock 2986e9588c5bd26a629020b1ce8014d1f4ac9ac19106d216d3abb3a314c5604b 2 | jq .tx[1].txid
"ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51"
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210424/a3d85f0a/attachment.sig>

From jlrubin at mit.edu  Sat Apr 24 22:29:39 2021
From: jlrubin at mit.edu (Jeremy)
Date: Sat, 24 Apr 2021 15:29:39 -0700
Subject: [bitcoin-dev] [Pre-BIP] Motivating Address type for OP_RETURN
In-Reply-To: <20210424215900.nufcy6uzjzompdbs@ganymede>
References: <CAD5xwhj7jXSrdbfFJTYw-UzGgZTF0kz-Vr61juF0gJGLf2EKqQ@mail.gmail.com>
 <20210423181550.xri2ravlwfe3vpc6@ganymede>
 <CAD5xwhgnL_u1hS99HPTMBfQbRohgmajzNX4XiGYnN9mZDqjC7g@mail.gmail.com>
 <20210424215900.nufcy6uzjzompdbs@ganymede>
Message-ID: <CAD5xwhjP7OiZj4J-Tmt0YiXY16v+_qmEcV6F9G9oAZkEqi8kCg@mail.gmail.com>

I guess in the interest of being clear; I don't particularly want a
OP_RETURN address either, they're just annoying to program around, and they
exist historically, as well as perhaps in the future.

Maybe people will start using the annex space to add any metadata required?
E.g. stealth addresses. I kinda hope not, but probably will be proposed as
a SF since it's much cheaper (witness + no amount) and per-input vs. per-tx.

It's interesting that they can be created with any length... i guess any
script can be an op return if you make it long enough...
--
@JeremyRubin <https://twitter.com/JeremyRubin>
<https://twitter.com/JeremyRubin>


On Sat, Apr 24, 2021 at 3:00 PM David A. Harding <dave at dtrt.org> wrote:

> On Sat, Apr 24, 2021 at 01:05:25PM -0700, Jeremy wrote:
> > I meant the type itself is too wide, not the length of the value. As in
> > Script can represent things we know nothing about.
>
> I guess I still don't understand your concern, then.  If script can
> represent things we know nothing about, then script commitments such as
> P2SH, P2WSH, and P2TR also represent things we know nothing about.  All
> you know is what container format they used.  For P2PK, bare multisig,
> OP_RETURN, and other direct uses of scriptPubKey, that container format
> is "bare" (or whatever you want to call it).
>
> > Btw: According to... Oh wait... You?
> >
> https://bitcoin.stackexchange.com/questions/35878/is-there-a-maximum-size-of-a-scriptsig-scriptpubkey
> > the max size is 10k bytes.
>
> I'm not sure what I knew at the time I wrote that answer, but the 10,000
> byte limit is only applied when EvalScript is run, which only happens
> when the output is being spent.  I've appended to this email a
> demonstration of creating a 11,000 byte OP_RETURN on regtest (I tried
> 999,000 bytes but ran into problems with bash's maximum command line
> length limit).  I've updated the answer to hopefully make it more
> correct.
>
> > Is it possible/easy to, say, using bech32m make an inappropriate message
> in
> > the address? You'd have to write the message, then see what it decodes to
> > without checking, and then re encode? I guess this is worse than hex?
>
> If someone wants to abuse bech32m, I suspect they'll do it the same way
> people have abused base58check[1], by using the address format's
> alphabet directly.  E.g., you compose your message using only
> the characters qpzry9x8gf2tvdw0s3jn54khce6mua7l and then append
> the appropriate checksum.
>
> [1]
> https://en.bitcoin.it/wiki/P2SH%C2%B2#The_problem:_storing_data_in_hashes
>
> > But it seems this is a general thing... If you wanted an inappropriate
> > message you could therefore just use bech32m addressed outputs.
>
> Yes, and people have done that with base58check.  IsStandard OP_RETURN
> attempts to minimize that abuse by being cheaper in two ways:
>
> 1. More data allowed in scriptSig, e.g. 80 byte payload (81 actually, I
>    think) for OP_RETURN versus 40 bytes for a BIP141 payload.
>    Maximizing payload size better amortizes the overhead cost of the
>    containing transaction and the output's nValue field.
>
> 2. Exemption from the dust limit.  If you use a currently defined
>    address type, the nValue needs to pay at least a few thousand nBTC
>    (few hundred satoshis), about $0.15 USD minimum at $50k USD/BTC.  For
>    OP_RETURN, the nValue can be 0, so there's no additional cost beyond
>    normal transaction relay fees.
>
> Although someone creating an OP_RETURN up to ~1 MB with miner support
> can bypass the dust limit, the efficiency advantage remains no matter
> what.
>
> > One of the nice things is that the current psbt interface uses a blind
> > union type whereby the entires in an array are either [address, amount]
> or
> > ["data", hex]. Having an address type would allow more uniform handling,
> > which is convenient for strongly typed RPC bindings (e.g. rust bitcoin
> uses
> > a hashmap of address to amount so without a patch you can't create op
> > returns).
>
> I don't particularly care how the data in PSBTs are structured.  My mild
> opposition was to adding code to the wallet that exposes everyday users
> to OP_RETURN addresses.
>
> > I would much prefer to not have to do this in a custom way, as opposed
> > to a way which is defined in a standard manner across all software
> > (after all, that's the point of standards).
>
> I'm currently +0.1 on the idea of an address format of OP_RETURN, but I
> want to make sure this isn't underwhelmingly motivated or will lead to a
> resurgence of block chain graffiti.
>
> -Dave
>
> ## Creating an 11,000 byte OP_RETURN
>
> $ bitcoind -daemon -regtest -acceptnonstdtxn
> Bitcoin Core starting
>
> $ bitcoin-cli -regtest -generate 101
> {
>   "address": "bcrt1qh9uka5z040vx2rc3ltz3tpwmq4y2mt0eufux9r",
>   "blocks": [
> [...]
> }
>
> $ bitcoin-cli -regtest send '[{"data": "'$( dd if=/dev/zero bs=1000
> count=11 | xxd -g0 -p | tr -d '\n' )'"}]'
> 11+0 records in
> 11+0 records out
> 11000 bytes (11 kB, 11 KiB) copied, 0.000161428 s, 68.1 MB/s
> {
>   "txid":
> "ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51",
>   "complete": true
> }
>
> $ bitcoin-cli -regtest getrawmempool
> [
>   "ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51"
> ]
>
> $ bitcoin-cli -regtest -generate 1
> {
>   "address": "bcrt1qlzjd90tkfkr09m867zxhte9rqd3t03wc5py5zh",
>   "blocks": [
>     "2986e9588c5bd26a629020b1ce8014d1f4ac9ac19106d216d3abb3a314c5604b"
>   ]
> }
>
> $bitcoin-cli -regtest getblock
> 2986e9588c5bd26a629020b1ce8014d1f4ac9ac19106d216d3abb3a314c5604b 2 | jq
> .tx[1].txid
> "ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51"
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210424/b01e361e/attachment.html>

From zachgrw at gmail.com  Sat Apr 24 23:37:56 2021
From: zachgrw at gmail.com (Zac Greenwood)
Date: Sun, 25 Apr 2021 01:37:56 +0200
Subject: [bitcoin-dev] [Pre-BIP] Motivating Address type for OP_RETURN
In-Reply-To: <20210424215900.nufcy6uzjzompdbs@ganymede>
References: <CAD5xwhj7jXSrdbfFJTYw-UzGgZTF0kz-Vr61juF0gJGLf2EKqQ@mail.gmail.com>
 <20210423181550.xri2ravlwfe3vpc6@ganymede>
 <CAD5xwhgnL_u1hS99HPTMBfQbRohgmajzNX4XiGYnN9mZDqjC7g@mail.gmail.com>
 <20210424215900.nufcy6uzjzompdbs@ganymede>
Message-ID: <CAJ4-pEDmHctqx7XEqGO5--au7YmLpOnUvf3qhxbatujFJtvjvA@mail.gmail.com>

> 1. More data allowed in scriptSig, e.g. 80 byte payload (81 actually, I
>   think) for OP_RETURN versus 40 bytes for a BIP141 payload.
>   Maximizing payload size better amortizes the overhead cost of the
>   containing transaction and the output's nValue field.

In order to reduce the footprint of data stored on-chain, could it perhaps
be beneficial to introduce some non-transaction data structure in order to
facilitate storing data on-chain such that it maximizes payload size
vs. on-chain size, while at the same time ensuring that using such data
structure is (almost) as expensive in use per payload-byte as the
next-cheapest alternative (which now is using OP_RETURN) with
help of weight units?

Zac


On Sun, Apr 25, 2021 at 12:01 AM David A. Harding via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> On Sat, Apr 24, 2021 at 01:05:25PM -0700, Jeremy wrote:
> > I meant the type itself is too wide, not the length of the value. As in
> > Script can represent things we know nothing about.
>
> I guess I still don't understand your concern, then.  If script can
> represent things we know nothing about, then script commitments such as
> P2SH, P2WSH, and P2TR also represent things we know nothing about.  All
> you know is what container format they used.  For P2PK, bare multisig,
> OP_RETURN, and other direct uses of scriptPubKey, that container format
> is "bare" (or whatever you want to call it).
>
> > Btw: According to... Oh wait... You?
> >
> https://bitcoin.stackexchange.com/questions/35878/is-there-a-maximum-size-of-a-scriptsig-scriptpubkey
> > the max size is 10k bytes.
>
> I'm not sure what I knew at the time I wrote that answer, but the 10,000
> byte limit is only applied when EvalScript is run, which only happens
> when the output is being spent.  I've appended to this email a
> demonstration of creating a 11,000 byte OP_RETURN on regtest (I tried
> 999,000 bytes but ran into problems with bash's maximum command line
> length limit).  I've updated the answer to hopefully make it more
> correct.
>
> > Is it possible/easy to, say, using bech32m make an inappropriate message
> in
> > the address? You'd have to write the message, then see what it decodes to
> > without checking, and then re encode? I guess this is worse than hex?
>
> If someone wants to abuse bech32m, I suspect they'll do it the same way
> people have abused base58check[1], by using the address format's
> alphabet directly.  E.g., you compose your message using only
> the characters qpzry9x8gf2tvdw0s3jn54khce6mua7l and then append
> the appropriate checksum.
>
> [1]
> https://en.bitcoin.it/wiki/P2SH%C2%B2#The_problem:_storing_data_in_hashes
>
> > But it seems this is a general thing... If you wanted an inappropriate
> > message you could therefore just use bech32m addressed outputs.
>
> Yes, and people have done that with base58check.  IsStandard OP_RETURN
> attempts to minimize that abuse by being cheaper in two ways:
>
> 1. More data allowed in scriptSig, e.g. 80 byte payload (81 actually, I
>    think) for OP_RETURN versus 40 bytes for a BIP141 payload.
>    Maximizing payload size better amortizes the overhead cost of the
>    containing transaction and the output's nValue field.
>
> 2. Exemption from the dust limit.  If you use a currently defined
>    address type, the nValue needs to pay at least a few thousand nBTC
>    (few hundred satoshis), about $0.15 USD minimum at $50k USD/BTC.  For
>    OP_RETURN, the nValue can be 0, so there's no additional cost beyond
>    normal transaction relay fees.
>
> Although someone creating an OP_RETURN up to ~1 MB with miner support
> can bypass the dust limit, the efficiency advantage remains no matter
> what.
>
> > One of the nice things is that the current psbt interface uses a blind
> > union type whereby the entires in an array are either [address, amount]
> or
> > ["data", hex]. Having an address type would allow more uniform handling,
> > which is convenient for strongly typed RPC bindings (e.g. rust bitcoin
> uses
> > a hashmap of address to amount so without a patch you can't create op
> > returns).
>
> I don't particularly care how the data in PSBTs are structured.  My mild
> opposition was to adding code to the wallet that exposes everyday users
> to OP_RETURN addresses.
>
> > I would much prefer to not have to do this in a custom way, as opposed
> > to a way which is defined in a standard manner across all software
> > (after all, that's the point of standards).
>
> I'm currently +0.1 on the idea of an address format of OP_RETURN, but I
> want to make sure this isn't underwhelmingly motivated or will lead to a
> resurgence of block chain graffiti.
>
> -Dave
>
> ## Creating an 11,000 byte OP_RETURN
>
> $ bitcoind -daemon -regtest -acceptnonstdtxn
> Bitcoin Core starting
>
> $ bitcoin-cli -regtest -generate 101
> {
>   "address": "bcrt1qh9uka5z040vx2rc3ltz3tpwmq4y2mt0eufux9r",
>   "blocks": [
> [...]
> }
>
> $ bitcoin-cli -regtest send '[{"data": "'$( dd if=/dev/zero bs=1000
> count=11 | xxd -g0 -p | tr -d '\n' )'"}]'
> 11+0 records in
> 11+0 records out
> 11000 bytes (11 kB, 11 KiB) copied, 0.000161428 s, 68.1 MB/s
> {
>   "txid":
> "ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51",
>   "complete": true
> }
>
> $ bitcoin-cli -regtest getrawmempool
> [
>   "ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51"
> ]
>
> $ bitcoin-cli -regtest -generate 1
> {
>   "address": "bcrt1qlzjd90tkfkr09m867zxhte9rqd3t03wc5py5zh",
>   "blocks": [
>     "2986e9588c5bd26a629020b1ce8014d1f4ac9ac19106d216d3abb3a314c5604b"
>   ]
> }
>
> $bitcoin-cli -regtest getblock
> 2986e9588c5bd26a629020b1ce8014d1f4ac9ac19106d216d3abb3a314c5604b 2 | jq
> .tx[1].txid
> "ef3d396c7d21914a2c308031c9ba1857694fc33df71f5a349b409ab3406dab51"
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210425/93b322ab/attachment-0001.html>

From jlrubin at mit.edu  Sun Apr 25 00:25:30 2021
From: jlrubin at mit.edu (Jeremy)
Date: Sat, 24 Apr 2021 17:25:30 -0700
Subject: [bitcoin-dev] [Pre-BIP] Motivating Address type for OP_RETURN
In-Reply-To: <CAJ4-pEDmHctqx7XEqGO5--au7YmLpOnUvf3qhxbatujFJtvjvA@mail.gmail.com>
References: <CAD5xwhj7jXSrdbfFJTYw-UzGgZTF0kz-Vr61juF0gJGLf2EKqQ@mail.gmail.com>
 <20210423181550.xri2ravlwfe3vpc6@ganymede>
 <CAD5xwhgnL_u1hS99HPTMBfQbRohgmajzNX4XiGYnN9mZDqjC7g@mail.gmail.com>
 <20210424215900.nufcy6uzjzompdbs@ganymede>
 <CAJ4-pEDmHctqx7XEqGO5--au7YmLpOnUvf3qhxbatujFJtvjvA@mail.gmail.com>
Message-ID: <CAD5xwhh6C95P_f1CK_kWa09fjCqC_eKLKSCOez1iBOKUOWAaow@mail.gmail.com>

Zac -- this is kind of offtopic for this thread, which is primarily to do
with making software/standards that supports existing practices in the
bitcoin community rather than new standards/formats for a similar task.

I think there have been some other related posts recently where it might be
more topical?

Sorry for any confusion,

Jeremy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210424/77d250f1/attachment.html>

From luke at dashjr.org  Sun Apr 25 18:29:21 2021
From: luke at dashjr.org (Luke Dashjr)
Date: Sun, 25 Apr 2021 18:29:21 +0000
Subject: [bitcoin-dev] BIPs - notarization protocol and decentralized
	storage
In-Reply-To: <MYmfT1n--3-2@tutanota.de>
References: <MYmfT1n--3-2@tutanota.de>
Message-ID: <202104251829.22548.luke@dashjr.org>

On Wednesday 21 April 2021 04:26:26 Prayank via bitcoin-dev wrote:
> Also since this involves LN, maybe it can just be a LN project instead of
> BIP? Not the best person to comment on what can be a BIP.

Anything that Bitcoin software would benefit in collaboration with other 
projects on qualifies.

Lightning itself really should be a series of BIPs.

Luke

From lf-lists at mattcorallo.com  Sun Apr 25 20:29:44 2021
From: lf-lists at mattcorallo.com (Matt Corallo)
Date: Sun, 25 Apr 2021 16:29:44 -0400
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <CALZpt+Hz3jFnA8z1w6yictdHWnnKReMK+6eEHg_jUZ7==xNZzQ@mail.gmail.com>
References: <202104230209.05373.luke@dashjr.org>
 <CALZpt+Hz3jFnA8z1w6yictdHWnnKReMK+6eEHg_jUZ7==xNZzQ@mail.gmail.com>
Message-ID: <64807e52-14ea-198b-4caf-29be92e89655@mattcorallo.com>

There appears to be some severe lack of understanding of the point of the BIP process here.

The BIP process exists to be a place for those in the Bitcoin development community (which includes anyone who wishes to 
participate in it!) to place specifications which may be important for others in the Bitcoin development community to 
see, to ensure interoperability.

It does not, should not, and has never existed to take any positions on...anything. It has always existed to allow those 
who wish to participate in the Bitcoin development community to publish proposed standards or deployed protocols, in 
whatever form the authors of the BIPs seem fit.

If anyone suggests changes with a BIP's proposed form in a way the original author does not agree with, they have always 
been free to, and should simply create a new BIP with their proposed form.

The BIP editor's role has always been, and should continue to be, to encourage BIP authors to respond to (either by 
dismissing or accepting) feedback on their BIPs, and encourage formatting in a standard form. The BIP editor's role has 
never included, and should not include, taking a stance on substantive changes to a BIP's contents - those are up to the 
author(s) of a BIP, and always have been.

If the BIP editor is deliberately refusing to accept changes which the author's approval (which appears to be occurring 
here), the broader development community (us) should either remove the BIP editor and replace them, or simply ignore the 
BIP repository entirely (which seems like the most likely outcome here). There really should be no debate over this 
point, and I'm not entirely sure why anyone would think there should be.

Luckily BIPs aren't really all that critical in this instance - they exist to communicate protocols for 
interoperability, and in this case the protocol changes as proposed have been broadly communicated already.

Still, given the apparent lack of desire to remove the BIP editor in this case, I'd suggest we all move on and simply 
ignore the BIP repository entirely. Simply sending notices of protocol systems to this mailing list is likely sufficient.

Matt

On 4/23/21 11:34, Antoine Riard via bitcoin-dev wrote:
> Hi Luke,
> 
> For the records and the subscribers of this list not following #bitcoin-core-dev, this mail follows a discussion which 
> did happen during yesterday irc meetings.
> Logs here : http://gnusha.org/bitcoin-core-dev/2021-04-22.log <http://gnusha.org/bitcoin-core-dev/2021-04-22.log>
> 
> I'll reiterate my opinion expressed during the meeting. If this proposal to extend the bip editorship membership doesn't 
> satisfy parties involved or anyone in the community, I'm strongly opposed to have the matter sliced by admins of the 
> Bitcoin github org. I believe that defect or uncertainty in the BIP Process shouldn't be solved by GH janitorial roles 
> and I think their roles don't bestow to intervene in case of loopholes. Further, you have far more contributors involved 
> in the BIP Process rather than only Bitcoin Core ones. FWIW, such precedent merits would be quite similar to lobby 
> directly GH staff...
> 
> Unless we harm Bitcoin users by not acting, I think we should always be respectful of procedural forms. And in the lack 
> of such forms, stay patient until a solution satisfy everyone.
> 
> I would recommend the BIP editorship, once extended or not, to move in its own repository in the future.
> 
> Cheers,
> Antoine
> 
> 
> 
> 
> Le?jeu. 22 avr. 2021 ??22:09, Luke Dashjr via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org 
> <mailto:bitcoin-dev at lists.linuxfoundation.org>> a ?crit?:
> 
>     Unless there are objections, I intend to add Kalle Alm as a BIP editor to
>     assist in merging PRs into the bips git repo.
> 
>     Since there is no explicit process to adding BIP editors, IMO it should be
>     fine to use BIP 2's Process BIP progression:
> 
>      > A process BIP may change status from Draft to Active when it achieves
>      > rough consensus on the mailing list. Such a proposal is said to have
>      > rough consensus if it has been open to discussion on the development
>      > mailing list for at least one month, and no person maintains any
>      > unaddressed substantiated objections to it.
> 
>     A Process BIP could be opened for each new editor, but IMO that is
>     unnecessary. If anyone feels there is a need for a new Process BIP, we can go
>     that route, but there is prior precedent for BIP editors appointing new BIP
>     editors, so I think this should be fine.
> 
>     Please speak up soon if you disagree.
> 
>     Luke
>     _______________________________________________
>     bitcoin-dev mailing list
>     bitcoin-dev at lists.linuxfoundation.org <mailto:bitcoin-dev at lists.linuxfoundation.org>
>     https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>     <https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev>
> 
> 
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> 

From luke at dashjr.org  Sun Apr 25 21:00:06 2021
From: luke at dashjr.org (Luke Dashjr)
Date: Sun, 25 Apr 2021 21:00:06 +0000
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <64807e52-14ea-198b-4caf-29be92e89655@mattcorallo.com>
References: <202104230209.05373.luke@dashjr.org>
 <CALZpt+Hz3jFnA8z1w6yictdHWnnKReMK+6eEHg_jUZ7==xNZzQ@mail.gmail.com>
 <64807e52-14ea-198b-4caf-29be92e89655@mattcorallo.com>
Message-ID: <202104252100.07296.luke@dashjr.org>

On Sunday 25 April 2021 20:29:44 Matt Corallo wrote:
> If the BIP editor is deliberately refusing to accept changes which the
> author's approval (which appears to be occurring here),

It isn't. I am triaging BIPs PRs the same as I have for years, and will get to 
them all in due time, likely before the end of the month.

Rather, what we have going on is a few bad actors trying to misportray the 
BIPs as an approval process so they can pretend ST is somehow official, or 
that the preexisting Core+Taproot client is "breaking" the spec. And to 
further their agenda, they have been harassing me demanding special 
treatment.

I will not become an accomplice to this deception by giving special treatment, 
and will process the BIP PR neutrally according to the currently-defined BIP 
process.

Despite the continual harassment, I have even made two efforts to try to 
(fairly) make things faster, and have been obstructed both times by ST 
advocates. It appears they intend to paint me as "deliberately refusing" (to 
use your words) in order to try to put Bitcoin and the BIP process under 
their control, and abuse it in the same manner in which they abused Bitcoin 
Core's usual standards (by releasing ST without community consensus).

Luke

From lf-lists at mattcorallo.com  Sun Apr 25 21:14:08 2021
From: lf-lists at mattcorallo.com (Matt Corallo)
Date: Sun, 25 Apr 2021 17:14:08 -0400
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <202104252100.07296.luke@dashjr.org>
References: <202104230209.05373.luke@dashjr.org>
 <CALZpt+Hz3jFnA8z1w6yictdHWnnKReMK+6eEHg_jUZ7==xNZzQ@mail.gmail.com>
 <64807e52-14ea-198b-4caf-29be92e89655@mattcorallo.com>
 <202104252100.07296.luke@dashjr.org>
Message-ID: <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>

On 4/25/21 17:00, Luke Dashjr wrote:
> On Sunday 25 April 2021 20:29:44 Matt Corallo wrote:
>> If the BIP editor is deliberately refusing to accept changes which the
>> author's approval (which appears to be occurring here),
> 
> It isn't. I am triaging BIPs PRs the same as I have for years, and will get to
> them all in due time, likely before the end of the month.

Please don't play dumb, it isn't a good look.

> Rather, what we have going on is a few bad actors trying to misportray the
> BIPs as an approval process so they can pretend ST is somehow official, or
> that the preexisting Core+Taproot client is "breaking" the spec. And to
> further their agenda, they have been harassing me demanding special
> treatment.

I'd be curious who is doing that, because obviously I'd agree that merging something in a BIP doesn't really have any 
special meaning. This, however, is a completely different topic from following the BIP process that you had a key hand 
in crafting.

> I will not become an accomplice to this deception by giving special treatment,
> and will process the BIP PR neutrally according to the currently-defined BIP
> process.

Again, please don't play dumb, no one watching believes this - you've been active on the BIP repo on numerous PRs and 
this has never in the past been the case.

> Despite the continual harassment, I have even made two efforts to try to
> (fairly) make things faster, and have been obstructed both times by ST
> advocates. It appears they intend to paint me as "deliberately refusing" (to
> use your words) in order to try to put Bitcoin and the BIP process under
> their control, and abuse it in the same manner in which they abused Bitcoin
> Core's usual standards (by releasing ST without community consensus).
> 
> Luke
> 

From luke at dashjr.org  Sun Apr 25 21:22:40 2021
From: luke at dashjr.org (Luke Dashjr)
Date: Sun, 25 Apr 2021 21:22:40 +0000
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
References: <202104230209.05373.luke@dashjr.org>
 <202104252100.07296.luke@dashjr.org>
 <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
Message-ID: <202104252122.40909.luke@dashjr.org>

On Sunday 25 April 2021 21:14:08 Matt Corallo wrote:
> On 4/25/21 17:00, Luke Dashjr wrote:
> > I will not become an accomplice to this deception by giving special
> > treatment, and will process the BIP PR neutrally according to the
> > currently-defined BIP process.
>
> Again, please don't play dumb, no one watching believes this - you've been
> active on the BIP repo on numerous PRs and this has never in the past been
> the case.

I started going through PRs a few days ago, in order of "Recently updated" on 
GitHub, starting with the least-recent following the last one I triaged a 
month ago that hasn't seen activity.. the same as I have been doing month 
after month prior to this.

If you don't believe me, feel free to look through the repo history.

Luke

From lf-lists at mattcorallo.com  Sun Apr 25 21:31:50 2021
From: lf-lists at mattcorallo.com (Matt Corallo)
Date: Sun, 25 Apr 2021 17:31:50 -0400
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <202104252122.40909.luke@dashjr.org>
References: <202104230209.05373.luke@dashjr.org>
 <202104252100.07296.luke@dashjr.org>
 <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
 <202104252122.40909.luke@dashjr.org>
Message-ID: <248f871e-1b83-8c7c-678b-3ed0585a6357@mattcorallo.com>

Alright, let's see...

Sorting by most recently updated...
https://github.com/bitcoin/bips/pulls?page=1&q=is%3Apr+is%3Aopen+sort%3Aupdated-asc+updated%3A%3E2021-01-01

#1104 has been updated nearly daily for the past many weeks. You commented 12 days ago saying "Concept NACK" (which 
isn't a thing on BIPs - huh? they're author documents, as you're well aware), and nothing further.

#1105 which is less recently updated by one on the above list has a comment from you 19 hours ago.

I'm really not sure what playing dumb gets you, here. Its really transparent and isn't helpful in any way to anything.

In general, I think its time we all agree the BIP process has simply failed and move on. Luckily its not really all that 
critical and proposed protocol documents can be placed nearly anywhere with the same effect.

Matt

On 4/25/21 17:22, Luke Dashjr wrote:
> On Sunday 25 April 2021 21:14:08 Matt Corallo wrote:
>> On 4/25/21 17:00, Luke Dashjr wrote:
>>> I will not become an accomplice to this deception by giving special
>>> treatment, and will process the BIP PR neutrally according to the
>>> currently-defined BIP process.
>>
>> Again, please don't play dumb, no one watching believes this - you've been
>> active on the BIP repo on numerous PRs and this has never in the past been
>> the case.
> 
> I started going through PRs a few days ago, in order of "Recently updated" on
> GitHub, starting with the least-recent following the last one I triaged a
> month ago that hasn't seen activity.. the same as I have been doing month
> after month prior to this.
> 
> If you don't believe me, feel free to look through the repo history.
> 
> Luke
> 

From dave at dtrt.org  Mon Apr 26 00:36:40 2021
From: dave at dtrt.org (David A. Harding)
Date: Sun, 25 Apr 2021 14:36:40 -1000
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>
References: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>
Message-ID: <20210426003640.2sjx4f35l3vdtxwe@ganymede>

On Sat, Apr 24, 2021 at 04:42:12AM +0000, Greg Maxwell via bitcoin-dev wrote:
> I am opposed to the addition of Kalle Alm at this time.  Those who
> believe [this] will resolve the situation [...] re: PR1104 are
> mistaken.

PR1104 has been merged.  Do you continue to oppose the addition?

Thanks,

-Dave
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210425/80fd21d6/attachment.sig>

From sjors at sprovoost.nl  Mon Apr 26 15:02:06 2021
From: sjors at sprovoost.nl (Sjors Provoost)
Date: Mon, 26 Apr 2021 17:02:06 +0200
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <202104230209.05373.luke@dashjr.org>
References: <202104230209.05373.luke@dashjr.org>
Message-ID: <54852E33-080B-4C44-AD75-F0902B420280@sprovoost.nl>

ACK for adding Kalle.

Recent drama aside, having a single editor is not ideal. There's currently 110 open pull requests to the BIPs repo.

- Sjors

> Op 23 apr. 2021, om 04:09 heeft Luke Dashjr via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> het volgende geschreven:
> 
> Unless there are objections, I intend to add Kalle Alm as a BIP editor to
> assist in merging PRs into the bips git repo.
> 
> Since there is no explicit process to adding BIP editors, IMO it should be
> fine to use BIP 2's Process BIP progression:
> 
>> A process BIP may change status from Draft to Active when it achieves
>> rough consensus on the mailing list. Such a proposal is said to have
>> rough consensus if it has been open to discussion on the development
>> mailing list for at least one month, and no person maintains any
>> unaddressed substantiated objections to it.
> 
> A Process BIP could be opened for each new editor, but IMO that is
> unnecessary. If anyone feels there is a need for a new Process BIP, we can go
> that route, but there is prior precedent for BIP editors appointing new BIP
> editors, so I think this should be fine.
> 
> Please speak up soon if you disagree.
> 
> Luke
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: Message signed with OpenPGP
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210426/a63b4dcb/attachment.sig>

From laanwj at protonmail.com  Mon Apr 26 18:13:43 2021
From: laanwj at protonmail.com (W. J. van der Laan)
Date: Mon, 26 Apr 2021 18:13:43 +0000
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <202104230209.05373.luke@dashjr.org>
References: <202104230209.05373.luke@dashjr.org>
Message-ID: <1WIiTmVcZnaQqfyOqJmepetY5lZmcFtZmH9rpY647HWyixcTXbLps0Qy7W8pdCGSRBzgtpF_DHFj4NfuVGrdJ0rQkYpqvyyVCopekAmt76w=@protonmail.com>


On Friday, April 23rd, 2021 at 4:09 AM, Luke Dashjr via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:

> Unless there are objections, I intend to add Kalle Alm as a BIP editor to
> assist in merging PRs into the bips git repo.

ACK on adding Kalle.

I'm happy to finally see someone else interested in BIP maintainer role, for years no one really seemed to care about doing this mostly procedural/bureaucratic function, which is (part of) the reason Luke-Jr ended up as the only BIP maintainer for such a long time.

And I disagree that a bot could do this just as well. Auto-merging would open it up to all kinds of DoS attacks, vandalism, and low-effort scams that a person can easily ward against.

-W

From james.obeirne at gmail.com  Mon Apr 26 16:56:19 2021
From: james.obeirne at gmail.com (James O'Beirne)
Date: Mon, 26 Apr 2021 09:56:19 -0700
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <54852E33-080B-4C44-AD75-F0902B420280@sprovoost.nl>
References: <202104230209.05373.luke@dashjr.org>
 <54852E33-080B-4C44-AD75-F0902B420280@sprovoost.nl>
Message-ID: <CAPfvXfK=CPg6D_k+=CoLdf9v8KOuqV0CZyD6J0XgnSiDsAM_WQ@mail.gmail.com>

ACK for Kalle.

On Mon, Apr 26, 2021, 09:55 Sjors Provoost via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> ACK for adding Kalle.
>
> Recent drama aside, having a single editor is not ideal. There's currently
> 110 open pull requests to the BIPs repo.
>
> - Sjors
>
> > Op 23 apr. 2021, om 04:09 heeft Luke Dashjr via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> het volgende geschreven:
> >
> > Unless there are objections, I intend to add Kalle Alm as a BIP editor to
> > assist in merging PRs into the bips git repo.
> >
> > Since there is no explicit process to adding BIP editors, IMO it should
> be
> > fine to use BIP 2's Process BIP progression:
> >
> >> A process BIP may change status from Draft to Active when it achieves
> >> rough consensus on the mailing list. Such a proposal is said to have
> >> rough consensus if it has been open to discussion on the development
> >> mailing list for at least one month, and no person maintains any
> >> unaddressed substantiated objections to it.
> >
> > A Process BIP could be opened for each new editor, but IMO that is
> > unnecessary. If anyone feels there is a need for a new Process BIP, we
> can go
> > that route, but there is prior precedent for BIP editors appointing new
> BIP
> > editors, so I think this should be fine.
> >
> > Please speak up soon if you disagree.
> >
> > Luke
> > _______________________________________________
> > bitcoin-dev mailing list
> > bitcoin-dev at lists.linuxfoundation.org
> > https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210426/34c723c3/attachment.html>

From dave at dtrt.org  Mon Apr 26 19:43:09 2021
From: dave at dtrt.org (David A. Harding)
Date: Mon, 26 Apr 2021 09:43:09 -1000
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <248f871e-1b83-8c7c-678b-3ed0585a6357@mattcorallo.com>
References: <202104230209.05373.luke@dashjr.org>
 <202104252100.07296.luke@dashjr.org>
 <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
 <202104252122.40909.luke@dashjr.org>
 <248f871e-1b83-8c7c-678b-3ed0585a6357@mattcorallo.com>
Message-ID: <20210426194309.2k5exujz23vjrgwc@ganymede>

On Sun, Apr 25, 2021 at 05:31:50PM -0400, Matt Corallo via bitcoin-dev wrote:
> In general, I think its time we all agree the BIP process has simply failed
> and move on. Luckily its not really all that critical and proposed protocol
> documents can be placed nearly anywhere with the same effect.

I recommend:

1. We add additional BIP editors, starting with Kalle Alm (if there are
   no continuing significant objections).

2. We seek Luke Dashjr's resignation as BIPs editor.

3. We begin treating protocol documents outside the BIPs repository as
   first-class BIP documentation.

The first recommendation permits continued maintenance of existing BIPs
plus gives the additional maintainers an opportunity to rebuild the
credibility of the repository.

The second recommendation addresses the dissatisfaction of many BIP
authors and potential authors with the current editor, which I think
will discourage many of them from making additional significant
contributions to the repository.  It also seems to me to be a better use
of Luke's talents and interests for him to focus on protocol research
and review rather than procedurally checking whether a bunch of
documents are well formed.

The third recommendation provides an escape hatch for anyone, such as
Matt, who currently thinks the process has failed, or for anyone who
comes to that same conclusion in the future under a different editing
team.  My specific recommendations there are:

a. Anyone writing protocol documentation in the spirit of the BIP
   process can post their idea to this mailing list like we've always
   done and, when they've finished collecting initial feedback, they can
   assign themselves a unique decentralized identifier starting with
   "bip-".  They may also define a shorter alias that they encourage
   people to use in cases where the correct document can be inferred
   from context.  E.g.,

      bip-wuille-taproot (bip-taproot)
      bip-towns-versionbits-min-activation-height (bip-vbmah)
      bip-todd-harding-opt-in-replace-by-fee (bip-opt-in-rbf)

b. The author then publishes the document to any place they'd like, although
   they are strongly encouraged to make any document source available
   under an open license to ensure others can create their own
   modifications.

c. Implementations of BIPs, whether original repository BIPs or
   decentralized BIPs, link to the BIPs they implement to ensure
   researchers and developers can find the relevant protocol
   documentation.  E.g.,
   https://github.com/bitcoin/bitcoin/blob/fe5e495c31de47b0ec732b943db11fe345d874af/doc/bips.md

     (It may also be advisable for implementations to mirror copies of
     the BIPs they implement so later modifications to the document
     don't confuse anyone.  For this reason, extremely liberal
     licensing of BIP documents is encouraged.)

d. To help maintain quality and consistency between documentation, the
   BIP editors provide a BIP document template, guidelines similar to
   the existing BIP2, and an easy-to-run format linter.

I think this decentralized BIPs alternative also helps address some
longstanding problems with the BIPs system: that many casual Bitcoin
users and developers think of documents in the BIPs repo as
authoritative and that there are some development teams (such as for LN)
that have already abandoned the BIPs process because, in part, they want
complete control over their own documentation.  

The recommendations above were developed based on conversations I had
with a few stakeholders in the BIPs process, but I did not attempt a
comprehensive survey and I certainly don't claim to speak for anyone
else.  I hope the recommendations are satisfactory and I look forward to
your feedback.

Thanks,

-Dave
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210426/2c57cc4a/attachment-0001.sig>

From gmaxwell at gmail.com  Mon Apr 26 20:04:39 2021
From: gmaxwell at gmail.com (Greg Maxwell)
Date: Mon, 26 Apr 2021 20:04:39 +0000
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <20210426194309.2k5exujz23vjrgwc@ganymede>
References: <202104230209.05373.luke@dashjr.org>
 <202104252100.07296.luke@dashjr.org>
 <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
 <202104252122.40909.luke@dashjr.org>
 <248f871e-1b83-8c7c-678b-3ed0585a6357@mattcorallo.com>
 <20210426194309.2k5exujz23vjrgwc@ganymede>
Message-ID: <CAAS2fgRZwf=SBB4EvpeTBLshRfT1tmnv33GP+Ln+w2bxt48=pA@mail.gmail.com>

I endorse Harding's recommendations.  On the point about mirroring,
one thing to keep in mind is that the other repositories may go
offline.

Modification confusion could be avoided by recording what revision
(commit hash) was current at the time of inclusion, but the document
going offline can only be protected against by maintaining a copy
somewhere.


On Mon, Apr 26, 2021 at 7:44 PM David A. Harding via bitcoin-dev
<bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> On Sun, Apr 25, 2021 at 05:31:50PM -0400, Matt Corallo via bitcoin-dev wrote:
> > In general, I think its time we all agree the BIP process has simply failed
> > and move on. Luckily its not really all that critical and proposed protocol
> > documents can be placed nearly anywhere with the same effect.
>
> I recommend:
>
> 1. We add additional BIP editors, starting with Kalle Alm (if there are
>    no continuing significant objections).
>
> 2. We seek Luke Dashjr's resignation as BIPs editor.
>
> 3. We begin treating protocol documents outside the BIPs repository as
>    first-class BIP documentation.
>
> The first recommendation permits continued maintenance of existing BIPs
> plus gives the additional maintainers an opportunity to rebuild the
> credibility of the repository.
>
> The second recommendation addresses the dissatisfaction of many BIP
> authors and potential authors with the current editor, which I think
> will discourage many of them from making additional significant
> contributions to the repository.  It also seems to me to be a better use
> of Luke's talents and interests for him to focus on protocol research
> and review rather than procedurally checking whether a bunch of
> documents are well formed.
>
> The third recommendation provides an escape hatch for anyone, such as
> Matt, who currently thinks the process has failed, or for anyone who
> comes to that same conclusion in the future under a different editing
> team.  My specific recommendations there are:
>
> a. Anyone writing protocol documentation in the spirit of the BIP
>    process can post their idea to this mailing list like we've always
>    done and, when they've finished collecting initial feedback, they can
>    assign themselves a unique decentralized identifier starting with
>    "bip-".  They may also define a shorter alias that they encourage
>    people to use in cases where the correct document can be inferred
>    from context.  E.g.,
>
>       bip-wuille-taproot (bip-taproot)
>       bip-towns-versionbits-min-activation-height (bip-vbmah)
>       bip-todd-harding-opt-in-replace-by-fee (bip-opt-in-rbf)
>
> b. The author then publishes the document to any place they'd like, although
>    they are strongly encouraged to make any document source available
>    under an open license to ensure others can create their own
>    modifications.
>
> c. Implementations of BIPs, whether original repository BIPs or
>    decentralized BIPs, link to the BIPs they implement to ensure
>    researchers and developers can find the relevant protocol
>    documentation.  E.g.,
>    https://github.com/bitcoin/bitcoin/blob/fe5e495c31de47b0ec732b943db11fe345d874af/doc/bips.md
>
>      (It may also be advisable for implementations to mirror copies of
>      the BIPs they implement so later modifications to the document
>      don't confuse anyone.  For this reason, extremely liberal
>      licensing of BIP documents is encouraged.)
>
> d. To help maintain quality and consistency between documentation, the
>    BIP editors provide a BIP document template, guidelines similar to
>    the existing BIP2, and an easy-to-run format linter.
>
> I think this decentralized BIPs alternative also helps address some
> longstanding problems with the BIPs system: that many casual Bitcoin
> users and developers think of documents in the BIPs repo as
> authoritative and that there are some development teams (such as for LN)
> that have already abandoned the BIPs process because, in part, they want
> complete control over their own documentation.
>
> The recommendations above were developed based on conversations I had
> with a few stakeholders in the BIPs process, but I did not attempt a
> comprehensive survey and I certainly don't claim to speak for anyone
> else.  I hope the recommendations are satisfactory and I look forward to
> your feedback.
>
> Thanks,
>
> -Dave
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

From gloriajzhao at gmail.com  Mon Apr 26 23:06:34 2021
From: gloriajzhao at gmail.com (Gloria Zhao)
Date: Mon, 26 Apr 2021 16:06:34 -0700
Subject: [bitcoin-dev] L2s Onchain Support IRC Workshop
In-Reply-To: <CALZpt+E_e=0rjq5_XazV_qH2h=uQrpTLbMRe2K7jVterSAr05w@mail.gmail.com>
References: <CALZpt+E_e=0rjq5_XazV_qH2h=uQrpTLbMRe2K7jVterSAr05w@mail.gmail.com>
Message-ID: <CAFXO6=J-3kF4nOqrHLRzN2t+=iCrCDTJh9nD3tY45ihZOAZ8ug@mail.gmail.com>

Hi Antoine,

Thanks for initiating this! I'm interested in joining. Since I mostly live
in L1, my primary goal is to understand what simplest version of package
relay would be sufficient to support transaction relay assumptions made by
L2 applications. For example, if a parent + child package covers the vast
majority of cases and a package limit of 2 is considered acceptable, that
could simplify things quite a bit.

A small note - I believe package relay and sponsorship (or other
fee-bumping primitive) should be separate discussions.

Re: L2-zoology... In general, for the purpose of creating a stable API /
set of assumptions between layers, I'd like to be as concrete as possible.
Speaking for myself, if I'm TDDing for a specific L2 attack, I need test
vectors. A simple description of mempool contents + p2p messages sent is
fine, but pubkeys + transaction hex would be appreciated because we don't
(and probably shouldn't, for the purpose of maintainability) have a lot of
tooling to build L2 transactions in Bitcoin Core. In the other direction,
it's hard to make any guarantees given the complexity of mempool policy,
but perhaps it could be helpful to expose a configurable RPC (e.g. #21413
<https://github.com/bitcoin/bitcoin/pull/21413>) to test a range of
scenarios?

Anyway, looking forward to discussions :)

Best,
Gloria

On Fri, Apr 23, 2021 at 8:51 AM Antoine Riard via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> Hi,
>
> During the lastest years, tx-relay and mempool acceptances rules of the
> base layer have been sources of major security and operational concerns for
> Lightning and other Bitcoin second-layers [0]. I think those areas require
> significant improvements to ease design and deployment of higher Bitcoin
> layers and I believe this opinion is shared among the L2 dev community. In
> order to make advancements, it has been discussed a few times in the last
> months to organize in-person workshops to discuss those issues with the
> presence of both L1/L2 devs to make exchange fruitful.
>
> Unfortunately, I don't think we'll be able to organize such in-person
> workshops this year (because you know travel is hard those days...) As a
> substitution, I'm proposing a series of one or more irc meetings. That
> said, this substitution has the happy benefit to gather far more folks
> interested by those issues that you can fit in a room.
>
> # Scope
>
> I would like to propose the following 4 items as topics of discussion.
>
> 1) Package relay design or another generic L2 fee-bumping primitive like
> sponsorship [0]. IMHO, this primitive should at least solve mempools spikes
> making obsolete propagation of transactions with pre-signed feerate, solve
> pinning attacks compromising Lightning/multi-party contract protocol
> safety, offer an usable and stable API to L2 software stack, stay
> compatible with miner and full-node operators incentives and obviously
> minimize CPU/memory DoS vectors.
>
> 2) Deprecation of opt-in RBF toward full-rbf. Opt-in RBF makes it trivial
> for an attacker to partition network mempools in divergent subsets and from
> then launch advanced security or privacy attacks against a Lightning node.
> Note, it might also be a concern for bandwidth bleeding attacks against L1
> nodes.
>
> 3) Guidelines about coordinated cross-layers security disclosures.
> Mitigating a security issue around tx-relay or the mempool in Core might
> have harmful implications for downstream projects. Ideally, L2 projects
> maintainers should be ready to upgrade their protocols in emergency in
> coordination with base layers developers.
>
> 4) Guidelines about L2 protocols onchain security design. Currently
> deployed like Lightning are making a bunch of assumptions on tx-relay and
> mempool acceptances rules. Those rules are non-normative, non-reliable and
> lack documentation. Further, they're devoid of tooling to enforce them at
> runtime [2]. IMHO, it could be preferable to identify a subset of them on
> which second-layers protocols can do assumptions without encroaching too
> much on nodes's policy realm or making the base layer development in those
> areas too cumbersome.
>
> I'm aware that some folks are interested in other topics such as extension
> of Core's mempools package limits or better pricing of RBF replacement. So
> l propose a 2-week concertation period to submit other topics related to
> tx-relay or mempools improvements towards L2s before to propose a finalized
> scope and agenda.
>
> # Goals
>
> 1) Reaching technical consensus.
> 2) Reaching technical consensus, before seeking community consensus as it
> likely has ecosystem-wide implications.
> 3) Establishing a security incident response policy which can be applied
> by dev teams in the future.
> 4) Establishing a philosophy design and associated documentations (BIPs,
> best practices, ...)
>
> # Timeline
>
> 2021-04-23: Start of concertation period
> 2021-05-07: End of concertation period
> 2021-05-10: Proposition of workshop agenda and schedule
> late 2021-05/2021-06: IRC meetings
>
> As the problem space is savagely wide, I've started a collection of
> documents to assist this workshop : https://github.com/ariard/L2-zoology
> Still wip, but I'll have them in a good shape at agenda publication, with
> reading suggestions and open questions to structure discussions.
> Also working on transaction pinning and mempool partitions attacks
> simulations.
>
> If L2s security/p2p/mempool is your jam, feel free to get involved :)
>
> Cheers,
> Antoine
>
> [0] For e.g see optech section on transaction pinning attacks :
> https://bitcoinops.org/en/topics/transaction-pinning/
> [1]
> https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-September/018168.html
> [2] Lack of reference tooling make it easier to have bug slip in like
> https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210426/9f3369ef/attachment.html>

From laanwj at protonmail.com  Tue Apr 27 09:04:18 2021
From: laanwj at protonmail.com (W. J. van der Laan)
Date: Tue, 27 Apr 2021 09:04:18 +0000
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <20210426194309.2k5exujz23vjrgwc@ganymede>
References: <202104230209.05373.luke@dashjr.org>
 <202104252100.07296.luke@dashjr.org>
 <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
 <202104252122.40909.luke@dashjr.org>
 <248f871e-1b83-8c7c-678b-3ed0585a6357@mattcorallo.com>
 <20210426194309.2k5exujz23vjrgwc@ganymede>
Message-ID: <773C1Ki5dlSNlxD3HK0eJDKHQ9Ikb5vwuKPZ3dkgEPqUmPGN6DrpLv47LNITHOlu7XWzmIpAmgw24noihYJ5lI5Qhmg7yIlboGQsfAowFCw=@protonmail.com>

On Monday, April 26th, 2021 at 9:43 PM, David A. Harding via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:

> On Sun, Apr 25, 2021 at 05:31:50PM -0400, Matt Corallo via bitcoin-dev wrote:
>
> > In general, I think its time we all agree the BIP process has simply failed
> >
> > and move on. Luckily its not really all that critical and proposed protocol
> >
> > documents can be placed nearly anywhere with the same effect.
>

I like the idea of decentralizing the BIPs process. It is a historical artifact that the bips repository is part of the same organization that bitcoin core is part of. But there shouldn't be the perception that standardization is driven by that, or that there is any kind of (non-trivial) gatekeeping.

I understand where this perception is coming from, though. There being 111 PRs open at https://github.com/bitcoin/bips/pulls indicates that there is some kind of bottleneck. I hope adding more BIP editors can mitigate this somewhat.

Though it also happens that the BIP author simply don't care about changes anymore and doesn't respond, in which case the PR lingers without any fault from the BIPs maintainer. So something is to be said of having the BIP repository mirror/aggregate author's own work trees, and changes needing to be proposed there instead of "upstream".

-W

From john at johnnewbery.com  Tue Apr 27 11:33:48 2021
From: john at johnnewbery.com (John Newbery)
Date: Tue, 27 Apr 2021 12:33:48 +0100
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <20210426194309.2k5exujz23vjrgwc@ganymede>
References: <202104230209.05373.luke@dashjr.org>
 <202104252100.07296.luke@dashjr.org>
 <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
 <202104252122.40909.luke@dashjr.org>
 <248f871e-1b83-8c7c-678b-3ed0585a6357@mattcorallo.com>
 <20210426194309.2k5exujz23vjrgwc@ganymede>
Message-ID: <CAFmfg2uDiEAFHom8Bh4mjr_in3dpk++j+yfgHY3+gStU1Bii5A@mail.gmail.com>

ACK. These seem like very reasonable next steps.

On Mon, Apr 26, 2021 at 8:43 PM David A. Harding via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> On Sun, Apr 25, 2021 at 05:31:50PM -0400, Matt Corallo via bitcoin-dev
> wrote:
> > In general, I think its time we all agree the BIP process has simply
> failed
> > and move on. Luckily its not really all that critical and proposed
> protocol
> > documents can be placed nearly anywhere with the same effect.
>
> I recommend:
>
> 1. We add additional BIP editors, starting with Kalle Alm (if there are
>    no continuing significant objections).
>
> 2. We seek Luke Dashjr's resignation as BIPs editor.
>
> 3. We begin treating protocol documents outside the BIPs repository as
>    first-class BIP documentation.
>
> The first recommendation permits continued maintenance of existing BIPs
> plus gives the additional maintainers an opportunity to rebuild the
> credibility of the repository.
>
> The second recommendation addresses the dissatisfaction of many BIP
> authors and potential authors with the current editor, which I think
> will discourage many of them from making additional significant
> contributions to the repository.  It also seems to me to be a better use
> of Luke's talents and interests for him to focus on protocol research
> and review rather than procedurally checking whether a bunch of
> documents are well formed.
>
> The third recommendation provides an escape hatch for anyone, such as
> Matt, who currently thinks the process has failed, or for anyone who
> comes to that same conclusion in the future under a different editing
> team.  My specific recommendations there are:
>
> a. Anyone writing protocol documentation in the spirit of the BIP
>    process can post their idea to this mailing list like we've always
>    done and, when they've finished collecting initial feedback, they can
>    assign themselves a unique decentralized identifier starting with
>    "bip-".  They may also define a shorter alias that they encourage
>    people to use in cases where the correct document can be inferred
>    from context.  E.g.,
>
>       bip-wuille-taproot (bip-taproot)
>       bip-towns-versionbits-min-activation-height (bip-vbmah)
>       bip-todd-harding-opt-in-replace-by-fee (bip-opt-in-rbf)
>
> b. The author then publishes the document to any place they'd like,
> although
>    they are strongly encouraged to make any document source available
>    under an open license to ensure others can create their own
>    modifications.
>
> c. Implementations of BIPs, whether original repository BIPs or
>    decentralized BIPs, link to the BIPs they implement to ensure
>    researchers and developers can find the relevant protocol
>    documentation.  E.g.,
>
> https://github.com/bitcoin/bitcoin/blob/fe5e495c31de47b0ec732b943db11fe345d874af/doc/bips.md
>
>      (It may also be advisable for implementations to mirror copies of
>      the BIPs they implement so later modifications to the document
>      don't confuse anyone.  For this reason, extremely liberal
>      licensing of BIP documents is encouraged.)
>
> d. To help maintain quality and consistency between documentation, the
>    BIP editors provide a BIP document template, guidelines similar to
>    the existing BIP2, and an easy-to-run format linter.
>
> I think this decentralized BIPs alternative also helps address some
> longstanding problems with the BIPs system: that many casual Bitcoin
> users and developers think of documents in the BIPs repo as
> authoritative and that there are some development teams (such as for LN)
> that have already abandoned the BIPs process because, in part, they want
> complete control over their own documentation.
>
> The recommendations above were developed based on conversations I had
> with a few stakeholders in the BIPs process, but I did not attempt a
> comprehensive survey and I certainly don't claim to speak for anyone
> else.  I hope the recommendations are satisfactory and I look forward to
> your feedback.
>
> Thanks,
>
> -Dave
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210427/274ceb28/attachment.html>

From erik at q32.com  Tue Apr 27 11:49:10 2021
From: erik at q32.com (Erik Aronesty)
Date: Tue, 27 Apr 2021 07:49:10 -0400
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <773C1Ki5dlSNlxD3HK0eJDKHQ9Ikb5vwuKPZ3dkgEPqUmPGN6DrpLv47LNITHOlu7XWzmIpAmgw24noihYJ5lI5Qhmg7yIlboGQsfAowFCw=@protonmail.com>
References: <202104230209.05373.luke@dashjr.org>
 <202104252100.07296.luke@dashjr.org>
 <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
 <202104252122.40909.luke@dashjr.org>
 <248f871e-1b83-8c7c-678b-3ed0585a6357@mattcorallo.com>
 <20210426194309.2k5exujz23vjrgwc@ganymede>
 <773C1Ki5dlSNlxD3HK0eJDKHQ9Ikb5vwuKPZ3dkgEPqUmPGN6DrpLv47LNITHOlu7XWzmIpAmgw24noihYJ5lI5Qhmg7yIlboGQsfAowFCw=@protonmail.com>
Message-ID: <CAJowKgJ7+aiVM-c+4S9OgwY3mv4nmJjAc4C_pwSKnvUZqpNt4g@mail.gmail.com>

seems like this is solved by a workflow where a maintainer who
requests changes clearly tags every entry as "changes needed" or
"review requested",, and then the author can resolve/remove the tag
after the changes are made.

not sure PR's are the right tech here.

On Tue, Apr 27, 2021 at 6:28 AM W. J. van der Laan via bitcoin-dev
<bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> On Monday, April 26th, 2021 at 9:43 PM, David A. Harding via bitcoin-dev <bitcoin-dev at lists.linuxfoundation.org> wrote:
>
> > On Sun, Apr 25, 2021 at 05:31:50PM -0400, Matt Corallo via bitcoin-dev wrote:
> >
> > > In general, I think its time we all agree the BIP process has simply failed
> > >
> > > and move on. Luckily its not really all that critical and proposed protocol
> > >
> > > documents can be placed nearly anywhere with the same effect.
> >
>
> I like the idea of decentralizing the BIPs process. It is a historical artifact that the bips repository is part of the same organization that bitcoin core is part of. But there shouldn't be the perception that standardization is driven by that, or that there is any kind of (non-trivial) gatekeeping.
>
> I understand where this perception is coming from, though. There being 111 PRs open at https://github.com/bitcoin/bips/pulls indicates that there is some kind of bottleneck. I hope adding more BIP editors can mitigate this somewhat.
>
> Though it also happens that the BIP author simply don't care about changes anymore and doesn't respond, in which case the PR lingers without any fault from the BIPs maintainer. So something is to be said of having the BIP repository mirror/aggregate author's own work trees, and changes needing to be proposed there instead of "upstream".
>
> -W
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev

From jtimon at jtimon.cc  Tue Apr 27 12:16:52 2021
From: jtimon at jtimon.cc (=?UTF-8?B?Sm9yZ2UgVGltw7Nu?=)
Date: Tue, 27 Apr 2021 14:16:52 +0200
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <202104252100.07296.luke@dashjr.org>
References: <202104230209.05373.luke@dashjr.org>
 <CALZpt+Hz3jFnA8z1w6yictdHWnnKReMK+6eEHg_jUZ7==xNZzQ@mail.gmail.com>
 <64807e52-14ea-198b-4caf-29be92e89655@mattcorallo.com>
 <202104252100.07296.luke@dashjr.org>
Message-ID: <CABm2gDqdVOejHCMvd16wE3iR+aUnWKdk8cG_sWDrmRcFhfbuQA@mail.gmail.com>

> Despite the continual harassment, I have even made two efforts to try to
> (fairly) make things faster, and have been obstructed both times by ST
> advocates. It appears they intend to paint me as "deliberately refusing"
> (to
> use your words) in order to try to put Bitcoin and the BIP process under
> their control, and abuse it in the same manner in which they abused
> Bitcoin
> Core's usual standards (by releasing ST without community consensus).
>

I haven'tpaying attention to the BIPs.
But I just want to say I agree it is the case that speed trial didn't have
consensus and had many good and logical arguments against it.
Sadly discussions around taproot activation I've been lacking logic and
having too many irrational arguments appealing to emotions.

I'm really disapointed at the community right now.
I'm sorry for luke and others defending lot=true (the whole point of bip8
anyway), but I feel ignored and frustrated when I try to participate in
these irrational debates.
I miss the rational debates here.

But if we're gping to turn this list into an irrational place, with ad
hominem fallacies and insults, I guess I can say my subjective personal
opinion about other people too.
I think it is you, Matt, who is playing dumb, not Luke.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210427/26157a24/attachment-0001.html>

From antoine.riard at gmail.com  Tue Apr 27 14:54:12 2021
From: antoine.riard at gmail.com (Antoine Riard)
Date: Tue, 27 Apr 2021 10:54:12 -0400
Subject: [bitcoin-dev] L2s Onchain Support IRC Workshop
In-Reply-To: <CAFXO6=J-3kF4nOqrHLRzN2t+=iCrCDTJh9nD3tY45ihZOAZ8ug@mail.gmail.com>
References: <CALZpt+E_e=0rjq5_XazV_qH2h=uQrpTLbMRe2K7jVterSAr05w@mail.gmail.com>
 <CAFXO6=J-3kF4nOqrHLRzN2t+=iCrCDTJh9nD3tY45ihZOAZ8ug@mail.gmail.com>
Message-ID: <CALZpt+FxikOrmz8Dt596QdMWzWYMFMwzOCOcfoiT9evaC9PimA@mail.gmail.com>

Hi Gloria,

Thanks for your interest in joining.

> A small note - I believe package relay and sponsorship (or other
> fee-bumping primitive) should be separate discussions.

Here my thinking on the question, ideally we would have one generic
fee-bumping primitive suiting any contracting protocol or Bitcoin
applications onchain requirements. In the future, that
would avoid the mempool and transaction relay rules being lobbied by any L2
community to add support for their specific onchain desiratas. Of course,
L2 communities are always able to deploy their own overlay infrastructure
but at the price of losing the censorship-resistance guarantees of the
current base layer p2p network.

Further, we already have concerns of competing onchain requirements between
Bitcoin merchants and Lightning protocol dev about RBF. IMO, full-rbf will
harden LN against some state-of-art attacks but at same time make it easier
to double-spend merchants.

How do we arbiter between categories of users requirements ? I don't know,
best is to have an open discussion about it ?

Back to package relay, I also think that's the easiest candidate to deploy
because it doesn't rely on any consensus change. What I'm concerned about
is one package relay design working fine for the vast majority of cases but
irrelevant or broken to address adversarial settings. Even more, it might
work fine for LN but not at all for more fancy protocols still on the
whiteboard like op_ctv-style
congestion tree.

Though in many cases it is better to adopt an almost complete solution now,
rather than to wait until a perfect solution can be found. Likely, the best
we can do is keep design modular, version everything and be ready to deploy
multiple versions of package relay in the coming years as our knowledge in
those areas improves.

> Re: L2-zoology... In general, for the purpose of creating a stable API /
> set of assumptions between layers, I'd like to be as concrete as possible.
> Speaking for myself, if I'm TDDing for a specific L2 attack, I need test
> vectors. A simple description of mempool contents + p2p messages sent is
> fine, but pubkeys + transaction hex would be appreciated because we don't
> (and probably shouldn't, for the purpose of maintainability) have a lot of
> tooling to build L2 transactions in Bitcoin Core. In the other direction,
> it's hard to make any guarantees given the complexity of mempool policy,
> but perhaps it could be helpful to expose a configurable RPC (e.g. #21413
> <https://github.com/bitcoin/bitcoin/pull/21413>) to test a range of
> scenarios?

We're aligned here, I'd like to be as concrete as possible too. As a L1/L2
dev, I've just a bunch of questions and don't pretend to have clear answers
for each of them yet nor I think those answers will be the best ones. So
maybe the first step is just tracking and explaining problems better,
hopefully avoiding to waste too much engineering hours on could-be-enhanced
solutions ?

Actively working on better demonstrations and will share them soon. That
said, anyone interested in improving their own understanding in those areas
are free to make their own investigations :)

Cheers,
Antoine

Le lun. 26 avr. 2021 ? 19:06, Gloria Zhao <gloriajzhao at gmail.com> a ?crit :

> Hi Antoine,
>
> Thanks for initiating this! I'm interested in joining. Since I mostly live
> in L1, my primary goal is to understand what simplest version of package
> relay would be sufficient to support transaction relay assumptions made by
> L2 applications. For example, if a parent + child package covers the vast
> majority of cases and a package limit of 2 is considered acceptable, that
> could simplify things quite a bit.
>
> A small note - I believe package relay and sponsorship (or other
> fee-bumping primitive) should be separate discussions.
>
> Re: L2-zoology... In general, for the purpose of creating a stable API /
> set of assumptions between layers, I'd like to be as concrete as possible.
> Speaking for myself, if I'm TDDing for a specific L2 attack, I need test
> vectors. A simple description of mempool contents + p2p messages sent is
> fine, but pubkeys + transaction hex would be appreciated because we don't
> (and probably shouldn't, for the purpose of maintainability) have a lot of
> tooling to build L2 transactions in Bitcoin Core. In the other direction,
> it's hard to make any guarantees given the complexity of mempool policy,
> but perhaps it could be helpful to expose a configurable RPC (e.g. #21413
> <https://github.com/bitcoin/bitcoin/pull/21413>) to test a range of
> scenarios?
>
> Anyway, looking forward to discussions :)
>
> Best,
> Gloria
>
> On Fri, Apr 23, 2021 at 8:51 AM Antoine Riard via bitcoin-dev <
> bitcoin-dev at lists.linuxfoundation.org> wrote:
>
>> Hi,
>>
>> During the lastest years, tx-relay and mempool acceptances rules of the
>> base layer have been sources of major security and operational concerns for
>> Lightning and other Bitcoin second-layers [0]. I think those areas require
>> significant improvements to ease design and deployment of higher Bitcoin
>> layers and I believe this opinion is shared among the L2 dev community. In
>> order to make advancements, it has been discussed a few times in the last
>> months to organize in-person workshops to discuss those issues with the
>> presence of both L1/L2 devs to make exchange fruitful.
>>
>> Unfortunately, I don't think we'll be able to organize such in-person
>> workshops this year (because you know travel is hard those days...) As a
>> substitution, I'm proposing a series of one or more irc meetings. That
>> said, this substitution has the happy benefit to gather far more folks
>> interested by those issues that you can fit in a room.
>>
>> # Scope
>>
>> I would like to propose the following 4 items as topics of discussion.
>>
>> 1) Package relay design or another generic L2 fee-bumping primitive like
>> sponsorship [0]. IMHO, this primitive should at least solve mempools spikes
>> making obsolete propagation of transactions with pre-signed feerate, solve
>> pinning attacks compromising Lightning/multi-party contract protocol
>> safety, offer an usable and stable API to L2 software stack, stay
>> compatible with miner and full-node operators incentives and obviously
>> minimize CPU/memory DoS vectors.
>>
>> 2) Deprecation of opt-in RBF toward full-rbf. Opt-in RBF makes it trivial
>> for an attacker to partition network mempools in divergent subsets and from
>> then launch advanced security or privacy attacks against a Lightning node.
>> Note, it might also be a concern for bandwidth bleeding attacks against L1
>> nodes.
>>
>> 3) Guidelines about coordinated cross-layers security disclosures.
>> Mitigating a security issue around tx-relay or the mempool in Core might
>> have harmful implications for downstream projects. Ideally, L2 projects
>> maintainers should be ready to upgrade their protocols in emergency in
>> coordination with base layers developers.
>>
>> 4) Guidelines about L2 protocols onchain security design. Currently
>> deployed like Lightning are making a bunch of assumptions on tx-relay and
>> mempool acceptances rules. Those rules are non-normative, non-reliable and
>> lack documentation. Further, they're devoid of tooling to enforce them at
>> runtime [2]. IMHO, it could be preferable to identify a subset of them on
>> which second-layers protocols can do assumptions without encroaching too
>> much on nodes's policy realm or making the base layer development in those
>> areas too cumbersome.
>>
>> I'm aware that some folks are interested in other topics such as
>> extension of Core's mempools package limits or better pricing of RBF
>> replacement. So l propose a 2-week concertation period to submit other
>> topics related to tx-relay or mempools improvements towards L2s before to
>> propose a finalized scope and agenda.
>>
>> # Goals
>>
>> 1) Reaching technical consensus.
>> 2) Reaching technical consensus, before seeking community consensus as it
>> likely has ecosystem-wide implications.
>> 3) Establishing a security incident response policy which can be applied
>> by dev teams in the future.
>> 4) Establishing a philosophy design and associated documentations (BIPs,
>> best practices, ...)
>>
>> # Timeline
>>
>> 2021-04-23: Start of concertation period
>> 2021-05-07: End of concertation period
>> 2021-05-10: Proposition of workshop agenda and schedule
>> late 2021-05/2021-06: IRC meetings
>>
>> As the problem space is savagely wide, I've started a collection of
>> documents to assist this workshop : https://github.com/ariard/L2-zoology
>> Still wip, but I'll have them in a good shape at agenda publication, with
>> reading suggestions and open questions to structure discussions.
>> Also working on transaction pinning and mempool partitions attacks
>> simulations.
>>
>> If L2s security/p2p/mempool is your jam, feel free to get involved :)
>>
>> Cheers,
>> Antoine
>>
>> [0] For e.g see optech section on transaction pinning attacks :
>> https://bitcoinops.org/en/topics/transaction-pinning/
>> [1]
>> https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-September/018168.html
>> [2] Lack of reference tooling make it easier to have bug slip in like
>> https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html
>> _______________________________________________
>> bitcoin-dev mailing list
>> bitcoin-dev at lists.linuxfoundation.org
>> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210427/e7daac9b/attachment.html>

From melvincarvalho at gmail.com  Tue Apr 27 19:43:40 2021
From: melvincarvalho at gmail.com (Melvin Carvalho)
Date: Tue, 27 Apr 2021 21:43:40 +0200
Subject: [bitcoin-dev] Reminder on the Purpose of BIPs
In-Reply-To: <CAAS2fgRZwf=SBB4EvpeTBLshRfT1tmnv33GP+Ln+w2bxt48=pA@mail.gmail.com>
References: <202104230209.05373.luke@dashjr.org>
 <202104252100.07296.luke@dashjr.org>
 <40214e32-ffb3-9518-7bc8-9c1059f50da7@mattcorallo.com>
 <202104252122.40909.luke@dashjr.org>
 <248f871e-1b83-8c7c-678b-3ed0585a6357@mattcorallo.com>
 <20210426194309.2k5exujz23vjrgwc@ganymede>
 <CAAS2fgRZwf=SBB4EvpeTBLshRfT1tmnv33GP+Ln+w2bxt48=pA@mail.gmail.com>
Message-ID: <CAKaEYhKB-zkXc-6KgOcsTOAreAMwnqhFjB7mBOSnkXt=oxLg3w@mail.gmail.com>

On Mon, 26 Apr 2021 at 22:08, Greg Maxwell via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> I endorse Harding's recommendations.  On the point about mirroring,
> one thing to keep in mind is that the other repositories may go
> offline.
>
> Modification confusion could be avoided by recording what revision
> (commit hash) was current at the time of inclusion, but the document
> going offline can only be protected against by maintaining a copy
> somewhere.
>

One could partially solve the mirroring issue by giving each decentralized
BIP (optionally) a genesis transaction ID, that moved in time on the block
chain

This can be made to mirror / witness the evolution in git of the BIP using
git commit hashes (in time), and then matching those commit hashes in the
block chain by tweaking the public key address by the same amount (with no
change address)

What would occur then would be a genesis and current definitive HEAD of a
BIP, and the history it's gone through.  The whole history can be
reconstructed from any one transaction.  This is quite similar to Peter
Todd's single use seals, and the work done on RGB

Regarding commit trees going offline, they can be mirrored, hosted on
popular sites (github/gitlab) and it's natural that popular repos in git
are cloned

This also provides a little skin in the game and prevents some sybil
attacks, because you need to spend money on a TX

In this way whole BIPs can have a life cycle outside of any official body,
but also be assigned BIP numbers in the bitcoin repo

This mainly an informational idea, however, I have been working on some
code and early prototypes to do this, so feel free to message me off-list
if there's additional interest


>
>
> On Mon, Apr 26, 2021 at 7:44 PM David A. Harding via bitcoin-dev
> <bitcoin-dev at lists.linuxfoundation.org> wrote:
> >
> > On Sun, Apr 25, 2021 at 05:31:50PM -0400, Matt Corallo via bitcoin-dev
> wrote:
> > > In general, I think its time we all agree the BIP process has simply
> failed
> > > and move on. Luckily its not really all that critical and proposed
> protocol
> > > documents can be placed nearly anywhere with the same effect.
> >
> > I recommend:
> >
> > 1. We add additional BIP editors, starting with Kalle Alm (if there are
> >    no continuing significant objections).
> >
> > 2. We seek Luke Dashjr's resignation as BIPs editor.
> >
> > 3. We begin treating protocol documents outside the BIPs repository as
> >    first-class BIP documentation.
> >
> > The first recommendation permits continued maintenance of existing BIPs
> > plus gives the additional maintainers an opportunity to rebuild the
> > credibility of the repository.
> >
> > The second recommendation addresses the dissatisfaction of many BIP
> > authors and potential authors with the current editor, which I think
> > will discourage many of them from making additional significant
> > contributions to the repository.  It also seems to me to be a better use
> > of Luke's talents and interests for him to focus on protocol research
> > and review rather than procedurally checking whether a bunch of
> > documents are well formed.
> >
> > The third recommendation provides an escape hatch for anyone, such as
> > Matt, who currently thinks the process has failed, or for anyone who
> > comes to that same conclusion in the future under a different editing
> > team.  My specific recommendations there are:
> >
> > a. Anyone writing protocol documentation in the spirit of the BIP
> >    process can post their idea to this mailing list like we've always
> >    done and, when they've finished collecting initial feedback, they can
> >    assign themselves a unique decentralized identifier starting with
> >    "bip-".  They may also define a shorter alias that they encourage
> >    people to use in cases where the correct document can be inferred
> >    from context.  E.g.,
> >
> >       bip-wuille-taproot (bip-taproot)
> >       bip-towns-versionbits-min-activation-height (bip-vbmah)
> >       bip-todd-harding-opt-in-replace-by-fee (bip-opt-in-rbf)
> >
> > b. The author then publishes the document to any place they'd like,
> although
> >    they are strongly encouraged to make any document source available
> >    under an open license to ensure others can create their own
> >    modifications.
> >
> > c. Implementations of BIPs, whether original repository BIPs or
> >    decentralized BIPs, link to the BIPs they implement to ensure
> >    researchers and developers can find the relevant protocol
> >    documentation.  E.g.,
> >
> https://github.com/bitcoin/bitcoin/blob/fe5e495c31de47b0ec732b943db11fe345d874af/doc/bips.md
> >
> >      (It may also be advisable for implementations to mirror copies of
> >      the BIPs they implement so later modifications to the document
> >      don't confuse anyone.  For this reason, extremely liberal
> >      licensing of BIP documents is encouraged.)
> >
> > d. To help maintain quality and consistency between documentation, the
> >    BIP editors provide a BIP document template, guidelines similar to
> >    the existing BIP2, and an easy-to-run format linter.
> >
> > I think this decentralized BIPs alternative also helps address some
> > longstanding problems with the BIPs system: that many casual Bitcoin
> > users and developers think of documents in the BIPs repo as
> > authoritative and that there are some development teams (such as for LN)
> > that have already abandoned the BIPs process because, in part, they want
> > complete control over their own documentation.
> >
> > The recommendations above were developed based on conversations I had
> > with a few stakeholders in the BIPs process, but I did not attempt a
> > comprehensive survey and I certainly don't claim to speak for anyone
> > else.  I hope the recommendations are satisfactory and I look forward to
> > your feedback.
> >
> > Thanks,
> >
> > -Dave
> > _______________________________________________
> > bitcoin-dev mailing list
> > bitcoin-dev at lists.linuxfoundation.org
> > https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210427/3e9db685/attachment-0001.html>

From jaime.caring at gmail.com  Tue Apr 27 22:30:56 2021
From: jaime.caring at gmail.com (Jaime Caring)
Date: Tue, 27 Apr 2021 22:30:56 +0000
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <20210426003640.2sjx4f35l3vdtxwe@ganymede>
References: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>
 <20210426003640.2sjx4f35l3vdtxwe@ganymede>
Message-ID: <CAJGfOo+qadNqEmiXpqUJdpRXtHFhcAfQn6RetSkxUt8JicNTcg@mail.gmail.com>

Kalle should not be made an editor by an ad-hoc process. I reiterate Greg's
NACK.

I propose that we form a stewardship committee of frequent contributors,
including you, Greg, and 21 others. The stewards appoint a small set of
editors with permanent oversight by the stewards. A defined process
prevents this controversy from arising in the future and makes proceedings
clear.

My proposal has been moderated off of this list, but may be viewed here:
https://github.com/bitcoin/bips/pull/1113

I care not for the role of initial transitory editor. I would be pleased
should any responsible community member shoulder this onus in my stead.

Peace be upon you,

JC

On Mon, 26 Apr 2021 at 00:37, David A. Harding via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> On Sat, Apr 24, 2021 at 04:42:12AM +0000, Greg Maxwell via bitcoin-dev
> wrote:
> > I am opposed to the addition of Kalle Alm at this time.  Those who
> > believe [this] will resolve the situation [...] re: PR1104 are
> > mistaken.
>
> PR1104 has been merged.  Do you continue to oppose the addition?
>
> Thanks,
>
> -Dave
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210427/ad3b1a8b/attachment.html>

From policeterror at dyne.org  Wed Apr 28 09:52:33 2021
From: policeterror at dyne.org (Amir Taaki)
Date: Wed, 28 Apr 2021 11:52:33 +0200
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <CAJGfOo+qadNqEmiXpqUJdpRXtHFhcAfQn6RetSkxUt8JicNTcg@mail.gmail.com>
References: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>
 <20210426003640.2sjx4f35l3vdtxwe@ganymede>
 <CAJGfOo+qadNqEmiXpqUJdpRXtHFhcAfQn6RetSkxUt8JicNTcg@mail.gmail.com>
Message-ID: <4def9376-03dc-3805-89ea-28bd78077084@dyne.org>

A committee to guide the committee? You guys truly have lost the plot.

All the good minds and cryptographers have left Bitcoin. What remains is
an empty echo chamber.

Truth is these problems start with lack of vision and long-term roadmap,
not with the processes themselves.

And the Bitcoin Core monopoly created this situation; one coin, one
client, one vision. And the inevitable infighting for ultimate power.

Really if we want to go down this route, there should be a long period
of self reflection about where the problems began rather than patching
some process and moving on.

I propose Bitcoin Core is dissolved as the official Bitcoin project. The
community is free to elect their preferred version of Bitcoin. And most
importantly, Bitcoin developers commit to a fully specced standard that
all implementations move towards using.

On 4/28/21 12:30 AM, Jaime Caring via bitcoin-dev wrote:
> Kalle should not be made an editor by an ad-hoc process. I reiterate
> Greg's NACK.
> 
> I propose that we form a stewardship committee of frequent contributors,
> including you, Greg, and 21 others. The stewards appoint a small set of
> editors with permanent oversight by the stewards. A defined process
> prevents this controversy from arising in the future and makes
> proceedings clear.
> 
> My proposal has been moderated off of this list, but may be viewed here:
> https://github.com/bitcoin/bips/pull/1113
> <https://github.com/bitcoin/bips/pull/1113>
> 
> I care not for the role of initial transitory editor. I would be pleased
> should any responsible community member shoulder this onus in my stead.
> 
> Peace be upon you,
> 
> JC
> 
> On Mon, 26 Apr 2021 at 00:37, David A. Harding via bitcoin-dev
> <bitcoin-dev at lists.linuxfoundation.org
> <mailto:bitcoin-dev at lists.linuxfoundation.org>> wrote:
> 
>     On Sat, Apr 24, 2021 at 04:42:12AM +0000, Greg Maxwell via
>     bitcoin-dev wrote:
>     > I am opposed to the addition of Kalle Alm at this time.? Those who
>     > believe [this] will resolve the situation [...] re: PR1104 are
>     > mistaken.
> 
>     PR1104 has been merged.? Do you continue to oppose the addition?
> 
>     Thanks,
> 
>     -Dave
>     _______________________________________________
>     bitcoin-dev mailing list
>     bitcoin-dev at lists.linuxfoundation.org
>     <mailto:bitcoin-dev at lists.linuxfoundation.org>
>     https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>     <https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev>
> 
> 
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> 

From gmkarl at gmail.com  Fri Apr 30 15:39:23 2021
From: gmkarl at gmail.com (Karl)
Date: Fri, 30 Apr 2021 11:39:23 -0400
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <4def9376-03dc-3805-89ea-28bd78077084@dyne.org>
References: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>
 <20210426003640.2sjx4f35l3vdtxwe@ganymede>
 <CAJGfOo+qadNqEmiXpqUJdpRXtHFhcAfQn6RetSkxUt8JicNTcg@mail.gmail.com>
 <4def9376-03dc-3805-89ea-28bd78077084@dyne.org>
Message-ID: <CALL-=e7OLDa8avzSufqhEMnTe9Oece2rnCffmrQrdnX6ymt2cQ@mail.gmail.com>

A good solution here is to make it clear to visitors that facilitation,
mediation, and organisation help is badly needed in the core development
team.

People with such expertise can even be hired directly.

A good facilitator opens communication paths between all parties, leaving
everyone satisfied with decisions.  Don't accept a compromise if you can
look for something better.

On Fri, Apr 30, 2021, 8:00 AM Amir Taaki via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> A committee to guide the committee? You guys truly have lost the plot.
>
> All the good minds and cryptographers have left Bitcoin. What remains is
> an empty echo chamber.
>
> Truth is these problems start with lack of vision and long-term roadmap,
> not with the processes themselves.
>
> And the Bitcoin Core monopoly created this situation; one coin, one
> client, one vision. And the inevitable infighting for ultimate power.
>
> Really if we want to go down this route, there should be a long period
> of self reflection about where the problems began rather than patching
> some process and moving on.
>
> I propose Bitcoin Core is dissolved as the official Bitcoin project. The
> community is free to elect their preferred version of Bitcoin. And most
> importantly, Bitcoin developers commit to a fully specced standard that
> all implementations move towards using.
>
> On 4/28/21 12:30 AM, Jaime Caring via bitcoin-dev wrote:
> > Kalle should not be made an editor by an ad-hoc process. I reiterate
> > Greg's NACK.
> >
> > I propose that we form a stewardship committee of frequent contributors,
> > including you, Greg, and 21 others. The stewards appoint a small set of
> > editors with permanent oversight by the stewards. A defined process
> > prevents this controversy from arising in the future and makes
> > proceedings clear.
> >
> > My proposal has been moderated off of this list, but may be viewed here:
> > https://github.com/bitcoin/bips/pull/1113
> > <https://github.com/bitcoin/bips/pull/1113>
> >
> > I care not for the role of initial transitory editor. I would be pleased
> > should any responsible community member shoulder this onus in my stead.
> >
> > Peace be upon you,
> >
> > JC
> >
> > On Mon, 26 Apr 2021 at 00:37, David A. Harding via bitcoin-dev
> > <bitcoin-dev at lists.linuxfoundation.org
> > <mailto:bitcoin-dev at lists.linuxfoundation.org>> wrote:
> >
> >     On Sat, Apr 24, 2021 at 04:42:12AM +0000, Greg Maxwell via
> >     bitcoin-dev wrote:
> >     > I am opposed to the addition of Kalle Alm at this time.  Those who
> >     > believe [this] will resolve the situation [...] re: PR1104 are
> >     > mistaken.
> >
> >     PR1104 has been merged.  Do you continue to oppose the addition?
> >
> >     Thanks,
> >
> >     -Dave
> >     _______________________________________________
> >     bitcoin-dev mailing list
> >     bitcoin-dev at lists.linuxfoundation.org
> >     <mailto:bitcoin-dev at lists.linuxfoundation.org>
> >     https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> >     <https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev>
> >
> >
> > _______________________________________________
> > bitcoin-dev mailing list
> > bitcoin-dev at lists.linuxfoundation.org
> > https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> >
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210430/1ee7c171/attachment.html>

From jameson.lopp at gmail.com  Fri Apr 30 16:58:04 2021
From: jameson.lopp at gmail.com (Jameson Lopp)
Date: Fri, 30 Apr 2021 12:58:04 -0400
Subject: [bitcoin-dev] Proposed BIP editor: Kalle Alm
In-Reply-To: <4def9376-03dc-3805-89ea-28bd78077084@dyne.org>
References: <CAAS2fgSrkH=7T6=MvhmLq4HAcmJC+_sR9YWQZ3CsrhyLrmBHAw@mail.gmail.com>
 <20210426003640.2sjx4f35l3vdtxwe@ganymede>
 <CAJGfOo+qadNqEmiXpqUJdpRXtHFhcAfQn6RetSkxUt8JicNTcg@mail.gmail.com>
 <4def9376-03dc-3805-89ea-28bd78077084@dyne.org>
Message-ID: <CADL_X_d1A6kB-_C+XtEFfMtKSKL72Ex8H3hf+cNvxPjUk1S4qg@mail.gmail.com>

On Fri, Apr 30, 2021 at 7:59 AM Amir Taaki via bitcoin-dev <
bitcoin-dev at lists.linuxfoundation.org> wrote:

> A committee to guide the committee? You guys truly have lost the plot.
>
> All the good minds and cryptographers have left Bitcoin. What remains is
> an empty echo chamber.
>
> Truth is these problems start with lack of vision and long-term roadmap,
> not with the processes themselves.
>
> And the Bitcoin Core monopoly created this situation; one coin, one
> client, one vision. And the inevitable infighting for ultimate power.
>
> Really if we want to go down this route, there should be a long period
> of self reflection about where the problems began rather than patching
> some process and moving on.
>
> I propose Bitcoin Core is dissolved as the official Bitcoin project.


Nonsense, as it is not the official Bitcoin project. There is no such thing.

The community is free to elect their preferred version of Bitcoin.


Individuals have voted with their feet and are free to continue to do so.
It's anarchy, I tell you!


> And most importantly, Bitcoin developers commit to a fully specced
> standard that
> all implementations move towards using.
>

Who decides the spec? Perhaps... a committee of some sort?


>
> On 4/28/21 12:30 AM, Jaime Caring via bitcoin-dev wrote:
> > Kalle should not be made an editor by an ad-hoc process. I reiterate
> > Greg's NACK.
> >
> > I propose that we form a stewardship committee of frequent contributors,
> > including you, Greg, and 21 others. The stewards appoint a small set of
> > editors with permanent oversight by the stewards. A defined process
> > prevents this controversy from arising in the future and makes
> > proceedings clear.
> >
> > My proposal has been moderated off of this list, but may be viewed here:
> > https://github.com/bitcoin/bips/pull/1113
> > <https://github.com/bitcoin/bips/pull/1113>
> >
> > I care not for the role of initial transitory editor. I would be pleased
> > should any responsible community member shoulder this onus in my stead.
> >
> > Peace be upon you,
> >
> > JC
> >
> > On Mon, 26 Apr 2021 at 00:37, David A. Harding via bitcoin-dev
> > <bitcoin-dev at lists.linuxfoundation.org
> > <mailto:bitcoin-dev at lists.linuxfoundation.org>> wrote:
> >
> >     On Sat, Apr 24, 2021 at 04:42:12AM +0000, Greg Maxwell via
> >     bitcoin-dev wrote:
> >     > I am opposed to the addition of Kalle Alm at this time.  Those who
> >     > believe [this] will resolve the situation [...] re: PR1104 are
> >     > mistaken.
> >
> >     PR1104 has been merged.  Do you continue to oppose the addition?
> >
> >     Thanks,
> >
> >     -Dave
> >     _______________________________________________
> >     bitcoin-dev mailing list
> >     bitcoin-dev at lists.linuxfoundation.org
> >     <mailto:bitcoin-dev at lists.linuxfoundation.org>
> >     https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> >     <https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev>
> >
> >
> > _______________________________________________
> > bitcoin-dev mailing list
> > bitcoin-dev at lists.linuxfoundation.org
> > https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
> >
> _______________________________________________
> bitcoin-dev mailing list
> bitcoin-dev at lists.linuxfoundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/bitcoin-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210430/93283b82/attachment.html>

From prayank at tutanota.de  Fri Apr 30 20:28:42 2021
From: prayank at tutanota.de (Prayank)
Date: Fri, 30 Apr 2021 22:28:42 +0200 (CEST)
Subject: [bitcoin-dev] Fee estimates and RBF
Message-ID: <MZZT0_o--3-2@tutanota.de>

Hello World, 

I hope everyone is doing okay. Things are not good in India and even I was tested covid positive few days back. Recovered and feeling better now. Hoping everything gets back to normal soon.

There are different estimations used in wallets, explorers and other Bitcoin projects. For example: `estimatesmartfee` in Bitcoin Core (One of the implementation for Bitcoin which is used more but not official as there is nothing official in Bitcoin).? Are different estimations misleading and affect the way fees are used in Bitcoin transactions? Will it be better if we just share mempool stats and user can decide the fee rate accordingly?

If I compare this with BTCUSD orderbook on any exchange, are we trying to estimate at what price buy order will get filled in certain time? Does that make sense?

Mempool Stats: https://i.imgur.com/r4XKk2p.png
BTCUSD Orderbook: https://i.imgur.com/ylGVHJB.png

I consider it misleading because lot of users think a transaction with fee rate 1-5 sat/vByte will be included in 1 week or maybe a transaction with X sat/VByte will be included in Y time which is not true. Users can decide the fee rate and can do bidding, transaction will be included based on demand, supply and miners.

Will it be better if the wallets used this approach?
1.Show mempool stats
2.Leave the fee rate for user to decide
3.RBF every transaction and follow different algorithms for automated bidding

A basic algorithm for automated bidding can be: https://i.stack.imgur.com/1SlPv.png

Such RBF algos can be helpful for users when Bitcoin wallets are open in background. Maybe it will work better for mobile wallets in which you can see a notification every time transaction is replaced with a new fee rate automatically.

I wanted to know what others think about this approach of creating and using different RBF algos instead of predicting something that is difficult or doesn't make sense. Also if there was a way we could achieve this even if the user goes offline. For example: Alice broadcasts Tx1 with 1 sat/vByte, its replaced with Tx2 (2 sat/vByte) after 2 blocks because Tx1 was not confirmed. Alice decides to shut down her system or switch off mobile or mobile data. Tx2 is still not confirmed after another 2 blocks but it has some information as one OP_RETURN output which is used by Bitcoin nodes that see this transaction in the mempool. Bob's node use this information to replace the transaction with Tx3 and use fee rate 3 sat/vByte.

--
Prayank

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.linuxfoundation.org/pipermail/bitcoin-dev/attachments/20210430/e9fe628a/attachment-0001.html>

